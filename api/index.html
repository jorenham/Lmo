<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Robust stats and fitting using (trimmed) L-Moments"><meta name=author content="Joren Hammudoglu"><link href=https://jorenham.github.io/Lmo/api/ rel=canonical><link rel=prev href=..><link href=../distributions/ rel=next><link rel=icon href=../img/favicon.ico><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.23"><title>Reference - Lmo</title><link rel=stylesheet href=../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css><link rel=stylesheet href=../styles/theme.0e397b.min.css><link rel=stylesheet href=../styles/katex.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-KH79N7XQCE"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-KH79N7XQCE",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-KH79N7XQCE",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=nose data-md-color-accent=skin> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lmo-reference class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Lmo class="md-header__button md-logo" aria-label=Lmo data-md-component=logo> <img src=../img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Lmo </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Reference </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jorenham/Lmo/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jorenham/Lmo </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Overview </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../distributions/ class=md-tabs__link> Distributions </a> </li> <li class=md-tabs__item> <a href=../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Lmo class="md-nav__button md-logo" aria-label=Lmo data-md-component=logo> <img src=../img/logo.png alt=logo> </a> Lmo </label> <div class=md-nav__source> <a href=https://github.com/jorenham/Lmo/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jorenham/Lmo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Reference </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#high-level-api class=md-nav__link> <span class=md-ellipsis> High-level API </span> </a> <nav class=md-nav aria-label="High-level API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sample-l-moments class=md-nav__link> <span class=md-ellipsis> Sample L-moments </span> </a> <nav class=md-nav aria-label="Sample L-moments"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.l_kurtosis class=md-nav__link> <span class=md-ellipsis> l_kurtosis </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_loc class=md-nav__link> <span class=md-ellipsis> l_loc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_moment class=md-nav__link> <span class=md-ellipsis> l_moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_moment_cov class=md-nav__link> <span class=md-ellipsis> l_moment_cov </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_moment_influence class=md-nav__link> <span class=md-ellipsis> l_moment_influence </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_ratio class=md-nav__link> <span class=md-ellipsis> l_ratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_ratio_influence class=md-nav__link> <span class=md-ellipsis> l_ratio_influence </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_ratio_se class=md-nav__link> <span class=md-ellipsis> l_ratio_se </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_scale class=md-nav__link> <span class=md-ellipsis> l_scale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_skew class=md-nav__link> <span class=md-ellipsis> l_skew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_stats class=md-nav__link> <span class=md-ellipsis> l_stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_stats_se class=md-nav__link> <span class=md-ellipsis> l_stats_se </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_variation class=md-nav__link> <span class=md-ellipsis> l_variation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sample-l-comoments class=md-nav__link> <span class=md-ellipsis> Sample L-comoments </span> </a> <nav class=md-nav aria-label="Sample L-comoments"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.l_cokurtosis class=md-nav__link> <span class=md-ellipsis> l_cokurtosis </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_coloc class=md-nav__link> <span class=md-ellipsis> l_coloc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_comoment class=md-nav__link> <span class=md-ellipsis> l_comoment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_coratio class=md-nav__link> <span class=md-ellipsis> l_coratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_corr class=md-nav__link> <span class=md-ellipsis> l_corr </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_coscale class=md-nav__link> <span class=md-ellipsis> l_coscale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_coskew class=md-nav__link> <span class=md-ellipsis> l_coskew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.l_costats class=md-nav__link> <span class=md-ellipsis> l_costats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#distributions class=md-nav__link> <span class=md-ellipsis> Distributions </span> </a> <nav class=md-nav aria-label=Distributions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.distributions.kumaraswamy class=md-nav__link> <span class=md-ellipsis> kumaraswamy </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.wakeby class=md-nav__link> <span class=md-ellipsis> wakeby </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.genlambda class=md-nav__link> <span class=md-ellipsis> genlambda </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly class=md-nav__link> <span class=md-ellipsis> l_poly </span> </a> <nav class=md-nav aria-label=l_poly> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.random_state class=md-nav__link> <span class=md-ellipsis> random_state </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.rvs class=md-nav__link> <span class=md-ellipsis> rvs </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.ppf class=md-nav__link> <span class=md-ellipsis> ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.isf class=md-nav__link> <span class=md-ellipsis> isf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.qdf class=md-nav__link> <span class=md-ellipsis> qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.cdf class=md-nav__link> <span class=md-ellipsis> cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.logcdf class=md-nav__link> <span class=md-ellipsis> logcdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.sf class=md-nav__link> <span class=md-ellipsis> sf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.logsf class=md-nav__link> <span class=md-ellipsis> logsf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.pdf class=md-nav__link> <span class=md-ellipsis> pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.hf class=md-nav__link> <span class=md-ellipsis> hf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.median class=md-nav__link> <span class=md-ellipsis> median </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.mean class=md-nav__link> <span class=md-ellipsis> mean </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.var class=md-nav__link> <span class=md-ellipsis> var </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.std class=md-nav__link> <span class=md-ellipsis> std </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.entropy class=md-nav__link> <span class=md-ellipsis> entropy </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.support class=md-nav__link> <span class=md-ellipsis> support </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.interval class=md-nav__link> <span class=md-ellipsis> interval </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.moment class=md-nav__link> <span class=md-ellipsis> moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.stats class=md-nav__link> <span class=md-ellipsis> stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.expect class=md-nav__link> <span class=md-ellipsis> expect </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_moment class=md-nav__link> <span class=md-ellipsis> l_moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_ratio class=md-nav__link> <span class=md-ellipsis> l_ratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_stats class=md-nav__link> <span class=md-ellipsis> l_stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_loc class=md-nav__link> <span class=md-ellipsis> l_loc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_scale class=md-nav__link> <span class=md-ellipsis> l_scale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_skew class=md-nav__link> <span class=md-ellipsis> l_skew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_poly.l_kurtosis class=md-nav__link> <span class=md-ellipsis> l_kurtosis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric class=md-nav__link> <span class=md-ellipsis> l_rv_nonparametric </span> </a> <nav class=md-nav aria-label=l_rv_nonparametric> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.l_moments class=md-nav__link> <span class=md-ellipsis> l_moments </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.trim class=md-nav__link> <span class=md-ellipsis> trim </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.ppf_poly class=md-nav__link> <span class=md-ellipsis> ppf_poly </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.cdf_poly class=md-nav__link> <span class=md-ellipsis> cdf_poly </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.pdf_poly class=md-nav__link> <span class=md-ellipsis> pdf_poly </span> </a> </li> <li class=md-nav__item> <a href=#lmo.distributions.l_rv_nonparametric.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.distributions.wakeby_gen class=md-nav__link> <span class=md-ellipsis> wakeby_gen </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#statistical-test-and-tools class=md-nav__link> <span class=md-ellipsis> Statistical test and tools </span> </a> <nav class=md-nav aria-label="Statistical test and tools"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.diagnostic.HypothesisTestResult class=md-nav__link> <span class=md-ellipsis> HypothesisTestResult </span> </a> <nav class=md-nav aria-label=HypothesisTestResult> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.diagnostic.HypothesisTestResult.is_valid class=md-nav__link> <span class=md-ellipsis> is_valid </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.HypothesisTestResult.is_significant class=md-nav__link> <span class=md-ellipsis> is_significant </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.normaltest class=md-nav__link> <span class=md-ellipsis> normaltest </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.l_moment_gof class=md-nav__link> <span class=md-ellipsis> l_moment_gof </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.l_stats_gof class=md-nav__link> <span class=md-ellipsis> l_stats_gof </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.l_moment_bounds class=md-nav__link> <span class=md-ellipsis> l_moment_bounds </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.l_ratio_bounds class=md-nav__link> <span class=md-ellipsis> l_ratio_bounds </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.rejection_point class=md-nav__link> <span class=md-ellipsis> rejection_point </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.error_sensitivity class=md-nav__link> <span class=md-ellipsis> error_sensitivity </span> </a> </li> <li class=md-nav__item> <a href=#lmo.diagnostic.shift_sensitivity class=md-nav__link> <span class=md-ellipsis> shift_sensitivity </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#third-party-integration class=md-nav__link> <span class=md-ellipsis> Third party integration </span> </a> <nav class=md-nav aria-label="Third party integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scipystats class=md-nav__link> <span class=md-ellipsis> scipy.stats </span> </a> <nav class=md-nav aria-label=scipy.stats> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic class=md-nav__link> <span class=md-ellipsis> l_rv_generic </span> </a> <nav class=md-nav aria-label=l_rv_generic> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment class=md-nav__link> <span class=md-ellipsis> l_moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio class=md-nav__link> <span class=md-ellipsis> l_ratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_stats class=md-nav__link> <span class=md-ellipsis> l_stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_loc class=md-nav__link> <span class=md-ellipsis> l_loc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_scale class=md-nav__link> <span class=md-ellipsis> l_scale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_skew class=md-nav__link> <span class=md-ellipsis> l_skew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_kurtosis class=md-nav__link> <span class=md-ellipsis> l_kurtosis </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moments_cov class=md-nav__link> <span class=md-ellipsis> l_moments_cov </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_stats_cov class=md-nav__link> <span class=md-ellipsis> l_stats_cov </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence class=md-nav__link> <span class=md-ellipsis> l_moment_influence </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio_influence class=md-nav__link> <span class=md-ellipsis> l_ratio_influence </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_fit class=md-nav__link> <span class=md-ellipsis> l_fit </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_fit_loc_scale class=md-nav__link> <span class=md-ellipsis> l_fit_loc_scale </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pandas-optional class=md-nav__link> <span class=md-ellipsis> pandas (optional) </span> </a> <nav class=md-nav aria-label="pandas (optional)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series class=md-nav__link> <span class=md-ellipsis> Series </span> </a> <nav class=md-nav aria-label=Series> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_moment class=md-nav__link> <span class=md-ellipsis> l_moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_ratio class=md-nav__link> <span class=md-ellipsis> l_ratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_stats class=md-nav__link> <span class=md-ellipsis> l_stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_loc class=md-nav__link> <span class=md-ellipsis> l_loc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_scale class=md-nav__link> <span class=md-ellipsis> l_scale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_variation class=md-nav__link> <span class=md-ellipsis> l_variation </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_skew class=md-nav__link> <span class=md-ellipsis> l_skew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.Series.l_kurtosis class=md-nav__link> <span class=md-ellipsis> l_kurtosis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame class=md-nav__link> <span class=md-ellipsis> DataFrame </span> </a> <nav class=md-nav aria-label=DataFrame> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_moment class=md-nav__link> <span class=md-ellipsis> l_moment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_ratio class=md-nav__link> <span class=md-ellipsis> l_ratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_stats class=md-nav__link> <span class=md-ellipsis> l_stats </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_loc class=md-nav__link> <span class=md-ellipsis> l_loc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_scale class=md-nav__link> <span class=md-ellipsis> l_scale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_variation class=md-nav__link> <span class=md-ellipsis> l_variation </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_skew class=md-nav__link> <span class=md-ellipsis> l_skew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_kurtosis class=md-nav__link> <span class=md-ellipsis> l_kurtosis </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_kurt class=md-nav__link> <span class=md-ellipsis> l_kurt </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_comoment class=md-nav__link> <span class=md-ellipsis> l_comoment </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_coratio class=md-nav__link> <span class=md-ellipsis> l_coratio </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_coloc class=md-nav__link> <span class=md-ellipsis> l_coloc </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_coscale class=md-nav__link> <span class=md-ellipsis> l_coscale </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_corr class=md-nav__link> <span class=md-ellipsis> l_corr </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_coskew class=md-nav__link> <span class=md-ellipsis> l_coskew </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_cokurtosis class=md-nav__link> <span class=md-ellipsis> l_cokurtosis </span> </a> </li> <li class=md-nav__item> <a href=#lmo.contrib.pandas.DataFrame.l_cokurt class=md-nav__link> <span class=md-ellipsis> l_cokurt </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#low-level-api class=md-nav__link> <span class=md-ellipsis> Low-level API </span> </a> <nav class=md-nav aria-label="Low-level API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.l_weights class=md-nav__link> <span class=md-ellipsis> l_weights </span> </a> </li> <li class=md-nav__item> <a href=#constants class=md-nav__link> <span class=md-ellipsis> constants </span> </a> <nav class=md-nav aria-label=constants> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.constants.theta_m class=md-nav__link> <span class=md-ellipsis> theta_m </span> </a> </li> <li class=md-nav__item> <a href=#lmo.constants.theta_m_bar class=md-nav__link> <span class=md-ellipsis> theta_m_bar </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#inference class=md-nav__link> <span class=md-ellipsis> inference </span> </a> <nav class=md-nav aria-label=inference> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.GMMResult class=md-nav__link> <span class=md-ellipsis> GMMResult </span> </a> <nav class=md-nav aria-label=GMMResult> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_arg class=md-nav__link> <span class=md-ellipsis> n_arg </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_con class=md-nav__link> <span class=md-ellipsis> n_con </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_extra class=md-nav__link> <span class=md-ellipsis> n_extra </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.j_test class=md-nav__link> <span class=md-ellipsis> j_test </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AIC class=md-nav__link> <span class=md-ellipsis> AIC </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AICc class=md-nav__link> <span class=md-ellipsis> AICc </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.inference.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linalg class=md-nav__link> <span class=md-ellipsis> linalg </span> </a> <nav class=md-nav aria-label=linalg> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.linalg.sandwich class=md-nav__link> <span class=md-ellipsis> sandwich </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.pascal class=md-nav__link> <span class=md-ellipsis> pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.ir_pascal class=md-nav__link> <span class=md-ellipsis> ir_pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_legendre class=md-nav__link> <span class=md-ellipsis> sh_legendre </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_jacobi class=md-nav__link> <span class=md-ellipsis> sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.succession_matrix class=md-nav__link> <span class=md-ellipsis> succession_matrix </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.trim_matrix class=md-nav__link> <span class=md-ellipsis> trim_matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ostats class=md-nav__link> <span class=md-ellipsis> ostats </span> </a> <nav class=md-nav aria-label=ostats> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.ostats.weights class=md-nav__link> <span class=md-ellipsis> weights </span> </a> </li> <li class=md-nav__item> <a href=#lmo.ostats.from_cdf class=md-nav__link> <span class=md-ellipsis> from_cdf </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pwm_beta class=md-nav__link> <span class=md-ellipsis> pwm_beta </span> </a> <nav class=md-nav aria-label=pwm_beta> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.pwm_beta.weights class=md-nav__link> <span class=md-ellipsis> weights </span> </a> </li> <li class=md-nav__item> <a href=#lmo.pwm_beta.cov class=md-nav__link> <span class=md-ellipsis> cov </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#special class=md-nav__link> <span class=md-ellipsis> special </span> </a> <nav class=md-nav aria-label=special> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.special.fpow class=md-nav__link> <span class=md-ellipsis> fpow </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.gamma2 class=md-nav__link> <span class=md-ellipsis> gamma2 </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.harmonic class=md-nav__link> <span class=md-ellipsis> harmonic </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.norm_sh_jacobi class=md-nav__link> <span class=md-ellipsis> norm_sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.fourier_jacobi class=md-nav__link> <span class=md-ellipsis> fourier_jacobi </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#theoretical class=md-nav__link> <span class=md-ellipsis> theoretical </span> </a> <nav class=md-nav aria-label=theoretical> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_cdf class=md-nav__link> <span class=md-ellipsis> l_moment_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_ppf class=md-nav__link> <span class=md-ellipsis> l_moment_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_qdf class=md-nav__link> <span class=md-ellipsis> l_moment_from_qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_cdf class=md-nav__link> <span class=md-ellipsis> l_ratio_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_ppf class=md-nav__link> <span class=md-ellipsis> l_ratio_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_cdf class=md-nav__link> <span class=md-ellipsis> l_stats_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_ppf class=md-nav__link> <span class=md-ellipsis> l_stats_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> l_moment_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> l_stats_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> l_moment_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> l_ratio_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_comoment_from_pdf class=md-nav__link> <span class=md-ellipsis> l_comoment_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_coratio_from_pdf class=md-nav__link> <span class=md-ellipsis> l_coratio_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.ppf_from_l_moments class=md-nav__link> <span class=md-ellipsis> ppf_from_l_moments </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.qdf_from_l_moments class=md-nav__link> <span class=md-ellipsis> qdf_from_l_moments </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.cdf_from_ppf class=md-nav__link> <span class=md-ellipsis> cdf_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.entropy_from_qdf class=md-nav__link> <span class=md-ellipsis> entropy_from_qdf </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../distributions/ class=md-nav__link> <span class=md-ellipsis> Distributions </span> </a> </li> <li class=md-nav__item> <a href=../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=lmo-reference>Lmo reference<a class=headerlink href=#lmo-reference title="Permanent link">&para;</a></h1> <h2 id=high-level-api>High-level API<a class=headerlink href=#high-level-api title="Permanent link">&para;</a></h2> <h3 id=sample-l-moments>Sample L-moments<a class=headerlink href=#sample-l-moments title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Lmo: Robust statistics with trimmed L-moments and L-comoments.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.l_kurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_kurtosis class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>L-kurtosis coefficient; the 4th sample L-moment ratio.</p> <div class=arithmatex>\[ \tau^{(s, t)}_4 = \frac {\lambda^{(s, t)}_4} {\lambda^{(s, t)}_2} \]</div> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio(a, 4, 2, *, **)</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span><span class=o>.</span><span class=n>standard_t</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>0.28912787</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.19928182</span>
</code></pre></div> <details class=notes open> <summary>Notes</summary> <p>The L-kurtosis <span class=arithmatex>\(\tau_4\)</span> lies within the interval <span class=arithmatex>\([-\frac{1}{4}, 1)\)</span>, and by the L-skewness <span class=arithmatex>\(\\tau_3\)</span> as <span class=arithmatex>\(5 \tau_3^2 - 1 \le 4 \tau_4\)</span>.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.kurtosis.html#scipy.stats.kurtosis><code>scipy.stats.kurtosis</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_loc class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_loc class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p><em>L-location</em> (or <em>L-loc</em>): unbiased estimator of the first L-moment, <span class=arithmatex>\(\lambda^{(s, t)}_1\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment(a, 1, *, **)</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>The first moment (i.e. the mean) of the Cauchy distribution does not exist. This means that estimating the location of a Cauchy distribution from its samples, cannot be done using the traditional average (i.e. the arithmetic mean). Instead, a robust location measure should be used, e.g. the median, or the TL-location.</p> <p>To illustrate, let&rsquo;s start by drawing some samples from the standard Cauchy distribution, which is centered around the origin.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>standard_cauchy</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
</code></pre></div> <p>The mean and the untrimmed L-location (which are equivalent) give wrong results, so don&rsquo;t do this:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>-3.6805</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>-3.6805</span>
</code></pre></div> <p>Usually, the answer to this problem is to use the median. However, the median only considers one or two samples (depending on whether the amount of samples is odd or even, respectively). So the median ignores most of the available information.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>median</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>0.096825</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span><span class=p>)</span>
<span class=go>0.096825</span>
</code></pre></div> <p>Luckily for us, Lmo knows how to deal with longs tails, as well &ndash; trimming them (specifically, by skipping the first <span class=arithmatex>\(s\)</span> and last <span class=arithmatex>\(t\)</span> expected order statistics).</p> <p>Let&rsquo;s try the TL-location (which is equivalent to the median)</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># equivalent to `trim=(1, 1)`</span>
<span class=go>0.06522</span>
</code></pre></div> <details class=notes open> <summary>Notes</summary> <p>The trimmed L-location naturally unifies the arithmetic mean, the median, the minimum and the maximum. In particular, the following are equivalent, given <code>n = len(x)</code>:</p> <ul> <li><code>l_loc(x, trim=0)</code> / <code>statistics.mean(x)</code> / <code>np.mean(x)</code></li> <li><code>l_loc(x, trim=(n-1) // 2)</code> / <code>statistics.median(x)</code> / <code>np.median(x)</code></li> <li><code>l_loc(x, trim=(0, n-1))</code> / <code>min(x)</code> / <code>np.min(x)</code></li> <li><code>l_loc(x, trim=(n-1, 0))</code> / <code>max(x)</code> / <code>np.max(x)</code></li> </ul> <p>Note that numerical noise might cause slight differences between their results.</p> <p>Even though <code>lmo</code> is built with performance in mind, the equivalent <code>numpy</code> functions are always faster, as they don&rsquo;t need to sort <em>all</em> samples. Specifically, the time complexity of <code>lmo.l_loc</code> (and <code>l_moment</code> in general) is <span class=arithmatex>\(O(n \log n)\)</span>, whereas that of <code>numpy.{mean,median,min,max}</code> is <code>O(n)</code></p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> <li><a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.average.html#numpy.average><code>numpy.average</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=n>fweights</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>aweights</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>cache</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.l_moment class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Estimates the generalized trimmed L-moment <span class=arithmatex>\(\lambda^{(s, t)}_r\)</span> from the samples along the specified axis. By default, this will be the regular L-moment, <span class=arithmatex>\(\lambda_r = \lambda^{(0, 0)}_r\)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Array containing numbers whose L-moments is desired. If <code>a</code> is not an array, a conversion is attempted.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order(s), non-negative integer or array.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.IntVector>IntVector</span> | <span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders <span class=arithmatex>\((s, t)\)</span>, non-negative ints or floats that are bound by <span class=arithmatex>\(s + t &lt; n - r\)</span>. A single scalar <span class=arithmatex>\(t\)</span> can be proivided as well, as alias for <span class=arithmatex>\((t, t)\)</span>.</p> <p>Some special cases include:</p> <ul> <li><span class=arithmatex>\((0, 0)\)</span>: The original <strong>L</strong>-moment, introduced by Hosking in 1990.</li> <li><span class=arithmatex>\((0, t)\)</span>: <strong>LL</strong>-moment (<strong>L</strong>inear combination of <strong>L</strong>owest order statistics), introduced by Bayazit &amp; Onoz in 2002. Assigns more weight to smaller observations.</li> <li><span class=arithmatex>\((s, 0)\)</span>: <strong>LH</strong>-moment (<strong>L</strong>inear combination of <strong>H</strong>igher order statistics), as described by Wang in 1997. Assigns more weight to larger observations.</li> <li><span class=arithmatex>\((t, t)\)</span>: <strong>TL</strong>-moment (<strong>T</strong>rimmed L-moment) <span class=arithmatex>\(\\lambda_r^t\)</span>, with symmetric trimming. First introduced by Elamir &amp; Seheult in 2003, and refined by Hosking in 2007. Generally more robust than L-moments. Useful for fitting pathological distributions, such as the Cauchy distribution.</li> </ul> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>axis</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Axis along which to calculate the moments. If <code>None</code> (default), all samples in the array will be used.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Floating type to use in computing the L-moments. Default is <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64><code>numpy.float64</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo._lm.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo._lm.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>fweights</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-D array of integer frequency weights; the number of times each observation vector should be repeated.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.IntVector>IntVector</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>aweights</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>An array of weights associated with the values in <code>a</code>. Each value in <code>a</code> contributes to the average according to its associated weight. The weights array can either be 1-D (in which case its length must be the size of a along the given axis) or of the same shape as <code>a</code>. If <code>aweights=None</code> (default), then all data in <code>a</code> are assumed to have a weight equal to one.</p> <p>All <code>aweights</code> must be <code>&gt;=0</code>, and the sum must be nonzero.</p> <p>The algorithm is similar to that for weighted quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>sort</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sorting algorithm, see <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.sort.html#numpy.sort><code>numpy.sort</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>quick | stable | heap</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>cache</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Set to <code>True</code> to speed up future L-moment calculations that have the same number of observations in <code>a</code>, equal <code>trim</code>, and equal or smaller <code>r</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>l</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The L-moment(s) of the input This is a scalar iff a is 1-d and r is a scalar. Otherwise, this is an array with <code>np.ndim(r) + np.ndim(a) - 1</code> dimensions and shape like <code>(*np.shape(r), *(d for d in np.shape(a) if d != axis))</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo._lm.T>T</span>] | <span title=lmo._lm.T>T</span></code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate the L-location and L-scale from student-T(2) samples, for different (symmetric) trim-lengths.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span><span class=o>.</span><span class=n>standard_t</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=go>array([-0.01412282,  0.94063132])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=mi>2</span><span class=p>))</span>
<span class=go>array([-0.02158858,  0.5796519 ])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([-0.0124483 ,  0.40120115])</span>
</code></pre></div> <p>The theoretical L-locations are all 0, and the the L-scale are <code>1.1107</code>, <code>0.6002</code> and <code>0.4165</code>, respectively.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/L-moment>L-moment - Wikipedia</a></li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.moment.html#scipy.stats.moment><code>scipy.stats.moment</code></a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990)</a></li> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_moment_cov class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment_cov</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r_max</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_moment_cov class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Non-parmateric auto-covariance matrix of the generalized trimmed L-moment point estimates with orders <code>r = 1, ..., r_max</code>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>S_l</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Variance-covariance matrix/tensor of shape <code>(r_max, r_max, ...)</code></p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo._lm.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Fitting of the cauchy distribution with TL-moments. The location is equal to the TL-location, and scale should be <span class=arithmatex>\(0.698\)</span> times the TL(1)-scale, see Elamir &amp; Seheult (2003).</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>standard_cauchy</span><span class=p>(</span><span class=mi>1337</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([0.08142405, 0.68884917])</span>
</code></pre></div> <p>The L-moment estimates seem to make sense. Let&rsquo;s check their standard errors, by taking the square root of the variances (the diagonal of the covariance matrix):</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment_cov</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([[ 4.89407076e-03, -4.26419310e-05],</span>
<span class=go>       [-4.26419310e-05,  1.30898414e-03]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>_</span><span class=o>.</span><span class=n>diagonal</span><span class=p>())</span>
<span class=go>array([0.06995764, 0.03617989])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> <li><a href=https://wikipedia.org/wiki/Covariance_matrix>Covariance matrix - Wikipedia</a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/S0378-3758(03)00213-1>E. Elamir &amp; A. Seheult (2004) - Exact variance structure of sample L-moments</a></li> </ul> </details> <details class=todo open> <summary>Todo</summary> <ul> <li>Use the direct (Jacobi) method from Hosking (2015).</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_moment_influence class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment_influence</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.l_moment_influence class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Empirical Influence Function (EIF) of a sample L-moment.</p> <details class=notes open> <summary>Notes</summary> <p>This function is not vectorized.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-D array-like containing observed samples.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order. Must be a non-negative integer.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.SupportsIndex href=https://docs.python.org/3/library/typing.html#typing.SupportsIndex>SupportsIndex</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>sort</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sorting algorithm, see <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.sort.html#numpy.sort><code>numpy.sort</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>quick | stable | heap</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The (vectorized) empirical influence function.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo._lm.V>V</span>], <span title=lmo._lm.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_ratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_ratio class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Estimates the generalized L-moment ratio.</p> <div class=arithmatex>\[ \tau^{(s, t)}_{rs} = \frac {\lambda^{(s, t)}_r} {\lambda^{(s, t)}_s} \]</div> <p>Equivalent to <code>lmo.l_moment(a, r, *, **) / lmo.l_moment(a, s, *, **)</code>.</p> <p>The L-moment with <code>r=0</code> is <code>1</code>, so the <code>l_ratio(a, r, 0, *, **)</code> is equivalent to <code>l_moment(a, r, *, **)</code>.</p> <details class=notes open> <summary>Notes</summary> <p>Often, when referring to the <span class=arithmatex>\(r\)</span>th <em>L-ratio</em>, the L-moment ratio with <span class=arithmatex>\(k=2\)</span> is implied, i.e. <span class=arithmatex>\(\tau^{(s, t)}_r\)</span> is short-hand notation for <span class=arithmatex>\(\tau^{(s, t)}_{r,2}\)</span>.</p> <p>The L-variation (L-moment Coefficient of Variation, or L-CB) is another special case of the L-moment ratio, <span class=arithmatex>\(\tau^{(s, t)}_{2,1}\)</span>. It is sometimes denoted in the literature by dropping the subscript indices: <span class=arithmatex>\(\tau^{(s, t)}\)</span>. Note that this should only be used with strictly positive distributions.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Estimate the L-location, L-scale, L-skewness and L-kurtosis simultaneously:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>lognormal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<span class=go>array([1.53196368, 0.77549561, 0.4463163 , 0.29752178])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([0.75646807, 0.32203446, 0.23887609, 0.07917904])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_ratio_influence class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.l_ratio_influence class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Empirical Influence Function (EIF) of a sample L-moment ratio.</p> <details class=notes open> <summary>Notes</summary> <p>This function is not vectorized.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-D array-like containing observed samples.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment ratio order. Must be a non-negative integer.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.SupportsIndex href=https://docs.python.org/3/library/typing.html#typing.SupportsIndex>SupportsIndex</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Denominator L-moment order, defaults to 2.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.SupportsIndex href=https://docs.python.org/3/library/typing.html#typing.SupportsIndex>SupportsIndex</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>2</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>sort</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sorting algorithm, see <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.sort.html#numpy.sort><code>numpy.sort</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>quick | stable | heap</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The (vectorized) empirical influence function.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo._lm.V>V</span>], <span title=lmo._lm.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_ratio_se class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio_se</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_ratio_se class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Non-parametric estimates of the Standard Error (SE) in the L-ratio estimates from <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Estimate the values and errors of the TL-loc, scale, skew and kurtosis for Cauchy-distributed samples. The theoretical values are <code>[0.0, 0.698, 0.0, 0.343]</code> (Elamir &amp; Seheult, 2003), respectively.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>standard_cauchy</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([-0.25830513,  0.61738638, -0.03069701,  0.25550176])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_ratio_se</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([0.32857302, 0.12896501, 0.13835403, 0.07188138])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment_cov><code>lmo.l_moment_cov</code></a></li> <li><a href=https://wikipedia.org/wiki/Propagation_of_uncertainty>Propagation of uncertainty</a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/S0378-3758(03)00213-1>E. Elamir &amp; A. Seheult (2004) - Exact variance structure of sample L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_scale</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_scale class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p><em>L-scale</em> unbiased estimator for the second L-moment, <span class=arithmatex>\(\lambda^{(s, t)}_2\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment(a, 2, *, **)</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span><span class=o>.</span><span class=n>standard_cauchy</span><span class=p>(</span><span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=go>72.87715244</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_scale</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>9.501123995</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_scale</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.658993279</span>
</code></pre></div> <details class=notes open> <summary>Notes</summary> <p>If <code>trim = (0, 0)</code> (default), the L-scale is equivalent to half the <a href=https://wikipedia.org/wiki/Gini_mean_difference>Gini mean difference (GMD)</a>.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> <li><a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.std.html#numpy.std><code>numpy.std</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_skew class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_skew</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_skew class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Unbiased sample estimator for the <em>L-skewness</em> coefficient.</p> <div class=arithmatex>\[ \tau^{(s, t)}_3 = \frac {\lambda^{(s, t)}_3} {\lambda^{(s, t)}_2} \]</div> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio(a, 3, 2, *, **)</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span><span class=o>.</span><span class=n>standard_exponential</span><span class=p>(</span><span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_skew</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>0.38524343</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_skew</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.27116139</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.skew.html#scipy.stats.skew><code>scipy.stats.skew</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_stats</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_stats class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the L-loc(ation), L-scale, L-skew(ness) and L-kurtosis.</p> <p>Equivalent to <code>lmo.l_ratio(a, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code> by default.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>scipy.stats</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>scipy</span><span class=o>.</span><span class=n>stats</span><span class=o>.</span><span class=n>gumbel_r</span><span class=o>.</span><span class=n>rvs</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>99</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_stats</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([0.79014773, 0.68346357, 0.12207413, 0.12829047])</span>
</code></pre></div> <p>The theoretical L-stats of the standard Gumbel distribution are <code>[0.577, 0.693, 0.170, 0.150]</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats_se><code>lmo.l_stats_se</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_costats><code>lmo.l_costats</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_stats_se class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_stats_se</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_stats_se class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the standard errors (SE&rsquo;s) of the <a class="autorefs autorefs-internal" href=#lmo.l_stats><code>L-stats</code></a>.</p> <p>Equivalent to <code>lmo.l_ratio_se(a, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code> by default.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>scipy.stats</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>scipy</span><span class=o>.</span><span class=n>stats</span><span class=o>.</span><span class=n>gumbel_r</span><span class=o>.</span><span class=n>rvs</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>99</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_stats</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([0.79014773, 0.68346357, 0.12207413, 0.12829047])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_stats_se</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([0.12305147, 0.05348839, 0.04472984, 0.03408495])</span>
</code></pre></div> <p>The theoretical L-stats of the standard Gumbel distribution are <code>[0.577, 0.693, 0.170, 0.150]</code>. The corresponding relative z-scores are <code>[-1.730, 0.181, 1.070, 0.648]</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio_se><code>lmo.l_ratio_se</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_variation class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_variation</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_variation class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>The <em>coefficient of L-variation</em> (or <em>L-CV</em>) unbiased sample estimator:</p> <div class=arithmatex>\[ \tau^{(s, t)} = \frac {\lambda^{(s, t)}_2} {\lambda^{(s, t)}_1} \]</div> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio(a, 2, 1, *, **)</code></a>.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span><span class=o>.</span><span class=n>pareto</span><span class=p>(</span><span class=mf>4.2</span><span class=p>,</span> <span class=mi>99</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=go>1.32161112</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_variation</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>0.59073639</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_variation</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.55395044</span>
</code></pre></div> <details class=notes open> <summary>Notes</summary> <p>If <code>trim = (0, 0)</code> (default), this is equivalent to the <a href=https://wikipedia.org/wiki/Arithmetic_mean>Gini coefficient</a>, and lies within the interval <span class=arithmatex>\((0, 1)\)</span>.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Gini_coefficient>Gini coefficient - Wikipedia</a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.variation.html#scipy.stats.variation><code>scipy.stats.variation.l_ratio</code></a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=sample-l-comoments>Sample L-comoments<a class=headerlink href=#sample-l-comoments title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Lmo: Robust statistics with trimmed L-moments and L-comoments.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.l_cokurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_cokurtosis</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_cokurtosis class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Sample L-cokurtosis coefficient matrix <span class=arithmatex>\(\tilde\Lambda^{(t_1, t_2)}_4\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio(a, 4, 2, *, **)</code></a>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_kurtosis><code>lmo.l_kurtosis</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_coloc class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_coloc</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_coloc class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>L-colocation matrix of 1st L-comoment estimates, <span class=arithmatex>\(\Lambda^{(t_1, t_2)}_1\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment(a, 1, *, **)</code></a>.</p> <details class=notes open> <summary>Notes</summary> <p>If <code>trim = (0, 0)</code> (default), the L-colocation for <span class=arithmatex>\([ij]\)</span> is the L-location <span class=arithmatex>\(\lambda_1\)</span> of <span class=arithmatex>\(x_i\)</span>, independent of <span class=arithmatex>\(x_j\)</span>.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Without trimming, the L-colocation only provides marginal information:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[[</span><span class=mi>6</span><span class=p>,</span> <span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>]],</span> <span class=mi>99</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([-0.02678225,  0.03008309])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_coloc</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([[-0.02678225, -0.02678225],</span>
<span class=go>       [ 0.03008309,  0.03008309]])</span>
</code></pre></div> <p>But the trimmed L-locations are a different story&hellip;</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_loc</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([-0.10488868, -0.00625729])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_coloc</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([[-0.10488868, -0.03797989],</span>
<span class=go>       [ 0.03325074, -0.00625729]])</span>
</code></pre></div> <p>What this tells us, is somewhat of a mystery: trimmed L-comoments have been only been briefly <em>mentioned</em> once or twice in the literature.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_loc><code>lmo.l_loc</code></a></li> <li><a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean><code>numpy.mean</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_comoment class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_comoment</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=n>rowvar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>cache</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.l_comoment class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Multivariate extension of <a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a>.</p> <p>Estimates the L-comoment matrix:</p> <div class=arithmatex>\[ \Lambda_{r}^{(t_1, t_2)} = \left[ \lambda_{r [ij]}^{(t_1, t_2)} \right]_{m \times m} \]</div> <p>Whereas the L-moments are calculated using the order statistics of the observations, i.e. by sorting, the L-comoment sorts <span class=arithmatex>\(x_i\)</span> using the order of <span class=arithmatex>\(x_j\)</span>. This means that in general, <span class=arithmatex>\(\lambda_{r [ij]}^{(t_1, t_2)} \neq \lambda_{r [ji]}^{(t_1, t_2)}\)</span>, i.e. <span class=arithmatex>\(\Lambda_{r}^{(t_1, t_2)}\)</span> is not symmetric.</p> <p>The <span class=arithmatex>\(r\)</span>-th L-comoment <span class=arithmatex>\(\lambda_{r [ij]}^{(t_1, t_2)}\)</span> reduces to the L-moment if <span class=arithmatex>\(i=j\)</span>, and can therefore be seen as a generalization of the (univariate) L-moments. Similar to how the diagonal of a covariance matrix contains the variances, the diagonal of the L-comoment matrix contains the L-moments.</p> <p>Based on the proposed definition by Serfling &amp; Xiao (2007) for L-comoments. Extended to allow for generalized trimming.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-D or 2-D array-like containing <code>m</code> variables and <code>n</code> observations. Each row of <code>a</code> represents a variable, and each column a single observation of all those variables. Also see <code>rowvar</code> below. If <code>a</code> is not an array, a conversion is attempted.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order(s), non-negative integer or array.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders <span class=arithmatex>\((t_1, t_2)\)</span>, non-negative ints or floats that are bound by <span class=arithmatex>\(t_1 + t_2 &lt; n - r\)</span>.</p> <p>Some special cases include:</p> <ul> <li><span class=arithmatex>\((0, 0)\)</span>: The original <strong>L</strong>-moment, introduced by Hosking (1990). Useful for fitting the e.g. log-normal and generalized extreme value (GEV) distributions.</li> <li><span class=arithmatex>\((0, m)\)</span>: <strong>LL</strong>-moment (<strong>L</strong>inear combination of <strong>L</strong>owest order statistics), introduced by Bayazit &amp; Onoz (2002). Assigns more weight to smaller observations.</li> <li><span class=arithmatex>\((s, 0)\)</span>: <strong>LH</strong>-moment (<strong>L</strong>inear combination of <strong>H</strong>igher order statistics), by Wang (1997). Assigns more weight to larger observations.</li> <li><span class=arithmatex>\((t, t)\)</span>: <strong>TL</strong>-moment (<strong>T</strong>rimmed L-moment) <span class=arithmatex>\(\\lambda_r^t\)</span>, with symmetric trimming. First introduced by Elamir &amp; Seheult (2003). Generally more robust than L-moments. Useful for fitting heavy-tailed distributions, such as the Cauchy distribution.</li> </ul> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>rowvar</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If <code>rowvar</code> is True (default), then each row (axis 0) represents a variable, with observations in the columns (axis 1). Otherwise, the relationship is transposed: each column represents a variable, while the rows contain observations.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Floating type to use in computing the L-moments. Default is <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64><code>numpy.float64</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo._lm_co.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo._lm_co.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>sort</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sorting algorithm, see <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.sort.html#numpy.sort><code>numpy.sort</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>quick | stable | heap</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>cache</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Set to <code>True</code> to speed up future L-moment calculations that have the same number of observations in <code>a</code>, equal <code>trim</code>, and equal or smaller <code>r</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>L</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Array of shape <code>(*r.shape, m, m)</code> with r-th L-comoments.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo._lm_co.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Estimation of the second L-comoment (the L-coscale) from biviariate normal samples:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[[</span><span class=mi>6</span><span class=p>,</span> <span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>]],</span> <span class=mi>99</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_comoment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=go>array([[ 1.2766793 , -0.83299947],</span>
<span class=go>       [-0.71547941,  1.05990727]])</span>
</code></pre></div> <p>The diagonal contains the univariate L-moments:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([1.2766793 , 1.05990727])</span>
</code></pre></div> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jmva.2007.01.008>R. Serfling &amp; P. Xiao (2007) - A Contribution to Multivariate L-Moments: L-Comoment Matrices</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_coratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_coratio</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_coratio class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Estimate the generalized matrix of L-comoment ratio&rsquo;s.</p> <div class=arithmatex>\[ \tilde \Lambda_{rs}^{(t_1, t_2)} = \left[ \left. \lambda_{r [ij]}^{(t_1, t_2)} \right/ \lambda_{s [ii]}^{(t_1, t_2)} \right]_{m \times m} \]</div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_corr class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_corr</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_corr class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Sample L-correlation coefficient matrix <span class=arithmatex>\(\tilde\Lambda^{(t_1, t_2)}_2\)</span>; the ratio of the L-coscale matrix over the L-scale <strong>column</strong>-vectors.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio(a, 2, 2, *, **)</code></a>.</p> <p>The diagonal consists of all 1&rsquo;s.</p> <p>Where the pearson correlation coefficient measures linearity, the (T)L-correlation coefficient measures monotonicity.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>6</span><span class=p>,</span> <span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[[</span><span class=mi>6</span><span class=p>,</span> <span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>]],</span> <span class=mi>99</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_corr</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([[ 1.        , -0.65247355],</span>
<span class=go>       [-0.67503962,  1.        ]])</span>
</code></pre></div> <p>Let&rsquo;s compare this with the theoretical correlation</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
<span class=go>-0.6546536707079772</span>
</code></pre></div> <p>and the (Pearson) correlation coefficient matrix:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>corrcoef</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>array([[ 1.        , -0.66383285],</span>
<span class=go>       [-0.66383285,  1.        ]])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a></li> <li><a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.corrcoef.html#numpy.corrcoef><code>numpy.corrcoef</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_coscale class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_coscale</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_coscale class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>L-coscale matrix of 2nd L-comoment estimates, <span class=arithmatex>\(\Lambda^{(t_1, t_2)}_2\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment(a, 2, *, **)</code></a>.</p> <p>Analogous to the (auto-) variance-covariance matrix, the L-coscale matrix is positive semi-definite, and its main diagonal contains the L-scale&rsquo;s. conversely, the L-coscale matrix is inherently asymmetric, thus yielding more information.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span><span class=o>,</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[[</span><span class=mi>6</span><span class=p>,</span> <span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>]],</span> <span class=mi>99</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_scale</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.66698774, 0.54440895])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_coscale</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([[ 0.66698774, -0.41025416],</span>
<span class=go>       [-0.37918065,  0.54440895]])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_scale><code>lmo.l_scale</code></a></li> <li><a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.cov.html#numpy.cov><code>numpy.cov</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_coskew class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_coskew</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_coskew class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Sample L-coskewness coefficient matrix <span class=arithmatex>\(\tilde\Lambda^{(t_1, t_2)}_3\)</span>.</p> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio(a, 3, 2, *, **)</code></a>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_skew><code>lmo.l_skew</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.l_costats class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_costats</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.l_costats class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the L-<em>co</em>scale, L-corr(elation), L-<em>co</em>skew(ness) and L-<em>co</em>kurtosis.</p> <p>Equivalent to <code>lmo.l_coratio(a, [2, 2, 3, 4], [0, 2, 2, 2], *, **)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=distributions>Distributions<a class=headerlink href=#distributions title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Probability distributions, compatible with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats><code>scipy.stats</code></a>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h4 id=lmo.distributions.kumaraswamy class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>distributions</span><span class=o>.</span><span class=n>kumaraswamy</span><span class=p>:</span> <span class=n>RVContinuous</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>kumaraswamy_gen</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;kumaraswamy&#39;</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.distributions.kumaraswamy class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A Kumaraswamy random variable, similar to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.beta.html#scipy.stats.beta><code>scipy.stats.beta</code></a>.</p> <p>The probability density function for <a class="autorefs autorefs-internal" href=#lmo.distributions.kumaraswamy><code>kumaraswamy</code></a> is:</p> <div class=arithmatex>\[ f(x, a, b) = a x^{a - 1} b \left(1 - x^a\right)^{b - 1} \]</div> <p>for <span class=arithmatex>\( 0 &lt; x &lt; 1,\ a &gt; 0,\ b &gt; 0 \)</span>.</p> <p><a class="autorefs autorefs-internal" href=../distributions/#kumaraswamy><code>kumaraswamy</code></a> takes <span class=arithmatex>\( a \)</span> and <span class=arithmatex>\( b \)</span> as shape parameters.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=../distributions/#kumaraswamy>Theoretical L-moments - Kumaraswamy</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.distributions.wakeby class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>distributions</span><span class=o>.</span><span class=n>wakeby</span><span class=p>:</span> <span class=n>RVContinuous</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>wakeby_gen</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;wakeby&#39;</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.distributions.wakeby class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A Wakeby random variable, a generalization of <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.genpareto.html#scipy.stats.genpareto><code>scipy.stats.genpareto</code></a>.</p> <p><a class="autorefs autorefs-internal" href=../distributions/#wakeby><code>wakeby</code></a> takes <span class=arithmatex>\( b \)</span>, <span class=arithmatex>\( d \)</span> and <span class=arithmatex>\( f \)</span> as shape parameters.</p> <p>For a detailed description of the Wakeby distribution, refer to <a href=../distributions/#wakeby>Distributions - Wakeby</a>.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.distributions.genlambda class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>distributions</span><span class=o>.</span><span class=n>genlambda</span><span class=p>:</span> <span class=n>RVContinuous</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>genlambda_gen</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;genlambda&#39;</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.distributions.genlambda class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A generalized Tukey-Lambda random variable.</p> <p><code>genlambda</code> takes <code>b</code>, <code>d</code> and <code>f</code> as shape parameters. <code>b</code> and <code>d</code> can be any float, and <code>f</code> requires <code>-1 &lt;= f &lt;= 1</code>.</p> <p>If <code>f == 0</code> and <code>b == d</code>, <code>genlambda</code> is equivalent to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.tukeylambda.html#scipy.stats.tukeylambda><code>scipy.stats.tukeylambda</code></a>, with <code>b</code> (or <code>d</code>) as shape parameter.</p> <p>For a detailed description of the GLD, refer to <a href=../distributions/#gld>Distributions - GLD</a>.</p> </div> </div> <div class="doc doc-object doc-class"> <h4 id=lmo.distributions.l_poly class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>distributions</span><span class=o>.</span><span class=n>l_poly</span><span class=p>(</span><span class=n>lmbda</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Polynomial quantile distribution with (only) the given L-moments.</p> <details class=todo open> <summary>Todo</summary> <ul> <li>Examples</li> <li><code>stats(moments='mv')</code></li> </ul> </details> <p>Create a new <code>l_poly</code> instance.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>lmbda</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-d array-like of L-moments <span class=arithmatex>\( \tlmoment{s,t}{r} \)</span> for <span class=arithmatex>\( r = 1, 2, \ldots, R \)</span>. At least 2 L-moments are required. All remaining L-moments with <span class=arithmatex>\( r &gt; R \)</span> are considered zero.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The trim-length(s) of L-moments <code>lmbda</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>seed</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Random number generator.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.random href=https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random>random</a>.<a class="autorefs autorefs-external" title=numpy.random.Generator href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator>Generator</a> | <span title=lmo.typing.AnyInt>AnyInt</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_poly.random_state class="doc doc-heading"> <code class="highlight language-python"><span class=n>random_state</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>Generator</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href=#lmo.distributions.l_poly.random_state class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The random number generator of the distribution.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>moments</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#lmo.distributions.l_poly.fit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Fit distribution using the (trimmed) L-moment estimates of the given data.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-d array-like with sample observations.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>How many sample L-moments to use, <code>2 &lt;= moments &lt; len(data)</code>. Defaults to <span class=arithmatex>\(\sqrt[3]{n}\)</span>, where <span class=arithmatex>\(n\)</span> is <code>len(data)</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The left and right trim-lengths <span class=arithmatex>\((s, t)\)</span> to use. Defaults to <span class=arithmatex>\((0, 0)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" title=typing.Self href=https://docs.python.org/3/library/typing.html#typing.Self>Self</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A fitted <code>l_poly</code> instance.</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>Invalid <code>data</code> shape.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>Not enough <code>moments</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If the L-moments of the data do not result in strictly monotinically increasing quantile function (PPF).</p> <p>This generally means that either the left, the right, or both <code>trim</code>-orders are too small.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.rvs class="doc doc-heading"> <code class="highlight language-python"><span class=n>rvs</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.rvs class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Draw random variates from the relevant distribution.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>size</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Defining number of random variates, defaults to 1.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, ...] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>random_state</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Seed or <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator><code>numpy.random.Generator</code></a> instance. Defaults to <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.random_state><code>l_poly.random_state</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.random href=https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random>random</a>.<a class="autorefs autorefs-external" title=numpy.random.Generator href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator>Generator</a> | <span title=lmo.typing.AnyInt>AnyInt</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.distributions._ArrF8>_ArrF8</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar or array with shape like <code>size</code>.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.ppf class="doc doc-heading"> <code class="highlight language-python"><span class=n>ppf</span><span class=p>(</span><span class=n>p</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.ppf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/8cQU>Percent point function</a> <span class=arithmatex>\( Q(p) \)</span> (inverse of <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.cdf>CDF</a>, a.k.a. the quantile function) at <span class=arithmatex>\( p \)</span> of the given distribution.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>p</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of lower tail probability values in <span class=arithmatex>\( [0, 1] \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.ppf_from_l_moments><code>ppf_from_l_moments</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.isf class="doc doc-heading"> <code class="highlight language-python"><span class=n>isf</span><span class=p>(</span><span class=n>q</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.isf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Inverse survival function <span class=arithmatex>\( \bar{Q}(q) = Q(1 - q) \)</span> (inverse of <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.sf><code>sf</code></a>) at <span class=arithmatex>\( q \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>q</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of upper tail probability values in <span class=arithmatex>\( [0, 1] \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.qdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>qdf</span><span class=p>(</span><span class=n>p</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.qdf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Quantile density function <span class=arithmatex>\( q \equiv \frac{\dd{Q}}{\dd{p}} \)</span> ( derivative of the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf>PPF</a>) at <span class=arithmatex>\( p \)</span> of the given distribution.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>p</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of lower tail probability values in <span class=arithmatex>\( [0, 1] \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.ppf_from_l_moments><code>qdf_from_l_moments</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>cdf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.cdf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/3ota>Cumulative distribution function</a> <span class=arithmatex>\( F(x) = \mathrm{P}(X \le x) \)</span> at <span class=arithmatex>\( x \)</span> of the given distribution.</p> <details class=note open> <summary>Note</summary> <p>Because the CDF of <code>l_poly</code> is not analytically expressible, it is evaluated numerically using a root-finding algorithm.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.logcdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>logcdf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.logcdf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Logarithm of the cumulative distribution function (CDF) at <span class=arithmatex>\( x \)</span>, i.e. <span class=arithmatex>\( \ln F(x) \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.sf class="doc doc-heading"> <code class="highlight language-python"><span class=n>sf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.sf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Survival function <span class=arithmatex>\(S(x) = \mathrm{P}(X &gt; x) = 1 - \mathrm{P}(X \le x) = 1 - F(x) \)</span> (the complement of the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.cdf>CDF</a>).</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.logsf class="doc doc-heading"> <code class="highlight language-python"><span class=n>logsf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.logsf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Logarithm of the survical function (SF) at <span class=arithmatex>\( x \)</span>, i.e. <span class=arithmatex>\( \ln \left( S(x) \right) \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.pdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>pdf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.pdf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Probability density function <span class=arithmatex>\( f \equiv \frac{\dd{F}}{\dd{x}} \)</span> (derivative of the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.cdf>CDF</a>) at <span class=arithmatex>\( x \)</span>.</p> <p>By applying the <a href=https://w.wiki/8cQS>inverse function rule</a>, the PDF can also defined using the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.qdf>QDF</a> as <span class=arithmatex>\( f(x) = 1 / q\big(F(x)\big) \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.hf class="doc doc-heading"> <code class="highlight language-python"><span class=n>hf</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.hf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/8cWL#Failure_rate_in_the_continuous_sense>Hazard function </a> <span class=arithmatex>\( h(x) = f(x) / S(x) \)</span> at <span class=arithmatex>\( x \)</span>, with <span class=arithmatex>\( f \)</span> and <span class=arithmatex>\( S \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.pdf>PDF</a> and <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.sf>SF</a>, respectively.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like of quantiles.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.median class="doc doc-heading"> <code class="highlight language-python"><span class=n>median</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.median class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/3oaw>Median</a> (50th percentile) of the distribution. Alias for <code>ppf(1 / 2)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf><code>l_poly.ppf</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.mean class="doc doc-heading"> <code class="highlight language-python"><span class=n>mean</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.mean class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The <a href=https://w.wiki/8cQe>mean</a> <span class=arithmatex>\( \mu = \E[X] \)</span> of random varianble <span class=arithmatex>\( X \)</span> of the relevant distribution.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_loc><code>l_poly.l_loc</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.var class="doc doc-heading"> <code class="highlight language-python"><span class=n>var</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.var class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The <a href=https://w.wiki/3jNh>variance</a> <span class=arithmatex>\( \Var[X] = \E\bigl[(X - \E[X])^2\bigr] = \E\bigl[X^2\bigr] - \E[X]^2 = \sigma^2 \)</span> (2nd central product moment) of random varianble <span class=arithmatex>\( X \)</span> of the relevant distribution.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.moment><code>l_poly.moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.std class="doc doc-heading"> <code class="highlight language-python"><span class=n>std</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.std class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The <a href=https://w.wiki/3hwM>standard deviation</a> <span class=arithmatex>\( \Std[X] = \sqrt{\Var[X]} = \sigma \)</span> of random varianble <span class=arithmatex>\( X \)</span> of the relevant distribution.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_scale><code>l_poly.l_scale</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.entropy class="doc doc-heading"> <code class="highlight language-python"><span class=n>entropy</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.entropy class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/8cR3>Differential entropy</a> <span class=arithmatex>\( \mathrm{H}[X] \)</span> of random varianble <span class=arithmatex>\( X \)</span> of the relevant distribution.</p> <p>It is defined as</p> <div class=arithmatex>\[ \mathrm{H}[X] = \E \bigl[ -\ln f(X) \bigr] = -\int_{Q(0)}^{Q(1)} \ln f(x) \dd x = \int_0^1 \ln q(p) \dd p , \]</div> <p>with <span class=arithmatex>\( f(x) \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.pdf>PDF</a>, <span class=arithmatex>\( Q(p) \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf>PPF</a>, and <span class=arithmatex>\( q(p) = Q'(p) \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.qdf>QDF</a>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.entropy_from_qdf><code>entropy_from_qdf</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.support class="doc doc-heading"> <code class="highlight language-python"><span class=n>support</span><span class=p>()</span></code> <a href=#lmo.distributions.l_poly.support class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The support <span class=arithmatex>\( (Q(0), Q(1)) \)</span> of the distribution, where <span class=arithmatex>\( Q(p) \)</span> is the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf>PPF</a>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.interval class="doc doc-heading"> <code class="highlight language-python"><span class=n>interval</span><span class=p>(</span><span class=n>confidence</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.interval class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p><a href=https://w.wiki/3kdb>Confidence interval</a> with equal areas around the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.median>median</a>.</p> <p>For <code>confidence</code> level <span class=arithmatex>\( \alpha \in [0, 1] \)</span>, this function evaluates</p> <div class=arithmatex>\[ \left[ Q\left( \frac{1 - \alpha}{2} \right) , Q\left( \frac{1 + \alpha}{2} \right) \right], \]</div> <p>where <span class=arithmatex>\( Q(p) \)</span> is the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf>PPF</a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>confidence</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like. The Probability that a random varianble will be drawn from the returned range.</p> <p>Each confidence value should be between 0 and 1.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>moment</span><span class=p>(</span><span class=n>n</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.moment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Non-central product moment <span class=arithmatex>\( \E[X^n] \)</span> of <span class=arithmatex>\( X \)</span> of specified order <span class=arithmatex>\( n \)</span>.</p> <details class=note open> <summary>Note</summary> <p>The product moment is evaluated using numerical integration (<a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>), which cannot check whether the product-moment actually exists for the distribution, in which case an invalid result will be returned.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Order <span class=arithmatex>\( n \ge 0 \)</span> of the moment.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_moment><code>l_poly.l_moment</code></a></li> </ul> </details> <details class=todo open> <summary>Todo</summary> <ul> <li>For n&gt;=2, attempt tot infer from <code>_l_moments</code> if the 2nd moment condition holds, using <code>diagnostics.l_moment_bounds</code>.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>stats</span><span class=p>(</span><span class=n>moments</span><span class=o>=</span><span class=s1>&#39;mv&#39;</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Some product-moment statistics of the given distribution.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Composed of letters <code>mvsk</code> defining which product-moment statistic to compute:</p> <dl> <dt><code>'m'</code>:</dt> <dd>Mean <span class=arithmatex>\( \mu = \E[X] \)</span></dd> <dt><code>'v'</code>:</dt> <dd>Variance <span class=arithmatex>\( \sigma^2 = \E[(X - \mu)^2] \)</span></dd> <dt><code>'s'</code>:</dt> <dd>Skewness <span class=arithmatex>\( \E[(X - \mu)^3] / \sigma^3 \)</span></dd> <dt><code>'k'</code>:</dt> <dd>Ex. Kurtosis <span class=arithmatex>\( \E[(X - \mu)^4] / \sigma^4 - 3 \)</span></dd> </dl> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.distributions._STATS>_STATS</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>&#39;mv&#39;</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.expect class="doc doc-heading"> <code class="highlight language-python"><span class=n>expect</span><span class=p>(</span><span class=n>g</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.expect class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Calculate expected value of a function with respect to the distribution by numerical integration.</p> <p>The expected value of a function <span class=arithmatex>\( g(x) \)</span> with respect to a random variable <span class=arithmatex>\( X \)</span> is defined as</p> <div class=arithmatex>\[ \E\left[ g(X) \right] = \int_{Q(0)}^{Q(1)} g(x) f(x) \dd x = \int_0^1 g\big(Q(u)\big) \dd u , \]</div> <p>with <span class=arithmatex>\( f(x) \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.pdf>PDF</a>, and <span class=arithmatex>\( Q \)</span> the <a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.ppf>PPF</a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>g</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Continuous and deterministic function <span class=arithmatex>\( g: \reals \mapsto \reals \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (float) -&gt; float </code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moment</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_moment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Evaluate the population L-moment(s) <span class=arithmatex>\(\lambda^{(s,t)}_r\)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_ratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_ratio</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_ratio class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Evaluate the population L-moment ratio(&rsquo;s) <span class=arithmatex>\(\tau^{(s,t)}_{r,k}\)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order of the denominator, e.g. 2.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_stats</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>moments</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Evaluate the L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>).</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-moments to return. Defaults to 4.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>4</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_loc class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_loc</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_loc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-location of the distribution, i.e. the 1st L-moment.</p> <p>Alias for <code>l_poly.l_moment(1, ...)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_moment><code>l_poly.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_scale</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_scale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-scale of the distribution, i.e. the 2nd L-moment.</p> <p>Alias for <code>l_poly.l_moment(2, ...)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_moment><code>l_poly.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_skew class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_skew</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_skew class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-skewness coefficient of the distribution; the 3rd L-moment ratio.</p> <p>Alias for <code>l_poly.l_ratio(3, 2, ...)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_ratio><code>l_poly.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_poly.l_kurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.distributions.l_poly.l_kurtosis class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-kurtosis coefficient of the distribution; the 4th L-moment ratio.</p> <p>Alias for <code>l_poly.l_ratio(4, 2, ...)</code>.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.distributions.l_poly.l_ratio><code>l_poly.l_ratio</code></a></li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=lmo.distributions.l_rv_nonparametric class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>distributions</span><span class=o>.</span><span class=n>l_rv_nonparametric</span><span class=p>(</span><span class=n>l_moments</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>a</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.distributions.l_rv_nonparametric class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=scipy.stats.distributions.rv_continuous>_rv_continuous</span></code></p> <details class=warning open> <summary>Warning</summary> <p><code>l_rv_nonparametric</code> is deprecated, and will be removed in version <code>0.13</code>. Use <code>l_poly</code> instead.</p> </details> <p>Estimate a distribution using the given L-moments. See <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous><code>scipy.stats.rv_continuous</code></a> for the available method.</p> <p>The PPF (quantile function) is estimated using generalized Fourier series, with the (shifted) Jacobi orthogonal polynomials as basis, and the (scaled) L-moments as coefficients.</p> <p>The <em>corrected</em> version of theorem 3 from Hosking (2007) states that</p> <div class=arithmatex>\[ \widehat{Q}(u) = \sum_{r=1}^{R} \frac{r}{r + s + t} (2r + s + t - 1) \lambda^{(s, t)}_r \shjacobi{r - 1}{t}{s}{2u - 1} \ , \]</div> <p>converges almost everywhere as <span class=arithmatex>\( R \rightarrow \infty \)</span>, for any sufficiently smooth quantile function (PPF) <span class=arithmatex>\( Q(u) \)</span> on <span class=arithmatex>\( u \in (0, 1) \)</span>. Here, <span class=arithmatex>\( \shjacobi n \alpha \beta x = \jacobi{n}{\alpha}{\beta}{2x - 1} \)</span> is a shifted Jacobi polynomial.</p> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> <li><a href=http://functions.wolfram.com/05.06.25.0007.01>Wolfram Research - Jacobi polynomial Fourier Expansion</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Jacobi_polynomials>Jacobi Polynomials - Wikipedia</a></li> <li><a href=https://wikipedia.org/wiki/Generalized_Fourier_series>Generalized Fourier series - Wikipedia</a></li> </ul> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>l_moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Vector containing the first <span class=arithmatex>\(R\)</span> consecutive L-moments <span class=arithmatex>\(\left[ \lambda^{(s, t)}_1 \; \lambda^{(s, t)}_2 \; \dots \; \lambda^{(s, t)}_R \right]\)</span>, where <span class=arithmatex>\(R \ge 2\)</span>.</p> <p>Sample L-moments can be estimated using e.g. <code>lmo.l_moment(x, np.mgrid[:R] + 1, trim=(s, t))</code>.</p> <p>The trim-lengths <span class=arithmatex>\((s, t)\)</span> should be the same for all L-moments.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.FloatVector>FloatVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The left and right trim-lengths <span class=arithmatex>\((s, t)\)</span>, that correspond to the provided <code>l_moments</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Lower bound of the support of the distribution. By default it is estimated from the L-moments.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>b</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Upper bound of the support of the distribution. By default it is estimated from the L-moments.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional params for <code>scipy.stats.rv_continuous</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If <code>len(l_moments) &lt; 2</code>, <code>l_moments.ndim != 1</code>, or there are invalid L-moments / trim-lengths.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_rv_nonparametric.l_moments class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moments</span><span class=p>:</span> <span class=n>npt</span><span class=o>.</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.l_moments class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initial L-moments, for orders <span class=arithmatex>\(r = 1, 2, \dots, R\)</span>.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_rv_nonparametric.trim class="doc doc-heading"> <code class="highlight language-python"><span class=n>trim</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>|</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.trim class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The provided trim-lengths <span class=arithmatex>\((s, t)\)</span>.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_rv_nonparametric.ppf_poly class="doc doc-heading"> <code class="highlight language-python"><span class=n>ppf_poly</span><span class=p>:</span> <span class=n>PolySeries</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.ppf_poly class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Polynomial estimate of the percent point function (PPF), a.k.a. the quantile function (QF), or the inverse cumulative distribution function (ICDF).</p> <details class=note open> <summary>Note</summary> <p>Converges to the &ldquo;true&rdquo; PPF in the mean-squared sense, with weight function <span class=arithmatex>\(q^s (1 - q)^t\)</span> of quantile <span class=arithmatex>\(q \in [0, 1]\)</span>, and trim-lengths <span class=arithmatex>\((t_1, t_2) \in \mathbb{R^+} \times \mathbb{R^+}\)</span>.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=lmo.typing.PolySeries>PolySeries</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.polynomial.legendre.Legendre.html#numpy.polynomial.legendre.Legendre><code>numpy.polynomial.Legendre</code></a> orthogonal polynomial series instance.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_rv_nonparametric.cdf_poly class="doc doc-heading"> <code class="highlight language-python"><span class=n>cdf_poly</span><span class=p>:</span> <span class=n>PolySeries</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-cached"><code>cached</code></small> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.cdf_poly class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Polynomial least-squares interpolation of the CDF.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=lmo.typing.PolySeries>PolySeries</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.polynomial.legendre.Legendre.html#numpy.polynomial.legendre.Legendre><code>numpy.polynomial.Legendre</code></a> orthogonal polynomial series instance.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.distributions.l_rv_nonparametric.pdf_poly class="doc doc-heading"> <code class="highlight language-python"><span class=n>pdf_poly</span><span class=p>:</span> <span class=n>PolySeries</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-cached"><code>cached</code></small> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.pdf_poly class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Derivative of the polynomial interpolation of the CDF, i.e. the polynomial estimate of the PDF.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=lmo.typing.PolySeries>PolySeries</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.polynomial.legendre.Legendre.html#numpy.polynomial.legendre.Legendre><code>numpy.polynomial.Legendre</code></a> orthogonal polynomial series instance.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.distributions.l_rv_nonparametric.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>rmax</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#lmo.distributions.l_rv_nonparametric.fit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Estimate L-moment from the samples, and return a new <code>l_rv_nonparametric</code> instance.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1d array-like with univariate sample observations.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>rmax</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The (maximum) amount of L-moment orders to use. Defaults to <span class=arithmatex>\(\lceil 4 \log_{10} N \rceil\)</span>. The quantile polynomial will be of degree <code>rmax - 1</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.SupportsIndex href=https://docs.python.org/3/library/typing.html#typing.SupportsIndex>SupportsIndex</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The left and right trim-lengths <span class=arithmatex>\((s, t)\)</span>, that correspond to the provided <code>l_moments</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-internal" title=lmo.distributions.l_rv_nonparametric href=#lmo.distributions.l_rv_nonparametric>l_rv_nonparametric</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A fitted</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-internal" title=lmo.distributions.l_rv_nonparametric href=#lmo.distributions.l_rv_nonparametric>l_rv_nonparametric</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p><a class="autorefs autorefs-internal" href=#lmo.distributions.l_rv_nonparametric><code>l_rv_nonparametric</code></a></p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-internal" title=lmo.distributions.l_rv_nonparametric href=#lmo.distributions.l_rv_nonparametric>l_rv_nonparametric</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>instance.</p> </div> </td> </tr> </tbody> </table> <details class=todo open> <summary>Todo</summary> <ul> <li>Optimal <code>rmax</code> selection (the error appears to be periodic..?)</li> <li>Optimal <code>trim</code> selection</li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=lmo.distributions.wakeby_gen class="doc doc-heading"> <code>lmo.distributions.wakeby_gen</code> <a href=#lmo.distributions.wakeby_gen class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=scipy.stats.distributions.rv_continuous>_rv_continuous</span></code></p> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div><h3 id=statistical-test-and-tools>Statistical test and tools<a class=headerlink href=#statistical-test-and-tools title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Hypothesis tests, estimator properties, and performance metrics.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=lmo.diagnostic.HypothesisTestResult class="doc doc-heading"> <code>lmo.diagnostic.HypothesisTestResult</code> <a href=#lmo.diagnostic.HypothesisTestResult class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" title=typing.NamedTuple href=https://docs.python.org/3/library/typing.html#typing.NamedTuple>NamedTuple</a></code></p> <p>Results of a hypothesis test.</p> <table> <thead> <tr> <th><span class=doc-section-title>ATTRIBUTE</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=lmo.diagnostic.HypothesisTestResult.statistic>statistic</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>The raw test statistic. Its distribution depends on the specific test implementation.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.diagnostic._ArrF8>_ArrF8</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.diagnostic.HypothesisTestResult.pvalue>pvalue</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Two-sided probability value corresponding to the the null hypothesis, <span class=arithmatex>\(H_0\)</span>.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.diagnostic._ArrF8>_ArrF8</span></code> </span> </p> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=lmo.diagnostic.HypothesisTestResult.is_valid class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_valid</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>|</span> <span class=n>npt</span><span class=o>.</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>bool_</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.diagnostic.HypothesisTestResult.is_valid class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Check if the statistic is finite and not <code>nan</code>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.diagnostic.HypothesisTestResult.is_significant class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_significant</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mf>0.05</span><span class=p>)</span></code> <a href=#lmo.diagnostic.HypothesisTestResult.is_significant class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Whether or not the null hypothesis can be rejected, with a certain confidence level (5% by default).</p> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.normaltest class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>normaltest</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.diagnostic.normaltest class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Statistical hypothesis test for <strong>non</strong>-normality, using the L-skewness and L-kurtosis coefficients on the sample data..</p> <p>Adapted from Harri &amp; Coble (2011), and includes Hosking&rsquo;s correction.</p> <details class=definition open> <summary>Definition</summary> <ul> <li>H0: The data was drawn from a normal distribution.</li> <li>H1: The data was drawn from a non-normal distribution.</li> </ul> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Compare the testing power with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html#scipy.stats.normaltest><code>scipy.stats.normaltest</code></a> given 10.000 samples from a contaminated normal distribution.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.diagnostic</span> <span class=kn>import</span> <span class=n>normaltest</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>normaltest</span> <span class=k>as</span> <span class=n>normaltest_scipy</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>n</span> <span class=o>=</span> <span class=mi>10_000</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=mf>0.9</span> <span class=o>*</span> <span class=n>rng</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>*</span> <span class=n>rng</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>normaltest</span><span class=p>(</span><span class=n>x</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
<span class=go>0.04806618</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>normaltest_scipy</span><span class=p>(</span><span class=n>x</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
<span class=go>0.08435627</span>
</code></pre></div> <p>At a 5% significance level, Lmo&rsquo;s test is significant (i.e. indicating non-normality), whereas scipy&rsquo;s test isn&rsquo;t (i.e. inconclusive).</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Array-like of sample data.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>axis</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Axis along which to compute the test.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-internal" title=lmo.diagnostic.HypothesisTestResult href=#lmo.diagnostic.HypothesisTestResult>HypothesisTestResult</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A named tuple with:</p> <ul> <li><code>statistic</code>: The <span class=arithmatex>\(\tau^2_{3, 4}\)</span> test statistic.</li> <li><code>pvalue</code>: Two-sided chi squared probability for <span class=arithmatex>\(H_0\)</span>.</li> </ul> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <p><a href=https://doi.org/10.1080/02664763.2010.498508>A. Harri &amp; K.H. Coble (2011) - Normality testing: Two new tests using L-moments</a></p> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.l_moment_gof class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>l_moment_gof</span><span class=p>(</span><span class=n>rv_or_cdf</span><span class=p>,</span> <span class=n>l_moments</span><span class=p>,</span> <span class=n>n_obs</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.diagnostic.l_moment_gof class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Goodness-of-fit (GOF) hypothesis test for the null hypothesis that the observed L-moments come from a distribution with the given <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats><code>scipy.stats</code></a> distribution or cumulative distribution function (CDF).</p> <ul> <li><code>H0</code>: The theoretical probability distribution, with the given CDF, is a good fit for the observed L-moments.</li> <li><code>H1</code>: The distribution is not a good fit for the observed L-moments.</li> </ul> <p>The test statistic is the squared Mahalanobis distance between the <span class=arithmatex>\(n\)</span> observed L-moments, and the theoretical L-moments. It asymptically (in sample size) follows the <a href=https://wikipedia.org/wiki/Chi-squared_distribution><span class=arithmatex>\(\chi^2\)</span></a> distribution, with <span class=arithmatex>\(n\)</span> degrees of freedom.</p> <p>The sample L-moments are expected to be of consecutive orders <span class=arithmatex>\(r = 1, 2, \dots, n\)</span>. Generally, the amount of L-moments <span class=arithmatex>\(n\)</span> should not be less than the amount of parameters of the distribution, including the location and scale parameters. Therefore, it is required to have <span class=arithmatex>\(n \ge 2\)</span>.</p> <details class=notes open> <summary>Notes</summary> <p>The theoretical L-moments and their covariance matrix are calculated from the CDF using numerical integration (<a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a> and <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.nquad.html#scipy.integrate.nquad><code>scipy.integrate.nquad</code></a>). Undefined or infinite integrals cannot be detected, in which case the results might be incorrect.</p> <p>If an <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.IntegrationWarning.html#scipy.integrate.IntegrationWarning><code>IntegrationWarning</code></a> is issued, or the function is very slow, then the results are probably incorrect, and larger degrees of trimming should be used.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Test if the samples are drawn from a normal distribution.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.diagnostic</span> <span class=kn>import</span> <span class=n>l_moment_gof</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>norm</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>norm</span><span class=p>(</span><span class=mf>13.12</span><span class=p>,</span> <span class=mf>1.66</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>n</span> <span class=o>=</span> <span class=mi>1_000</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>rvs</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x_lm</span> <span class=o>=</span> <span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_gof</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>x_lm</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span><span class=o>.</span><span class=n>pvalue</span>
<span class=go>0.82597</span>
</code></pre></div> <p>Contaminated samples:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>y</span> <span class=o>=</span> <span class=mf>0.9</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>*</span> <span class=n>rng</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span> <span class=n>X</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>*</span> <span class=mi>10</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y_lm</span> <span class=o>=</span> <span class=n>lmo</span><span class=o>.</span><span class=n>l_moment</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y_lm</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
<span class=go>array([13.193, 1.286, 0.006, 0.168])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_gof</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y_lm</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span><span class=o>.</span><span class=n>pvalue</span>
<span class=go>0.0</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_cov_from_cdf>&lsquo;l_moment_cov_from_cdf&rsquo;</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.l_stats_gof class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>l_stats_gof</span><span class=p>(</span><span class=n>rv_or_cdf</span><span class=p>,</span> <span class=n>l_stats</span><span class=p>,</span> <span class=n>n_obs</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.diagnostic.l_stats_gof class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Analogous to <a class="autorefs autorefs-internal" href=#lmo.diagnostic.l_moment_gof><code>lmo.diagnostic.l_moment_gof</code></a>, but using the L-stats (see <a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a>).</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.l_moment_bounds class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>l_moment_bounds</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <a href=#lmo.diagnostic.l_moment_bounds class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Returns the absolute upper bounds <span class=arithmatex>\(L^{(s,t)}_r\)</span> on L-moments <span class=arithmatex>\(\lambda^{(s,t)}_r\)</span>, proportional to the scale <span class=arithmatex>\(\sigma_X\)</span> (standard deviation) of the probability distribution of random variable <span class=arithmatex>\(X\)</span>. So <span class=arithmatex>\(\left| \lambda^{(s,t)}_r(X) \right| \le \sigma_X \, L^{(s,t)}_r\)</span>, given that standard deviation <span class=arithmatex>\(\sigma_X\)</span> of <span class=arithmatex>\(X\)</span> exists and is finite.</p> <details class=warning open> <summary>Warning</summary> <p>These bounds do not apply to distributions with undefined variance, e.g. the Cauchy distribution, even if trimmed L-moments are used. Distributions with infinite variance (e.g. Student&rsquo;s t with <span class=arithmatex>\(\nu=2\)</span>) are a grey area:</p> <p>For the L-scale (<span class=arithmatex>\(r=2\)</span>), the corresponding bound will not be a valid one. However, it can still be used to find the L-ratio bounds, because the <span class=arithmatex>\(\sigma_X\)</span> terms will cancel out. Doing this is not for the faint of heart, as it requires dividing infinity by infinity. So be sure to wear safety glasses.</p> </details> <p>The bounds are derived by applying the <a href=https://wikipedia.org/wiki/Cauchy%E2%80%93Schwarz_inequality>Cauchy-Schwarz inequality</a> to the covariance-based definition of generalized trimmed L-moment, for <span class=arithmatex>\(r &gt; 1\)</span>:</p> <div class=arithmatex>\[ \lambda^{(s,t)}_r(X) = \frac{r+s+t}{r} \frac{B(r,\, r+s+t)}{B(r+s,\, r+t)} \mathrm{Cov}\left[ X,\; F(X)^s \big(1 - F(X)\big)^t P^{(\alpha, \beta)}_r(X) \right] \;, \]</div> <p>where <span class=arithmatex>\(B\)</span> is the <a href=https://mathworld.wolfram.com/BetaFunction.html>Beta function</a>, <span class=arithmatex>\(P^{(\alpha, \beta)}_r\)</span> the <a href=https://mathworld.wolfram.com/JacobiPolynomial.html>Jacobi polynomial</a>, and <span class=arithmatex>\(F\)</span> the cumulative distribution function of random variable <span class=arithmatex>\(X\)</span>.</p> <p>After a lot of work, one can (and one did) derive the closed-form inequality:</p> <div class=arithmatex>\[ \left| \lambda^{(s,t)}_r(X) \right| \le \frac{\sigma_X}{\sqrt{2 \pi}} \frac{\Gamma(r+s+t+1)}{r} \sqrt{\frac{ B(r-\frac{1}{2}, s+\frac{1}{2}, t+\frac{1}{2}) }{ \Gamma(s+t+1) \Gamma(r+s) \Gamma(r+t) }} \]</div> <p>for <span class=arithmatex>\(r \in \mathbb{N}_{\ge 2}\)</span> and <span class=arithmatex>\(s, t \in \mathbb{R}_{\ge 0}\)</span>, where <span class=arithmatex>\(\Gamma\)</span> is the <a href=https://mathworld.wolfram.com/GammaFunction.html>Gamma function</a>, and <span class=arithmatex>\(B\)</span> the multivariate Beta function</p> <p>For the untrimmed L-moments, this simplifies to</p> <div class=arithmatex>\[ \left| \lambda_r(X) \right| \le \frac{\sigma_X}{\sqrt{2 r - 1}} \,. \]</div> <details class=notes open> <summary>Notes</summary> <p>For <span class=arithmatex>\(r=1\)</span> there are no bounds, i.e. <code>float('inf')</code> is returned.</p> <p>There are no references; this novel finding is not (yet..?) published by the author, <a href=https://github.com/jorenham/ >@jorenham</a>.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders <span class=arithmatex>\((s, t)\)</span>, as a tuple of non-negative ints or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>scale</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The standard deviation <span class=arithmatex>\(\sigma_X\)</span> of the random variable <span class=arithmatex>\(X\)</span>. Defaults to 1.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>1.0</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>float array or scalar like <code>r</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.diagnostic._ArrF8>_ArrF8</span></code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.diagnostic.l_ratio_bounds><code>l_ratio_bounds</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.l_ratio_bounds class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>legacy</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.diagnostic.l_ratio_bounds class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Unlike the standardized product-moments, the L-moment ratio&rsquo;s with <span class=arithmatex>\( r \ge 2 \)</span> are bounded above and below.</p> <p>Specifically, Hosking derived in 2007 that</p> <div class=arithmatex>\[ | \tlratio{r}{s,t}| \le \frac 2 r \frac{\ffact{r + s + t}{r - 2}}{\ffact{r - 1 + s \wedge t}{r - 2}} . \]</div> <p>But this derivation relies on unnecessarily loose Jacobi polynomial bounds. If the actual min and max of the Jacobi polynomials are used instead, the following (tighter) inequality is obtained:</p> <div class=arithmatex>\[ \frac{\dot{w}_r^{(s, t)}}{\dot{w}_2^{(s, t)}} \min_{u \in [0, 1]} \left[ \shjacobi{r - 1}{t + 1}{s + 1}{u} \right] \le \tlratio{s, t}{r} \le \frac{\dot{w}_r^{(s, t)}}{\dot{w}_2^{(s, t)}} \max_{0 \le u \le 1} \left[ \shjacobi{r - 1}{t + 1}{s + 1}{u} \right], \]</div> <p>where</p> <div class=arithmatex>\[ \dot{w}_r^{(s, t)} = \frac{\B(r - 1,\ r + s + t + 1)}{r \B(r + s,\ r + t)}. \]</div> <p><span class=doc-section-title>Examples:</span></p> <p>Without trim, the lower- and upper-bounds of the L-skewness and L-kurtosis are:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
<span class=go>(-1.0, 1.0)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
<span class=go>(-0.25, 1.0)</span>
</code></pre></div> <p>For the L-kurtosis, the &ldquo;legacy&rdquo; bounds by Hosking (2007) are clearly looser:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>legacy</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=go>(-1.0, 1.0)</span>
</code></pre></div> <p>For the symmetrically trimmed TL-moment ratio&rsquo;s:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=go>(-1.2, 1.2)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=go>(-0.15, 1.5)</span>
</code></pre></div> <p>Similarly, those of the LL-ratio&rsquo;s are</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
<span class=go>(-0.8, 2.0)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
<span class=go>(-0.233333, 3.5)</span>
</code></pre></div> <p>The LH-skewness bounds are &ldquo;flipped&rdquo; w.r.t to the LL-skewness, but they are the same for the L*-kurtosis:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=go>(-2.0, 0.8)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_ratio_bounds</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=go>(-0.233333, 3.5)</span>
</code></pre></div> <p>The bounds of multiple L-ratio&rsquo;s can be calculated in one shot:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=n>l_ratio_bounds</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)))</span>
<span class=go>array([[-1.        , -0.19444444, -1.12      , -0.14945848],</span>
<span class=go>       [ 1.33333333,  1.75      ,  2.24      ,  2.8       ]])</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like with the L-moment ratio order(s).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.IntVector>IntVector</span> | <span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment ratio trim-length(s).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>legacy</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If set to <code>True</code>, will use the (looser) by Hosking (2007).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.diagnostic._ArrF8>_ArrF8</span>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.diagnostic._ArrF8>_ArrF8</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A 2-tuple with arrays or scalars, of the lower- and upper bounds.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>l_ratio</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio_se><code>l_ratio_se</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.diagnostic.l_moment_bounds><code>diagnostic.l_moment_bounds</code></a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.rejection_point class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>rejection_point</span><span class=p>(</span><span class=n>influence_fn</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>rho_min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>rho_max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span></code> <a href=#lmo.diagnostic.rejection_point class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the approximate <em>rejection point</em> of an influence function <span class=arithmatex>\(\psi_{T|F}(x)\)</span> given a <em>statistical functional</em> <span class=arithmatex>\(T\)</span> (e.g. an L-moment) and cumulative distribution function <span class=arithmatex>\(F(x)\)</span>.</p> <div class=arithmatex>\[ \rho^*_{T|F} = \inf_{r&gt;0} \left\{ r: | \psi_{T|F}(x) | \le \epsilon, \, |x| &gt; r \right\} \; \]</div> <p>with a <span class=arithmatex>\(\epsilon\)</span> a small positive number, corresponding to the <code>tol</code> param of e.g. <a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence>l_moment_influence </a>, which defaults to <code>1e-8</code>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>The untrimmed L-location isn&rsquo;t robust, e.g. with the standard normal distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>distributions</span> <span class=k>as</span> <span class=n>dists</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.diagnostic</span> <span class=kn>import</span> <span class=n>rejection_point</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>if_l_loc_norm</span> <span class=o>=</span> <span class=n>dists</span><span class=o>.</span><span class=n>norm</span><span class=o>.</span><span class=n>l_moment_influence</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>if_l_loc_norm</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<span class=go>inf</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rejection_point</span><span class=p>(</span><span class=n>if_l_loc_norm</span><span class=p>)</span>
<span class=go>nan</span>
</code></pre></div> <p>For the TL-location of the Gaussian distribution, and even for the Student&rsquo;s t distribution with 4 degrees of freedom (3 also works, but is very slow), they exist.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>influence_norm</span> <span class=o>=</span> <span class=n>dists</span><span class=o>.</span><span class=n>norm</span><span class=o>.</span><span class=n>l_moment_influence</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>influence_t4</span> <span class=o>=</span> <span class=n>dists</span><span class=o>.</span><span class=n>t</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>l_moment_influence</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>influence_norm</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>),</span> <span class=n>influence_t4</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<span class=go>(0.0, 0.0)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rejection_point</span><span class=p>(</span><span class=n>influence_norm</span><span class=p>),</span> <span class=n>rejection_point</span><span class=p>(</span><span class=n>influence_t4</span><span class=p>)</span>
<span class=go>(6.0, 206.0)</span>
</code></pre></div> <details class=notes open> <summary>Notes</summary> <p>Large rejection points (e.g. &gt;1000) are unlikely to be found.</p> <p>For instance, that of the TL-location of the Student&rsquo;s t distribution with 2 degrees of freedom lies between somewhere <code>1e4</code> and <code>1e5</code>, but will not be found. In this case, using <code>trim=2</code> will return <code>166.0</code>.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>influence_fn</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Univariate influence function.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>rho_min</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The minimum <span class=arithmatex>\(\rho^*_{T|F}\)</span> of the search space. Must be finite and non-negative. Defaults to <span class=arithmatex>\(0\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>0</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>rho_max</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The maximum <span class=arithmatex>\(\rho^*_{T|F}\)</span> of the search space. Must be larger than <code>rho_min</code>. Defaults to <span class=arithmatex>\(\infty\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.inf href=https://numpy.org/doc/stable/reference/constants.html#numpy.inf>inf</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A finite or infinite scalar.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence><code>lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.diagnostic.error_sensitivity><code>error_sensitivity</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.error_sensitivity class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>error_sensitivity</span><span class=p>(</span><span class=n>influence_fn</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>domain</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=n>math</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span> <span class=n>math</span><span class=o>.</span><span class=n>inf</span><span class=p>))</span></code> <a href=#lmo.diagnostic.error_sensitivity class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the <em>gross-error sensitivity</em> of an influence function <span class=arithmatex>\(\psi_{T|F}(x)\)</span> given a <em>statistical functional</em> <span class=arithmatex>\(T\)</span> (e.g. an L-moment) and cumulative distribution function <span class=arithmatex>\(F(x)\)</span>.</p> <div class=arithmatex>\[ \gamma^*_{T|F} = \max_{x} \left| \psi_{T|F}(x) \right| \]</div> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the gross-error sensitivity of the standard exponential distribution&rsquo;s LL-skewness (<span class=arithmatex>\(\tau^{(0, 1)}_3\)</span>) and LL-kurtosis (<span class=arithmatex>\(\tau^{(0, 1)}_4\)</span>) coefficients:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.diagnostic</span> <span class=kn>import</span> <span class=n>error_sensitivity</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>expon</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ll_skew_if</span> <span class=o>=</span> <span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ll_kurt_if</span> <span class=o>=</span> <span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>error_sensitivity</span><span class=p>(</span><span class=n>ll_skew_if</span><span class=p>,</span> <span class=n>domain</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)))</span>
<span class=go>1.814657</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>error_sensitivity</span><span class=p>(</span><span class=n>ll_kurt_if</span><span class=p>,</span> <span class=n>domain</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)))</span>
<span class=go>1.377743</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>influence_fn</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Univariate influence function.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>domain</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Domain of the CDF. Defaults to <span class=arithmatex>\((-\infty, \infty)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(-<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/math.html#module-math>math</a>.<a class="autorefs autorefs-external" title=math.inf href=https://docs.python.org/3/library/math.html#math.inf>inf</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/math.html#module-math>math</a>.<a class="autorefs autorefs-external" title=math.inf href=https://docs.python.org/3/library/math.html#math.inf>inf</a>)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Gross-error sensitivity <span class=arithmatex>\(\gamma^*_{T|F}\)</span> .</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence><code>lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.diagnostic.rejection_point><code>rejection_point</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.diagnostic.shift_sensitivity class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>.</span><span class=n>shift_sensitivity</span><span class=p>(</span><span class=n>influence_fn</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>domain</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=n>math</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span> <span class=n>math</span><span class=o>.</span><span class=n>inf</span><span class=p>))</span></code> <a href=#lmo.diagnostic.shift_sensitivity class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the <em>local-shift sensitivity</em> of an influence function <span class=arithmatex>\(\psi_{T|F}(x)\)</span> given a <em>statistical functional</em> <span class=arithmatex>\(T\)</span> (e.g. an L-moment) and cumulative distribution function <span class=arithmatex>\(F(x)\)</span>.</p> <div class=arithmatex>\[ \lambda^*_{T|F} = \max_{x \neq y} \left| \frac{ \psi_{T|F}(y) - \psi_{T|F}(x) }{ y - x } \right| \]</div> <p>Represents the effect of shifting an observation slightly from <span class=arithmatex>\(x\)</span>, to a neighbouring point <span class=arithmatex>\(y\)</span>. For instance, adding an observation at <span class=arithmatex>\(y\)</span> and removing one at <span class=arithmatex>\(x\)</span>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the local-shift sensitivity of the standard exponential distribution&rsquo;s LL-skewness (<span class=arithmatex>\(\tau^{(0, 1)}_3\)</span>) and LL-kurtosis (<span class=arithmatex>\(\tau^{(0, 1)}_4\)</span>) coefficients:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.diagnostic</span> <span class=kn>import</span> <span class=n>shift_sensitivity</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>expon</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ll_skew_if</span> <span class=o>=</span> <span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ll_kurt_if</span> <span class=o>=</span> <span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>domain</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>shift_sensitivity</span><span class=p>(</span><span class=n>ll_skew_if</span><span class=p>,</span> <span class=n>domain</span><span class=p>)</span>
<span class=go>0.837735</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>shift_sensitivity</span><span class=p>(</span><span class=n>ll_kurt_if</span><span class=p>,</span> <span class=n>domain</span><span class=p>)</span>
<span class=go>1.442062</span>
</code></pre></div> <p>Let&rsquo;s compare these with the untrimmed ones:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>shift_sensitivity</span><span class=p>(</span><span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>domain</span><span class=p>)</span>
<span class=go>1.920317</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>shift_sensitivity</span><span class=p>(</span><span class=n>expon</span><span class=o>.</span><span class=n>l_ratio_influence</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>domain</span><span class=p>)</span>
<span class=go>1.047565</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>influence_fn</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Univariate influence function.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>domain</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Domain of the CDF. Defaults to <span class=arithmatex>\((-\infty, \infty)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(-<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/math.html#module-math>math</a>.<a class="autorefs autorefs-external" title=math.inf href=https://docs.python.org/3/library/math.html#math.inf>inf</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/math.html#module-math>math</a>.<a class="autorefs autorefs-external" title=math.inf href=https://docs.python.org/3/library/math.html#math.inf>inf</a>)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Local-shift sensitivity <span class=arithmatex>\(\lambda^*_{T|F}\)</span> .</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence><code>lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.diagnostic.error_sensitivity><code>error_sensitivity</code></a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.2307/2285666>Frank R. Hampel (1974) - The Influence Curve and its Role in Robust Estimation</a></li> </ul> </details> </div> </div> </div> </div> </div><h2 id=third-party-integration>Third party integration<a class=headerlink href=#third-party-integration title="Permanent link">&para;</a></h2> <h3 id=scipystats><code>scipy.stats</code><a class=headerlink href=#scipystats title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Extensions for <code>scipy.stats</code> distributions.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=lmo.contrib.scipy_stats.l_rv_generic class="doc doc-heading"> <code>lmo.contrib.scipy_stats.l_rv_generic</code> <a href=#lmo.contrib.scipy_stats.l_rv_generic class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Additional methods that are patched into <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous><code>scipy.stats.rv_continuous</code></a> and <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_discrete.html#scipy.stats.rv_discrete><code>scipy.stats.rv_discrete</code></a>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moment</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Population L-moment(s) <span class=arithmatex>\(\lambda^{(s,t)}_r\)</span>.</p> <div class=arithmatex>\[ \lambda^{(s, t)}_r = \frac{r+s+t}{r} \frac{B(r,\,r+s+t)}{B(r+s,\,r+t)} \mathbb{E}_X \left[ U^s \left(1 - U\right)^t \,\tilde{P}^{(t, s)}_{r-1}(U) \,X \right] \;, \]</div> <p>with <span class=arithmatex>\(U = F_X(X)\)</span> the <em>rank</em> of <span class=arithmatex>\(X\)</span>, and <span class=arithmatex>\(\tilde{P}^{(a,b)}_n(x)\)</span> the shifted (<span class=arithmatex>\(x \mapsto 2x-1\)</span>) Jacobi polynomial.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the population L-moments of the normally-distributed IQ test:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>norm</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span><span class=o>.</span><span class=n>l_moment</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([100.      ,   8.462844,   0.      ,   1.037559])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>_</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
<span class=go>15.0000004</span>
</code></pre></div> <p>Discrete distributions are also supported, e.g. the Binomial distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>binom</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>binom</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mf>.6</span><span class=p>)</span><span class=o>.</span><span class=n>l_moment</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([ 6.      ,  0.862238, -0.019729,  0.096461])</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p><code>r</code> is not integer-valued</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p><code>r</code> is empty or negative</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>lmbda</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The population L-moment(s), a scalar or float array like <code>r</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a>: sample L-moment</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_ratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_ratio</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-moment ratio(&rsquo;s) <span class=arithmatex>\(\tau^{(s,t)}_{r,k}\)</span>.</p> <div class=arithmatex>\[ \tau^{(s,t)}_{r,k} = \frac{\lambda^{(s,t)}_r}{\lambda^{(s,t)}_k} \]</div> <p>Unless explicitly specified, the r-th (<span class=arithmatex>\(r&gt;2\)</span>) L-ratio, <span class=arithmatex>\(\tau^{(s,t)}_r\)</span> refers to <span class=arithmatex>\(\tau^{(s,t)}_{r, 2}\)</span>. Another special case is the L-variation, or the L-CV, <span class=arithmatex>\(\tau^{(s,t)} = \tau^{(s,t)}_{2, 1}\)</span>. This is the L-moment analogue of the coefficient of variation.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the population L-CV and LL-CV (CV = coefficient of variation) of the standard Rayleigh distribution.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>distributions</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>distributions</span><span class=o>.</span><span class=n>rayleigh</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>X</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># legacy CV</span>
<span class=go>0.5227232</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=go>0.2928932</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.2752551</span>
</code></pre></div> <p>And similarly, for the (discrete) Poisson distribution with rate parameter set to 2, the L-CF and LL-CV evaluate to:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>distributions</span><span class=o>.</span><span class=n>poisson</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>X</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=go>0.7071067</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=go>0.3857527</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_ratio</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>0.4097538</span>
</code></pre></div> <p>Note that (untrimmed) L-CV requires a higher (subdivision) limit in the integration routine, otherwise it&rsquo;ll complain that it didn&rsquo;t converge (enough) yet. This is because it&rsquo;s effectively integrating a non-smooth function, which is mathematically iffy, but works fine in this numerical application.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment ratio order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order of the denominator, e.g. 2.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment><code>l_rv_generic.l_moment</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a> - Sample L-moment ratio estimator</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_stats</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>moments</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>).</p> <p>By default, the first <code>moments = 4</code> population L-stats are calculated:</p> <ul> <li><span class=arithmatex>\(\lambda^{(s,t)}_1\)</span> - <em>L-loc</em>ation</li> <li><span class=arithmatex>\(\lambda^{(s,t)}_2\)</span> - <em>L-scale</em></li> <li><span class=arithmatex>\(\tau^{(s,t)}_3\)</span> - <em>L-skew</em>ness coefficient</li> <li><span class=arithmatex>\(\tau^{(s,t)}_4\)</span> - <em>L-kurt</em>osis coefficient</li> </ul> <p>This method is equivalent to <code>X.l_ratio([1, 2, 3, 4], [0, 0, 2, 2], *, **)</code>, for with default <code>moments = 4</code>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Summarize the standard exponential distribution for different trim-orders.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>distributions</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>distributions</span><span class=o>.</span><span class=n>expon</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats</span><span class=p>()</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([1.      , 0.5     , 0.333333, 0.166667])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=mi>2</span><span class=p>))</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([0.666667, 0.333333, 0.266667, 0.114286])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([0.5     , 0.25    , 0.222222, 0.083333])</span>
</code></pre></div> <details class=note open> <summary>Note</summary> <p>This should not be confused with the term <em>L-statistic</em>, which is sometimes used to describe any linear combination of order statistics.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-moments to return. Defaults to 4.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>4</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio><code>l_rv_generic.l_ratio</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a> - Unbiased sample estimation of L-stats.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_loc class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_loc</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_loc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-location of the distribution, i.e. the 1st L-moment.</p> <p>Alias for <code>X.l_moment(1, ...)</code>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_scale</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_scale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-scale of the distribution, i.e. the 2nd L-moment.</p> <p>Alias for <code>X.l_moment(2, ...)</code>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_skew class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_skew</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_skew class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-skewness coefficient of the distribution; the 3rd L-moment ratio.</p> <p>Alias for <code>X.l_ratio(3, 2, ...)</code>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_kurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_kurtosis</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_kurtosis class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>L-kurtosis coefficient of the distribution; the 4th L-moment ratio.</p> <p>Alias for <code>X.l_ratio(4, 2, ...)</code>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_moments_cov class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moments_cov</span><span class=p>(</span><span class=n>r_max</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moments_cov class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Variance/covariance matrix of the L-moment estimators.</p> <p>L-moments that are estimated from <span class=arithmatex>\(n\)</span> samples of a distribution with CDF <span class=arithmatex>\(F\)</span>, converge to the multivariate normal distribution as the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>.</p> <div class=arithmatex>\[ \sqrt{n} \left( \vec{l}^{(s, t)} - \vec{\lambda}^{(s, t)} \right) \sim \mathcal{N}( \vec{0}, \mathbf{\Lambda}^{(s, t)} ) \]</div> <p>Here, <span class=arithmatex>\(\vec{l}^{(s, t)} = \left[l^{(s,t)}_r, \dots, l^{(s,t)}_{r_{max}}\right]^T\)</span> is a vector of estimated sample L-moments, and <span class=arithmatex>\(\vec{\lambda}^{(s, t)}\)</span> its theoretical (&ldquo;true&rdquo;) counterpart.</p> <p>This function calculates the covariance matrix</p> <div class=arithmatex>\[ \begin{align} \bf{\Lambda}^{(s,t)}_{k, r} &amp;= \mathrm{Cov}[l^{(s, t)}_k, l^{(s, t)}_r] \\ &amp;= c_k c_r \iint\limits_{x &lt; y} \Big[ p_k\big(F(x)\big) \, p_r\big(F(y)\big) + p_r\big(F(x)\big) \, p_k\big(F(y)\big) \Big] w^{(s+1,\, t)}\big(F(x)\big) \, w^{(s,\, t+1)}\big(F(y)\big) \, \mathrm{d}x \, \mathrm{d}y \;, \end{align} \]</div> <p>where</p> <div class=arithmatex>\[ c_n = \frac{\Gamma(n) \Gamma(n+s+t+1)}{n \Gamma(n+s) \Gamma(n+t)}\;, \]</div> <p>the shifted Jacobi polynomial <span class=arithmatex>\(p_n(u) = P^{(t, s)}_{n-1}(2u - 1)\)</span>, <span class=arithmatex>\(P^{(t, s)}_m\)</span>, and <span class=arithmatex>\(w^{(s,t)}(u) = u^s (1-u)^t\)</span> its weight function.</p> <details class=notes open> <summary>Notes</summary> <p>This function is not vectorized or parallelized.</p> <p>For small sample sizes (<span class=arithmatex>\(n &lt; 100\)</span>), the covariances of the higher-order L-moments (<span class=arithmatex>\(r &gt; 2\)</span>) can be biased. But this bias quickly disappears at roughly <span class=arithmatex>\(n &gt; 200\)</span> (depending on the trim- and L-moment orders).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>distributions</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>distributions</span><span class=o>.</span><span class=n>expon</span><span class=p>()</span>  <span class=c1># standard exponential distribution</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_moments_cov</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([[1.      , 0.5     , 0.166667, 0.083333],</span>
<span class=go>    [0.5     , 0.333333, 0.166667, 0.083333],</span>
<span class=go>    [0.166667, 0.166667, 0.133333, 0.083333],</span>
<span class=go>    [0.083333, 0.083333, 0.083333, 0.071429]])</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_moments_cov</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([[0.333333, 0.125   , 0.      , 0.      ],</span>
<span class=go>    [0.125   , 0.075   , 0.016667, 0.      ],</span>
<span class=go>    [0.      , 0.016667, 0.016931, 0.00496 ],</span>
<span class=go>    [0.      , 0.      , 0.00496 , 0.0062  ]])</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r_max</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-moment orders to consider. If for example <code>r_max = 4</code>, the covariance matrix will be of shape <code>(4, 4)</code>, and the columns and rows correspond to the L-moments of order <span class=arithmatex>\(r = 1, \dots, r_{max}\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float. or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cov</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Covariance matrix, with shape <code>(r_max, r_max)</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#RuntimeError>RuntimeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If the covariance matrix is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_stats_cov class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_stats_cov</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>moments</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_stats_cov class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Similar to <a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moments_cov><code>l_moments_cov</code> </a>, but for the <a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_stats><code>l_rv_generic.l_stats</code></a>.</p> <p>As the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>, the L-moment ratio&rsquo;s are also distributed (multivariate) normally. The L-stats are defined to be L-moments for <span class=arithmatex>\(r\le 2\)</span>, and L-ratio coefficients otherwise.</p> <p>The corresponding covariance matrix has been found to be</p> <div class=arithmatex>\[ \bf{T}^{(s, t)}_{k, r} = \begin{cases} \bf{\Lambda}^{(s, t)}_{k, r} &amp; k \le 2 \wedge r \le 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} }{ \lambda^{(s,t)}_{2} } &amp; k \le 2 \wedge r &gt; 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_k \bf{\Lambda}^{(s, t)}_{2, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} + \tau_k \tau_r \bf{\Lambda}^{(s, t)}_{2, 2} }{ \Big( \lambda^{(s,t)}_{2} \Big)^2 } &amp; k &gt; 2 \wedge r &gt; 2 \end{cases} \]</div> <p>where <span class=arithmatex>\(\bf{\Lambda}^{(s, t)}\)</span> is the covariance matrix of the L-moments from <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_cov_from_cdf><code>l_moment_cov_from_cdf</code></a>, and <span class=arithmatex>\(\tau^{(s,t)}_r = \lambda^{(s,t)}_r / \lambda^{(s,t)}_2\)</span> the population L-ratio.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the LL-stats covariance matrix of the standard exponential distribution, for 0, 1, and 2 degrees of trimming.</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>distributions</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>distributions</span><span class=o>.</span><span class=n>expon</span><span class=p>()</span>  <span class=c1># standard exponential distribution</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats_cov</span><span class=p>()</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([[1.      , 0.5     , 0.      , 0.      ],</span>
<span class=go>    [0.5     , 0.333333, 0.111111, 0.055556],</span>
<span class=go>    [0.      , 0.111111, 0.237037, 0.185185],</span>
<span class=go>    [0.      , 0.055556, 0.185185, 0.21164 ]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats_cov</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([[ 0.333333,  0.125   , -0.111111, -0.041667],</span>
<span class=go>    [ 0.125   ,  0.075   ,  0.      , -0.025   ],</span>
<span class=go>    [-0.111111,  0.      ,  0.21164 ,  0.079365],</span>
<span class=go>    [-0.041667, -0.025   ,  0.079365,  0.10754 ]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span><span class=o>.</span><span class=n>l_stats_cov</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
<span class=go>array([[ 0.2     ,  0.066667, -0.114286, -0.02    ],</span>
<span class=go>    [ 0.066667,  0.038095, -0.014286, -0.023333],</span>
<span class=go>    [-0.114286, -0.014286,  0.228571,  0.04    ],</span>
<span class=go>    [-0.02    , -0.023333,  0.04    ,  0.086545]])</span>
</code></pre></div> <p>Note that with 0 trim the L-location is independent of the L-skewness and L-kurtosis. With 1 trim, the L-scale and L-skewness are independent. And with 2 trim, all L-stats depend on each other.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-statistics to consider. Defaults to 4.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>4</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float. or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moment_influence</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment_influence class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Returns the influence function (IF) of an L-moment.</p> <div class=arithmatex>\[ \psi_{\lambda^{(s, t)}_r | F}(x) = c^{(s,t)}_r \, F(x)^s \, \big( 1-{F}(x) \big)^t \, \tilde{P}^{(s,t)}_{r-1} \big( F(x) \big) \, x - \lambda^{(s,t)}_r \;, \]</div> <p>with <span class=arithmatex>\(F\)</span> the CDF, <span class=arithmatex>\(\tilde{P}^{(s,t)}_{r-1}\)</span> the shifted Jacobi polynomial, and</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r+s+t}{r} \frac{B(r, \, r+s+t)}{B(r+s, \, r+t)} \;, \]</div> <p>where <span class=arithmatex>\(B\)</span> is the (complete) Beta function.</p> <p>The proof is trivial, because population L-moments are <a href=https://wikipedia.org/wiki/Linear_form>linear functionals</a>.</p> <details class=notes open> <summary>Notes</summary> <p>The order parameter <code>r</code> is not vectorized.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order <span class=arithmatex>\(r \in \mathbb{N}^+\)</span>..</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float. or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Values that are absolutely smaller than this will be rounded to zero.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>1e-08</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The (vectorized) influence function, <span class=arithmatex>\(\psi_{\lambda^{(s, t)}_r | F}(x)\)</span>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.contrib.scipy_stats.V>V</span>], <span title=lmo.contrib.scipy_stats.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_moment><code>l_rv_generic.l_moment</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.2307/2285666>Frank R. Hampel (1974) - The Influence Curve and its Role in Robust Estimation</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_ratio_influence class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_ratio_influence</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio_influence class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Returns the influence function (IF) of an L-moment ratio.</p> <div class=arithmatex>\[ \psi_{\tau^{(s, t)}_{r,k}|F}(x) = \frac{ \psi_{\lambda^{(s, t)}_r|F}(x) - \tau^{(s, t)}_{r,k} \, \psi_{\lambda^{(s, t)}_k|F}(x) }{ \lambda^{(s,t)}_k } \;, \]</div> <p>where the L-moment ratio is defined as</p> <div class=arithmatex>\[ \tau^{(s, t)}_{r,k} = \frac{ \lambda^{(s, t)}_r }{ \lambda^{(s, t)}_k } \;. \]</div> <p>Because IF&rsquo;s are a special case of the general Gâteuax derivative, the L-ratio IF is derived by applying the chain rule to the <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_influence_from_cdf>L-moment IF</a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment ratio order, i.e. the order of the numerator L-moment.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Denominator L-moment order, defaults to 2.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information)</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float. or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Values that are absolutely smaller than this will be rounded to zero.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>1e-08</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The influence function, with vectorized signature <code>() -&gt; ()</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.contrib.scipy_stats.V>V</span>], <span title=lmo.contrib.scipy_stats.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.contrib.scipy_stats.l_rv_generic.l_ratio><code>l_rv_generic.l_ratio</code> </a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.2307/2285666>Frank R. Hampel (1974) - The Influence Curve and its Role in Robust Estimation</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>n_extra</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>full_output</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>fit_kwargs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_fit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return estimates of shape (if applicable), location, and scale parameters from data. The default estimation method is Method of L-moments (L-MM), but the Generalized Method of L-Moments (L-GMM) is also available (see the <code>n_extra</code> parameter).</p> <p>See <a class="autorefs autorefs-internal" href=#lmo.inference.fit>&lsquo;lmo.inference.fit&rsquo;</a> for details.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Fitting standard normal samples Using scipy&rsquo;s default MLE (Maximum Likelihood Estimation) method:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>norm</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>12345</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>standard_normal</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>(0.0033254, 0.95554)</span>
</code></pre></div> <p>Better results can be obtained different by using Lmo&rsquo;s L-MM (Method of L-moment):</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=o>.</span><span class=n>l_fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
<span class=go>FitArgs(loc=0.0033145, scale=0.96179)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=o>.</span><span class=n>l_fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
<span class=go>FitArgs(loc=0.019765, scale=0.96749)</span>
</code></pre></div> <p>To use more L-moments than the number of parameters, two in this case, <code>n_extra</code> can be used. This will use the L-GMM (Generalized Method of L-Moments), which results in slightly better estimates:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=o>.</span><span class=n>l_fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n_extra</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
<span class=go>FitArgs(loc=0.0039747, scale=0.96233)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>norm</span><span class=o>.</span><span class=n>l_fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_extra</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
<span class=go>FitArgs(loc=-0.00127874, scale=0.968547)</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-D array-like data to use in estimating the distribution parameters.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Starting value(s) for any shape-characterizing arguments ( those not provided will be determined by a call to <code>fit(data)</code>).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n_extra</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of extra L-moment conditions to use than the amount of parameters. If 0 (default), L-MM will be used. If &gt;0, <span class=arithmatex>\(k\)</span>-step L-GMM will be used.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>0</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>full_output</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If set to True, a <code>LGMMResult</code> instance will be returned, instead of only a tuple with parameters.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>fit_kwargs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to be passed to <a class="autorefs autorefs-internal" href=#lmo.inference.fit>&lsquo;lmo.inference.fit&rsquo;</a> or <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize>&lsquo;scipy.optimize.minimize&rsquo;</a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Mapping href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping>Mapping</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a>, <a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a>] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>random_state</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Integer or <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator><code>numpy.random.Generator</code></a> instance, used for Monte-Carlo simulation when <code>n_extra &gt; 0</code>. If <code>None</code> (default), the <code>random_state</code> of this distribution will be used.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.random href=https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random>random</a>.<a class="autorefs autorefs-external" title=numpy.random.Generator href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator>Generator</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Special keyword arguments are recognized as holding certain parameters fixed:</p> <div class=highlight><pre><span></span><code>- `f0...fn`: hold respective shape parameters fixed.
Alternatively, shape parameters to fix can be specified by
name. For example, if `self.shapes == &quot;a, b&quot;`, `fa` and
`fix_a` are equivalent to `f0`, and `fb` and `fix_b` are
equivalent to `f1`.
- `floc`: hold location parameter fixed to specified value.
- `fscale`: hold scale parameter fixed to specified value.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>result</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Named tuple with estimates for any shape parameters (if applicable), followed by those for location and scale. For most random variables, shape statistics will be returned, but there are exceptions (e.g. <code>norm</code>). If <code>full_output=True</code>, an instance of <code>LGMMResult</code> will be returned instead.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>, ...] | <span title=lmo.inference>inference</span>.<a class="autorefs autorefs-internal" title=lmo.inference.GMMResult href=#lmo.inference.GMMResult>GMMResult</a></code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.inference.fit>&lsquo;lmo.inference.fit&rsquo;</a></li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.48550/arXiv.2210.04146>Alvarez et al. (2023) - Inference in parametric models with many L-moments</a></li> </ul> </details> <details class=todo open> <summary>Todo</summary> <ul> <li>Support integral parameters.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.scipy_stats.l_rv_generic.l_fit_loc_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_fit_loc_scale</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.contrib.scipy_stats.l_rv_generic.l_fit_loc_scale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Estimate loc and scale parameters from data using the first two L-moments.</p> <details class=notes open> <summary>Notes</summary> <p>The implementation mimics that of <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.fit_loc_scale.html#scipy.stats.rv_continuous.fit_loc_scale><code>fit_loc_scale()</code></a></p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Data to fit.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The shape parameter(s) for the distribution (see docstring of the instance object for more information).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Can be scalar or 2-tuple of non-negative int or float.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to pass to the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>loc_hat</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Estimated location parameter for the data.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>scale_hat</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Estimated scale parameter for the data.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div> </div><h3 id=pandas-optional><code>pandas</code> (optional)<a class=headerlink href=#pandas-optional title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Extension methods for <code>pandas.Series</code> and <code>pandas.DataFrame</code>.</p> <p>Pandas is an optional dependency, and can be installed using <code>pip install lmo[pandas]</code>.</p> <p><span class=doc-section-title>Examples:</span></p> <p>Univariate summary statistics:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>]})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span><span class=o>.</span><span class=n>l_stats</span><span class=p>()</span>
<span class=go>          a    b</span>
<span class=go>r</span>
<span class=go>1  2.400000  3.8</span>
<span class=go>2  0.700000  0.2</span>
<span class=go>3  0.142857 -1.0</span>
<span class=go>4  0.285714  1.0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span><span class=o>.</span><span class=n>aggregate</span><span class=p>([</span><span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;std&#39;</span><span class=p>,</span> <span class=s1>&#39;skew&#39;</span><span class=p>,</span> <span class=s1>&#39;kurt&#39;</span><span class=p>])</span>
<span class=go>             a         b</span>
<span class=go>mean  2.400000  3.800000</span>
<span class=go>std   1.140175  0.447214</span>
<span class=go>skew  0.404796 -2.236068</span>
<span class=go>kurt -0.177515  5.000000</span>
</code></pre></div> <p>Comparison of L-correlation, and Pearson correlation matrices:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;dogs&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>.2</span><span class=p>,</span> <span class=mf>.0</span><span class=p>,</span> <span class=mf>.5</span><span class=p>,</span> <span class=mf>.4</span><span class=p>],</span> <span class=s1>&#39;cats&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>.3</span><span class=p>,</span> <span class=mf>.2</span><span class=p>,</span> <span class=mf>.0</span><span class=p>,</span> <span class=mf>.1</span><span class=p>]})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span><span class=o>.</span><span class=n>l_corr</span><span class=p>()</span>
<span class=go>      dogs      cats</span>
<span class=go>dogs   1.0 -0.764706</span>
<span class=go>cats  -0.8  1.000000</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span><span class=o>.</span><span class=n>corr</span><span class=p>()</span>
<span class=go>          dogs      cats</span>
<span class=go>dogs  1.000000 -0.756889</span>
<span class=go>cats -0.756889  1.000000</span>
</code></pre></div> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=lmo.contrib.pandas.Series class="doc doc-heading"> <code>lmo.contrib.pandas.Series</code> <a href=#lmo.contrib.pandas.Series class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Extension methods for <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>pandas.Series</code></a>.</p> <p>This class is not meant to be used directly. These methods are curried and registered as <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.api.extensions.register_series_accessor.html#pandas.api.extensions.register_series_accessor>series accessors</a>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moment</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_moment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar, or a <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>pd.Series[float]</code></a>, indexed by <code>r</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=lmo.contrib.pandas._FloatOrSeries>_FloatOrSeries</span></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_ratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_ratio</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_ratio class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar, or <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>pd.Series[float]</code></a>, with a <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.MultiIndex.html#pandas.MultiIndex><code>MultiIndex</code></a> of <code>r</code> and <code>k</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=lmo.contrib.pandas._FloatOrSeries>_FloatOrSeries</span></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_stats</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>pd.Series[float]</code></a> with index <code>r = 1, ..., num</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=pandas href=https://pandas.pydata.org/docs/index.html#module-pandas>pd</a>.<a class="autorefs autorefs-external" title=pandas.Series href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series>Series</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_loc class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_loc</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_loc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_loc><code>lmo.l_loc</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_scale</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_scale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_scale><code>lmo.l_scale</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_variation class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_variation</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_variation class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_variation><code>lmo.l_variation</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_skew class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_skew</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_skew class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_skew><code>lmo.l_skew</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.Series.l_kurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.Series.l_kurtosis class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_kurtosis><code>lmo.l_kurtosis</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A scalar.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=lmo.contrib.pandas.DataFrame class="doc doc-heading"> <code>lmo.contrib.pandas.DataFrame</code> <a href=#lmo.contrib.pandas.DataFrame class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Extension methods for <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>pandas.DataFrame</code></a>.</p> <p>This class is not meant to be used directly. These methods are curried and registered as <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.api.extensions.register_dataframe_accessor.html#pandas.api.extensions.register_dataframe_accessor>dataframe accessors</a>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_moment class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_moment</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_moment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>Series[float]</code></a>, or a <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>DataFrame</code></a> with <code>r</code> as index along the specified axis.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=lmo.contrib.pandas._SeriesOrFrame>_SeriesOrFrame</span></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_ratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_ratio</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_ratio class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series><code>Series[float]</code></a>, or a <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>DataFrame</code></a>, with a <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.MultiIndex.html#pandas.MultiIndex><code>MultiIndex</code></a> of <code>r</code> and <code>k</code> along the specified axis.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=lmo.contrib.pandas._SeriesOrFrame>_SeriesOrFrame</span></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_stats</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>DataFrame</code></a> with <code>r = 1, ..., num</code> as index along the specified axis.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=pandas href=https://pandas.pydata.org/docs/index.html#module-pandas>pd</a>.<a class="autorefs autorefs-external" title=pandas.DataFrame href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame>DataFrame</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_loc class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_loc</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_loc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_moment><code>l_moment(1, ...)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_loc><code>lmo.l_loc</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_scale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_scale</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_scale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_moment><code>l_moment(2, ...)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_scale><code>lmo.l_scale</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_variation class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_variation</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_variation class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_ratio><code>l_ratio(2, 1, ...)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_variation><code>lmo.l_variation</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_skew class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_skew</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_skew class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_ratio><code>l_ratio(3, 2, ...)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_skew><code>lmo.l_skew</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_kurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_kurtosis</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_kurtosis class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_ratio><code>l_ratio(4, 2, ...)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_kurtosis><code>lmo.l_kurtosis</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_kurt class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_kurt</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_kurt class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_kurtosis><code>l_kurtosis</code></a>.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_comoment class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_comoment</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_comoment class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order, as a non-negative scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional options to pass to <a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Unpack href=https://docs.python.org/3/library/typing.html#typing.Unpack>Unpack</a>[<span title=lmo.typing.LComomentOptions>LComomentOptions</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>DataFrame</code></a> of the column-to-column L-comoment matrix.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=pandas href=https://pandas.pydata.org/docs/index.html#module-pandas>pd</a>.<a class="autorefs autorefs-external" title=pandas.DataFrame href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame>DataFrame</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If <code>rowvar=True</code>, use <code>df.T.l_comoment</code> instead.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_coratio class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_coratio</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_coratio class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>See <a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order of the numerator, a non-negative scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order of the denominator, a non-negative scalar. Defaults to 2. If set to 0, this is equivalent to <code>l_comoment</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>2</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional options to pass to <a class="autorefs autorefs-internal" href=#lmo.l_comoment><code>lmo.l_comoment</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Unpack href=https://docs.python.org/3/library/typing.html#typing.Unpack>Unpack</a>[<span title=lmo.typing.LComomentOptions>LComomentOptions</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A <a class="autorefs autorefs-external" href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame><code>DataFrame</code></a> of the column-to-column matrix of L-comoment ratio&rsquo;s.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=pandas href=https://pandas.pydata.org/docs/index.html#module-pandas>pd</a>.<a class="autorefs autorefs-external" title=pandas.DataFrame href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame>DataFrame</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If <code>rowvar=True</code>, use <code>df.T.l_comoment</code> instead.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_coloc class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_coloc</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_coloc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_comoment><code>l_comoment(1, trim, **kwargs)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_coloc><code>lmo.l_coloc</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_coscale class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_coscale</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_coscale class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_comoment><code>l_comoment(2, trim, **kwargs)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_coscale><code>lmo.l_coscale</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_corr class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_corr</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_corr class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_coratio><code>l_coratio(2, 2, trim, **kwargs)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_corr><code>lmo.l_corr</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_coskew class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_coskew</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_coskew class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_coratio><code>l_coratio(3, 2, trim, **kwargs)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_coskew><code>lmo.l_coskew</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_cokurtosis class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_cokurtosis</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_cokurtosis class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_coratio><code>l_coratio(4, 2, trim, **kwargs)</code></a>. See <a class="autorefs autorefs-internal" href=#lmo.l_cokurtosis><code>lmo.l_cokurtosis</code></a> for details.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=lmo.contrib.pandas.DataFrame.l_cokurt class="doc doc-heading"> <code class="highlight language-python"><span class=n>l_cokurt</span><span class=p>(</span><span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.contrib.pandas.DataFrame.l_cokurt class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Alias for <a class="autorefs autorefs-internal" href=#lmo.contrib.pandas.DataFrame.l_cokurtosis><code>l_cokurtosis</code></a>.</p> </div> </div> </div> </div> </div> </div> </div> </div><h2 id=low-level-api>Low-level API<a class=headerlink href=#low-level-api title="Permanent link">&para;</a></h2> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Lmo: Robust statistics with trimmed L-moments and L-comoments.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=lmo.l_weights class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>l_weights</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>cache</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.l_weights class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Projection matrix of the first <span class=arithmatex>\(r\)</span> (T)L-moments for <span class=arithmatex>\(n\)</span> samples.</p> <p>For integer trim is the matrix is a linear combination of the Power Weighted Moment (PWM) weights (the sample estimator of <span class=arithmatex>\(\beta_{r_1}\)</span>), and the shifted Legendre polynomials.</p> <p>If the trimmings are nonzero and integers, a linearized (and corrected) adaptation of the recurrence relations from <em>Hosking (2007)</em> are applied, as well.</p> <div class=arithmatex>\[ (2k + s + t - 1) \lambda^{(s, t)}_k = (k + s + t) \lambda^{(s - 1, t)}_k + \frac{1}{k} (k + 1) (k + t) \lambda^{(s - 1, t)}_{k+1} \]</div> <p>for <span class=arithmatex>\(s &gt; 0\)</span>, and</p> <div class=arithmatex>\[ (2k + s + t - 1) \lambda^{(s, t)}_k = (k + s + t) \lambda^{(s, t - 1)}_k - \frac{1}{k} (k + 1) (k + s) \lambda^{(s, t - 1)}_{k+1} \]</div> <p>for <span class=arithmatex>\(t &gt; 0\)</span>.</p> <p>If the trim values are floats instead, the weights are calculated directly from the (generalized) order statistics. At the time of writing (07-2023), these &ldquo;generalized trimmed L-moments&rdquo; have not been discussed in the literature or the R-packages. It&rsquo;s probably a good idea to publish this&hellip;</p> <details class=tldr open> <summary>TLDR</summary> <p>This matrix (linearly) transforms <span class=arithmatex>\(x_{i:n}\)</span> (i.e. the sorted observation vector(s) of size <span class=arithmatex>\(n\)</span>), into (an unbiased estimate of) the <em>generalized trimmed L-moments</em>, with orders <span class=arithmatex>\(\le r\)</span>.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>P_r</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>2-D array of shape <code>(r, n)</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo._lm.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>lmo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lmo</span><span class=o>.</span><span class=n>l_weights</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
<span class=go>array([[ 0.25      ,  0.25      ,  0.25      ,  0.25      ],</span>
<span class=go>       [-0.25      , -0.08333333,  0.08333333,  0.25      ],</span>
<span class=go>       [ 0.25      , -0.25      , -0.25      ,  0.25      ]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>_</span> <span class=o>@</span> <span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span>
<span class=go>array([0.25      , 0.66666667, 0.        ])</span>
</code></pre></div> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=constants><code>constants</code><a class=headerlink href=#constants title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Mathematical constants.</p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h4 id=lmo.constants.theta_m class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>constants</span><span class=o>.</span><span class=n>theta_m</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.9553166181245093</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.constants.theta_m class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Magic angle <span class=arithmatex>\( \theta_m = \arctan \sqrt 2 \)</span>.</p> <details class=see-also open> <summary>See also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Magic_angle>Magic angle - Wikipedia</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.constants.theta_m_bar class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>constants</span><span class=o>.</span><span class=n>theta_m_bar</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.1520433619923482</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.constants.theta_m_bar class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Magic number of turns <span class=arithmatex>\( \bar{\theta}_m = \theta_m / (2 \pi) \)</span>.</p> <details class=see-also open> <summary>See also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.constants.theta_m><code>lmo.constants.theta_m</code></a></li> <li><a href=https://wikipedia.org/wiki/Magic_angle>Magic angle - Wikipedia</a></li> <li><a href=https://wikipedia.org/wiki/Turn_(angle)>Turn (angle) - Wikipedia</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=inference><code>inference</code><a class=headerlink href=#inference title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Parametric inference.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=lmo.inference.GMMResult class="doc doc-heading"> <code>lmo.inference.GMMResult</code> <a href=#lmo.inference.GMMResult class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" title=typing.NamedTuple href=https://docs.python.org/3/library/typing.html#typing.NamedTuple>NamedTuple</a></code></p> <p>Represents the Generalized Method of L-Moments (L-GMM) results. See <a class="autorefs autorefs-internal" href=#lmo.inference.fit><code>lmo.inference.fit</code></a> for details.</p> <table> <thead> <tr> <th><span class=doc-section-title>ATTRIBUTE</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.args>args</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>The estimated distribution arguments, as <code>(*shapes, loc, scale)</code>.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, ...]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.success>success</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Whether or not the optimizer exited successfully.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.eps>eps</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Final relative difference in the (natural) L-moment conditions.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.statistic>statistic</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>The minimized objective value, corresponding to the <code>weights</code>.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.n_samp>n_samp</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Amount of samples used to calculate the sample L-moment (after trimming).</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.n_step>n_step</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Number of GMM steps (the amount of times the weight matrix has been estimated).</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.n_iter>n_iter</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>Number of evaluations of the objective function (the theoretical L-moments).</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code><span title=lmo.inference.GMMResult.weights>weights</span></code></td> <td class=doc-attribute-details> <div class=doc-md-description> <p>The final weight (precision, inverse covariance) matrix.</p> </div> <p> <span class=doc-attribute-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.n_arg class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_arg</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_arg class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The number of model parameters.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.n_con class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_con</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_con class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The amount of L-moment conditions of the model.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.n_extra class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_extra</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_extra class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>The number of over-identifying L-moment conditions. For L-MM this is zero, otherwise, for L-GMM, it is strictly positive.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.j_test class="doc doc-heading"> <code class="highlight language-python"><span class=n>j_test</span><span class=p>:</span> <span class=n>HypothesisTestResult</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.j_test class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Sargan-Hansen J-test for over-identifying restrictions; a hypothesis test for the invalidity of the model.</p> <p>The test is defined through two hypotheses:</p> <ul> <li><span class=arithmatex>\(H_0\)</span>: The data satisfies the L-moment conditions, i.e. the model is &ldquo;valid&rdquo;.</li> <li><span class=arithmatex>\(H_1\)</span>: The data does not satisfy the L-moment conditions, i.e. the model is &ldquo;invalid&rdquo;.</li> </ul> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.2307%2F1907619>J. D. Sargan (1958) - The Estimation of Economic Relationships Using Instrumental Variables</a></li> <li><a href=https://doi.org/10.2307%2F1912775>J. P. Hansen (1982) - Large Sample Properties of Generalized Method of Moments Estimators</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.AIC class="doc doc-heading"> <code class="highlight language-python"><span class=n>AIC</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.AIC class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Akaike Information Criterion, based on the p-value of the J-test. Requires over-identified L-moment conditions, i.e. <code>n_extra &gt; 0</code>.</p> <p>The AIC is useful for model selection, e.g. for finding the most appropriate probability distribution from the data (smaller is better).</p> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1109%2FTAC.1974.1100705>H. Akaike (1974) - A new look at the statistical model identification</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=lmo.inference.GMMResult.AICc class="doc doc-heading"> <code class="highlight language-python"><span class=n>AICc</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.AICc class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>A modification of the AIC that includes a bias-correction small sample sizes.</p> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1080%2F03610927808827599>N. Sugiura (1978) - Further analysis of the data by Akaike&rsquo;s information criterion and the finite corrections</a></li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.inference.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>inference</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>args0</span><span class=p>,</span> <span class=n>n_obs</span><span class=p>,</span> <span class=n>l_moments</span><span class=p>,</span> <span class=n>r</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>k_max</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>l_tol</span><span class=o>=</span><span class=mf>0.0001</span><span class=p>,</span> <span class=n>l_moment_fn</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_mc_samples</span><span class=o>=</span><span class=mi>9999</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.inference.fit class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Fit the distribution parameters using the (Generalized) Method of L-Moments (L-(G)MM).</p> <p>The goal is to find the &ldquo;true&rdquo; parameters <span class=arithmatex>\(\theta_0\)</span> of the distribution. In practise, this is done using a reasonably close estimate, <span class=arithmatex>\(\theta\)</span>.</p> <p>In the (non-Generalized) Method of L-moments (L-MM), this is done by solving the system of equations <span class=arithmatex>\(l^{(s, t)}_r = \lambda^{(s, t)}_r\)</span>, for <span class=arithmatex>\(r = 1, \dots, k\)</span>, with <span class=arithmatex>\(n = |\theta|\)</span> the number of parameters. Because the amount of parameters matches the amount of <em>L-moment conditions</em>, the solution is <em>point-defined</em>, and can be found using simple least squares.</p> <p>L-GMM extends L-MM by allowing more L-moment conditions than there are free parameters, <span class=arithmatex>\(m &gt; n\)</span>. This requires solving an <em>over-identified</em> system of <span class=arithmatex>\(m\)</span> equations:</p> <div class=arithmatex>\[ \hat{\theta} = \mathop{\arg \min} \limits_{\theta \in \Theta} (\vec{\lambda}^{(s, t)}_r - \vec{l}^{(s, t)})^T W_m (\vec{\lambda}^{(s, t)}_r - \vec{l}^{(s, t)}) \, , \]</div> <p>where <span class=arithmatex>\(W_m\)</span> is a <span class=arithmatex>\(m \times m\)</span> weight matrix.</p> <p>The weight matrix is initially chosen as the matrix inverse of the non-parametric L-moment covariance matrix, see <a class="autorefs autorefs-internal" href=#lmo.l_moment_cov><code>lmo.l_moment_cov</code></a>. These weights are then plugged into the the equation above, and fed into <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize><code>scipy.optimize.minimize</code></a>, to obtain the initial parameter estimates.</p> <p>In the next step(s), Monte-Carlo sampling is used to draw samples from the distribution (using the current parameter estimates), with sample sizes matching that of the data. The L-moments of these samples are consequently used to to calculate the new weight matrix.</p> <details class=todo open> <summary>Todo</summary> <ul> <li>Raise on minimization error, warn on failed k-step convergence</li> <li>Optional <code>integrality</code> kwarg with boolean mask for integral params.</li> <li>Implement CUE: Continuously Updating GMM (i.e. implement and use <code>_loss_cue()</code>, then run with <code>k=1</code>).</li> </ul> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ppf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The (vectorized) quantile function of the probability distribution, with signature <code>(*args: float, q: T) -&gt; T</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.DistributionFunction>DistributionFunction</span>[...]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>args0</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Initial estimate of the distribution&rsquo;s parameter values.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n_obs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Amount of observations.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>l_moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Estimated sample L-moments. Must be a 1-d array-like s.t. <code>len(l_moments) &gt;= len(args0)</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The orders of <code>l_moments</code>. Defaults to <code>[1, ..., len(l_moments)]</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.IntVector>IntVector</span> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment trim-length(s) to use. Currently, only integral trimming is supported.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If set to a positive integer, exactly <span class=arithmatex>\(k\)</span> steps will be run. Will be ignored if <code>n_extra=0</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k_max</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Maximum amount of steps to run while not reaching convergence. Will be ignored if <span class=arithmatex>\(k\)</span> is specified or if <code>n_extra=0</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>l_tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Error tolerance in the parametric L-moments (unit-standardized). Will be ignored if <span class=arithmatex>\(k\)</span> is specified or if <code>n_extra=0</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>l_moment_fn</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Function for parametric L-moment calculation, with signature: <code>(r: int64[], *args, trim: float[2] | int[2]) -&gt; float64[]</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[..., <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n_mc_samples</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The number of Monte-Carlo (MC) samples drawn from the distribution to to form the weight matrix in step <span class=arithmatex>\(k &gt; 1\)</span>. Will be ignored if <code>n_extra=0</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>random_state</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>A seed value or <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator><code>numpy.random.Generator</code></a> instance, used for weight matrix estimation in step <span class=arithmatex>\(k &gt; 1\)</span>. Will be ignored if <code>n_extra=0</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.random href=https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random>random</a>.<a class="autorefs autorefs-external" title=numpy.random.Generator href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator>Generator</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.random href=https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random>random</a>.<a class="autorefs autorefs-external" title=numpy.random.RandomState href=https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState>RandomState</a> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keyword arguments to be passed to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize><code>scipy.optimize.minimize</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>Invalid arguments.</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>result</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>An instance of [<code>GMMResult</code>][<code>lmo.inference.GMMResult</code>].</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" title=lmo.inference.GMMResult href=#lmo.inference.GMMResult>GMMResult</a></code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.48550/arXiv.2210.04146>Alvarez et al. (2023) - Inference in parametric models with many L-moments</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=linalg><code>linalg</code><a class=headerlink href=#linalg title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Linear algebra and linearized orthogonal polynomials.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.sandwich class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sandwich</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.sandwich class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the &ldquo;sandwich&rdquo; matrix product (<code>A @ X @ A.T</code>) along the specified <code>X</code> axis.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>A</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>2-D array of shape <code>(s, r)</code>, the &ldquo;bread&rdquo;.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.number href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number>number</a>[<a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a>]]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The data type of the result.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.linalg.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.linalg.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>X</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Array of shape <code>(r, r, ...)</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.number href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number>number</a>[<a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a>]]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>C</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Array of shape <code>(s, s, ...)</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li>https://wikipedia.org/wiki/Covariance_matrix</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.pascal class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>pascal</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inv</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.linalg.pascal class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Construct the lower-diagonal Pascal matrix <span class=arithmatex>\(L_{k \times k\)</span>}$, or its matrix inverse <span class=arithmatex>\(L^{-1}\)</span>.</p> <div class=arithmatex>\[ \begin{align} L_{ij} &amp;= \binom{i}{j} \\ L^{-1}_{ij} &amp;= (-1)^{i - j} L_{ij} \end{align} \]</div> <p>Implemented using recursion, unlike the slow naive implementation from the equivalent <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pascal.html#scipy.linalg.pascal><code>scipy.linalg.pascal</code></a> and <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.invpascal.html#scipy.linalg.invpascal><code>scipy.linalg.invpascal</code></a> functions using <code>kind='lower'</code>. By using the binomial recurrence relation, assuming <span class=arithmatex>\(0 &lt; j &lt; i\)</span>, <span class=arithmatex>\(\binom{i}{j} = \frac{i}{j} \binom{i-1}{j-1}\)</span>, the following recursive definition is obtained:</p> <div class=arithmatex>\[ L_{ij} = \begin{cases} 0 &amp; \text{if } i &lt; j \text{,} \\ 1 &amp; \text{if } i = j \vee j = 0 \text{, and} \\ (i \, L_{i-1,\, j-1}) / j &amp; \text{otherwise.} \end{cases} \]</div> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>pascal</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>)</span>
<span class=go>array([[1, 0, 0, 0],</span>
<span class=go>       [1, 1, 0, 0],</span>
<span class=go>       [1, 2, 1, 0],</span>
<span class=go>       [1, 3, 3, 1]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>,</span> <span class=n>inv</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>rint</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>)))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
</code></pre></div> <p>Now, let&rsquo;s compare with scipy:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.linalg</span> <span class=kn>import</span> <span class=n>invpascal</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>invpascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
</code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.ir_pascal class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>ir_pascal</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.ir_pascal class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Inverse regulatized lower-diagonal Pascal matrix, <span class=arithmatex>\(\bar{L}_{ij} = L^{-1}_ij / i\)</span>.</p> <p>Used to linearly combine order statistics order statistics into L-moments.</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.sh_legendre class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sh_legendre</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span></code> <a href=#lmo.linalg.sh_legendre class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Shifted Legendre polynomial coefficient matrix <span class=arithmatex>\(\widetilde{P}\)</span> of shape <code>(k, k)</code>.</p> <p>The <span class=arithmatex>\(j\)</span>-th coefficient of the shifted Legendre polynomial of degree <span class=arithmatex>\(k\)</span> is at <span class=arithmatex>\((k, j)\)</span>:</p> <div class=arithmatex>\[ \widetilde{p}_{k, j} = (-1)^{k - j} \binom{k}{j} \binom{k + j}{j} \]</div> <p>Useful for transforming probability-weighted moments into L-moments.</p> <details class=danger open> <summary>Danger</summary> <p>For <span class=arithmatex>\(k \ge 29\)</span>, <strong>all</strong> 64-bits dtypes (default is int64) will overflow, which results in either an <code>OverflowError</code> (if you&rsquo;re lucky), or will give incorrect results. Similarly, all 32-bits dtypes (e.g. <code>np.int_</code> on Windows) already overflow when <span class=arithmatex>\(k \ge 16\)</span>.</p> <p><strong>This is not explicitly checked</strong> &ndash; so be sure to select the right <code>dtype</code> depending on <code>k</code>.</p> <p>One option is to use <code>dtype=np.object_</code>, which will use Python-native <code>int</code>. However, this is a lot slower, and is likely to fail. For instance, when multiplied together with some <code>float64</code> array, a <code>TypeError</code> is raised.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The size of the matrix, and the max degree of the shifted Legendre polynomial.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code>. Must be signed. The default is <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64><code>numpy.int64</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.linalg.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.linalg.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.int64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64>int64</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>P</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>2-D array of the lower-triangular square matrix of size <span class=arithmatex>\(k^2\)</span>`.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate <span class=arithmatex>\(\widetilde{P}_{4 \times 4}\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>sh_legendre</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_legendre</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[  1,   0,   0,   0],</span>
<span class=go>       [ -1,   2,   0,   0],</span>
<span class=go>       [  1,  -6,   6,   0],</span>
<span class=go>       [ -1,  12, -30,  20]])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li>https://wikipedia.org/wiki/Legendre_polynomials</li> <li>https://wikipedia.org/wiki/Pascal_matrix</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.sh_jacobi class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sh_jacobi</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.linalg.sh_jacobi class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Shifted Jacobi polynomial coefficient matrix <span class=arithmatex>\(\widetilde{P}^{(a,b)}\)</span> of shape <code>(k, k)</code>.</p> <p>The <span class=arithmatex>\(j\)</span>-th coefficient of the shifted Jacobi polynomial of degree <span class=arithmatex>\(k\)</span> is at <span class=arithmatex>\((k, j)\)</span>:</p> <p>The &ldquo;shift&rdquo; refers to the change of variables <span class=arithmatex>\(x \mapsto 2x - 1\)</span> in the (unshifted) Jacobi (or hypergeometric) polynomials.</p> <p>The (shifted) Jacobi polynomials <span class=arithmatex>\(\widetilde{P}^{(a,b)}\)</span> generalize the (shifted) Legendre polynomials <span class=arithmatex>\(\widetilde{P}\)</span>: <span class=arithmatex>\(\widetilde{P}^{(0, 0)} = \widetilde{P}\)</span></p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The size of the matrix, and the max degree of the polynomial.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The <span class=arithmatex>\(\alpha\)</span> parameter, must be <span class=arithmatex>\(\ge 0\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyFloat>AnyFloat</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>b</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The <span class=arithmatex>\(\beta\)</span> parameter, must be <span class=arithmatex>\(\ge 0\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyFloat>AnyFloat</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code>. Default is <code>numpy.int64</code> if <code>a</code> and <code>b</code> are integers, otherwise <code>np.float64</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.linalg.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.linalg.T>T</span>] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>P</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>2-D array of the lower-triangular square matrix of size <span class=arithmatex>\(k^2\)</span>`.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.int64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64>int64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate <span class=arithmatex>\(\widetilde{P}^{(1, 1)}_{4 \times 4}\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>sh_jacobi</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_jacobi</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[  1,   0,   0,   0],</span>
<span class=go>       [ -2,   4,   0,   0],</span>
<span class=go>       [  3, -15,  15,   0],</span>
<span class=go>       [ -4,  36, -84,  56]])</span>
</code></pre></div> <p>Let&rsquo;s compare <span class=arithmatex>\(\widetilde{P}^(1, \pi)_3\)</span> with the scipy Jacobi poly1d. This requires manual shifting <span class=arithmatex>\(x \mapsto f(x)\)</span>, with <span class=arithmatex>\(f(x) = 2x - 1\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>scipy.special</span> <span class=k>as</span> <span class=nn>sc</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>f_x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>poly1d</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># f(x) = 2*x + 1</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sc</span><span class=o>.</span><span class=n>jacobi</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)(</span><span class=n>f_x</span><span class=p>)</span>
<span class=go>poly1d([ 125.80159497, -228.55053774,  128.54584648,  -21.79690371])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_jacobi</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)[</span><span class=mi>3</span><span class=p>]</span>
<span class=go>array([ -21.79690371,  128.54584648, -228.55053774,  125.80159497])</span>
</code></pre></div> <p>Apart from the reversed coefficients of <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.poly1d.html#numpy.poly1d><code>numpy.poly1d</code></a> (an awkward design choice, but it&rsquo;s fixed in the new <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/routines.polynomials.package.html#module-numpy.polynomial><code>numpy.polynomial</code></a> module.)</p> <details class=see-also open> <summary>See Also</summary> <ul> <li>https://mathworld.wolfram.com/JacobiPolynomial.html</li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.jacobi.html#scipy.special.jacobi><code>scipy.special.jacobi</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.succession_matrix class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>succession_matrix</span><span class=p>(</span><span class=n>c</span><span class=p>)</span></code> <a href=#lmo.linalg.succession_matrix class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A toeplitz-like transformation matrix construction, that prepends <span class=arithmatex>\(i\)</span> zeroes to <span class=arithmatex>\(i\)</span>-th row, so that the input shape is mapped from <code>(n, k)</code> to <code>(n, k + n)</code>.</p> <p>So all values <span class=arithmatex>\(i &gt; j \vee i + j \ge k\)</span> are zero in the succession matrix.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>c</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Dense matrix of shape <code>(n, k)</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>S</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Matrix of shape <code>(n, k + n)</code></p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>succession_matrix</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c</span>
<span class=go>array([[1, 2],</span>
<span class=go>       [3, 4],</span>
<span class=go>       [5, 6],</span>
<span class=go>       [7, 8]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>succession_matrix</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
<span class=go>array([[1, 2, 0, 0, 0],</span>
<span class=go>       [0, 3, 4, 0, 0],</span>
<span class=go>       [0, 0, 5, 6, 0],</span>
<span class=go>       [0, 0, 0, 7, 8]])</span>
</code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.linalg.trim_matrix class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>trim_matrix</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.trim_matrix class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Linearization of the trimmed L-moment recurrence relations, following the (corrected) derivation by Hosking (2007) from the (shifted) Jacobi Polynomials.</p> <p>This constructs a <span class=arithmatex>\(r \times r + t_1 + t_2\)</span> matrix <span class=arithmatex>\(T^{(t_1, t_2)}\)</span> that &ldquo;trims&rdquo; conventional L-moments. E.g. the first 3 <span class=arithmatex>\((1, 1)\)</span> trimmed L-moments can be obtained from the first <span class=arithmatex>\(3+1+1=5\)</span> (untrimmed) L-moments (assuming they exist) with <code>trim_matrix(3, (1, 1)) @ l_moment(x, np.ogrid[:5] + 1)</code>.</p> <p>The big &ldquo;L&rdquo; in &ldquo;L-moment&rdquo;, referring to it being a <em>Linear</em> combination of order statistics, has been prominently put in the name by Hosking (1990) for a good reason. It means that transforming order statistics to a bunch of L-moments, can be done using a single matrix multiplication (see <a class="autorefs autorefs-internal" href=#lmo.linalg.sh_legendre><code>lmo.linalg.sh_legendre</code></a>). By exploiting liniarity, it can easily be chained with this trim matrix, to obtain a reusable order-statistics -&gt; trimmed L-moments transformation (matrix).</p> <p>Note that these linear transformations can be used in exactly the same way to e.g. calculate several population TL-moments of some random varianble, using nothing but its theoretical probablity-weighted moments (PWMs).</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The max (trimmed) L-moment order.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right-trim orders <span class=arithmatex>\((t_1, t_2)\)</span>, integers <span class=arithmatex>\(\ge 0\)</span>. If set to (0, 0), the identity matrix is returned.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code> (default).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.linalg.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.linalg.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.linalg.T>T</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Toeplitz-like matrix of shape <span class=arithmatex>\((r, r + t_1 + t_2)\)</span>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>trim_matrix</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>trim_matrix</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([[ 1.        , -1.        ,  0.        ,  0.        ],</span>
<span class=go>       [ 0.        ,  0.75      , -0.75      ,  0.        ],</span>
<span class=go>       [ 0.        ,  0.        ,  0.66666667, -0.66666667]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>trim_matrix</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=go>array([[1.        , 1.        , 0.        , 0.        ],</span>
<span class=go>       [0.        , 0.75      , 0.75      , 0.        ],</span>
<span class=go>       [0.        , 0.        , 0.66666667, 0.66666667]])</span>
</code></pre></div> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=ostats><code>ostats</code><a class=headerlink href=#ostats title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Order statistics <span class=arithmatex>\(X_{i:n}\)</span>, with <span class=arithmatex>\(i \in [0, n)\)</span>.</p> <p>Primarily used as an intermediate step for L-moment estimation.</p> <details class=references open> <summary>References</summary> <p><a href="https://books.google.com/books?id=bdhzFXg6xFkC">H.A. David &amp; H.N. Nagaraja (2004) &ndash; Order statistics </a></p> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.ostats.weights class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>ostats</span><span class=o>.</span><span class=n>weights</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>cached</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.ostats.weights class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Compute the linear weights <span class=arithmatex>\(w_{i:n|j:N}\)</span> for <span class=arithmatex>\(j = 0, \dots, N-1\)</span>.</p> <p>The unbiased sample estimator <span class=arithmatex>\(\mu_{i:n}\)</span> is then derived from</p> <div class=arithmatex>\[ E[X_{i:n}] = \sum_{j=0}^{N-1} w_{i:n|j:N} X_{j:N} \, , \]</div> <p>where</p> <div class=arithmatex>\[ \begin{aligned} w_{i:n|j:N} &amp;= \binom{j}{i} \binom{N - j - 1}{n - i - 1} / \binom{N}{n} \\ &amp;= \frac{1}{N - n + 1} \frac{ B(j + 1, N - j) }{ B(i + 1, n - i) B(j - i + 1, N - j - n + i + 1) } \end{aligned} \]</div> <p>Here, <span class=arithmatex>\(B\)</span> denotes the Beta function, <span class=arithmatex>\(B(a,b) = \Gamma(a) \Gamma(b) / \Gamma(a + b)\)</span>.</p> <details class=notes open> <summary>Notes</summary> <p>This function uses &ldquo;Python-style&rdquo; 0-based indexing for <span class=arithmatex>\(i\)</span>, instead of the conventional 1-based indexing that is generally used in the literature.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>i</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>0-indexed sample (fractional) index, <span class=arithmatex>\(0 \le i \lt n\)</span>. Negative indexing is allowed.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Subsample size, optionally fractional, <span class=arithmatex>\(0 \le n0\)</span></p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>N</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sample size, i.e. the observation count.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>cached</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Cache the result for <code>(i, n, n0)</code>. Defaults to False.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>1d array of size <span class=arithmatex>\(N\)</span> with (ordered) sample weights.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.ostats.from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>ostats</span><span class=o>.</span><span class=n>from_cdf</span><span class=p>(</span><span class=n>F</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span></code> <a href=#lmo.ostats.from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Transform <span class=arithmatex>\(F(X)\)</span> to <span class=arithmatex>\(F_{i:n}(X)\)</span>, of the <span class=arithmatex>\(i\)</span>th variate within subsamples of size, i.e. <span class=arithmatex>\(0 \le i \le n - 1\)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>F</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like with the returned value of some cdf, i.e. <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be between 0 and 1.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>i</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>0-indexed sample (fractional) index, <span class=arithmatex>\(0 \le i &lt; n\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Subsample size, optionally fractional, <span class=arithmatex>\(0 \le n0\)</span></p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div><h3 id=pwm_beta><code>pwm_beta</code><a class=headerlink href=#pwm_beta title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Low-level utility functions for calculating a special case of the probability-weighted moments (PWM&rsquo;s), <span class=arithmatex>\(\beta_k = M_{1,k,0}\)</span>.</p> <p>Primarily used as an intermediate step for L-moment estimation.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.pwm_beta.weights class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>pwm_beta</span><span class=o>.</span><span class=n>weights</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.pwm_beta.weights class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Probability Weighted moment (PWM) projection matrix <span class=arithmatex>\(B\)</span> of the unbiased estimator for <span class=arithmatex>\(\beta_k = M_{1,k,0}\)</span> for <span class=arithmatex>\(k = 0, \dots, r - 1\)</span>.</p> <p>The PWM&rsquo;s are estimated by linear projection of the sample of order statistics, i.e. <span class=arithmatex>\(b = B x_{i:n}\)</span></p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of orders to evaluate, i.e. <span class=arithmatex>\(k = 0, \dots, r - 1\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sample count.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Desired output floating data type.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.pwm_beta.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.pwm_beta.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>P_b</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Upper-triangular projection matrix of shape <code>(r, n)</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.pwm_beta.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo</span> <span class=kn>import</span> <span class=n>pwm_beta</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>pwm_beta</span><span class=o>.</span><span class=n>weights</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
<span class=go>array([[0.2       , 0.2       , 0.2       , 0.2       , 0.2       ],</span>
<span class=go>       [0.        , 0.05      , 0.1       , 0.15      , 0.2       ],</span>
<span class=go>       [0.        , 0.        , 0.03333333, 0.1       , 0.2       ],</span>
<span class=go>       [0.        , 0.        , 0.        , 0.05      , 0.2       ]])</span>
</code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.pwm_beta.cov class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>pwm_beta</span><span class=o>.</span><span class=n>cov</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#lmo.pwm_beta.cov class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Distribution-free variance-covariance matrix of the probability weighted moment (PWM) point estimates <span class=arithmatex>\(\beta_k = M_{1,k,0}\)</span>, with orders <span class=arithmatex>\(k = 0, \dots, r - 1\)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Array-like with observations.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of orders to evaluate, i.e. <span class=arithmatex>\(k = 0, \dots, r - 1\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>axis</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The axis along which to calculate the covariance matrices.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>dtype</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Desired output floating data type.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.dtype href=https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype>dtype</a>[<span title=lmo.pwm_beta.T>T</span>] | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#type>type</a>[<span title=lmo.pwm_beta.T>T</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Additional keywords to pass to <code>lmo.stats.ordered</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>S_b</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Variance-covariance matrix/tensor of shape <code>(r, ...)</code></p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<span title=lmo.pwm_beta.T>T</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li>https://wikipedia.org/wiki/Covariance_matrix</li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0378-3758(03)00213-1>E. Elmamir &amp; A. Seheult (2004) - Exact variance structure of sample L-moments</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=special><code>special</code><a class=headerlink href=#special title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Mathematical &ldquo;special&rdquo; functions, extending <code>scipy.special</code>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.special.fpow class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.fpow class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Factorial power, or falling factorial.</p> <p>It is defined as</p> <div class=arithmatex>\[ \ffact{x}{n} = \frac{\Gamma(x + 1)}{\Gamma(x - n + 1)} \]</div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Real-valued array-like or scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Real valued array-like or scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>out</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional output array for the function results</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Array or scalar with the value(s) of the function.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.poch.html#scipy.special.poch><code>scipy.special.poch</code></a> &ndash; the rising factorial</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.special.gamma2 class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>gamma2</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.gamma2 class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Incomplete (upper) gamma function.</p> <p>It is defined as</p> <div class=arithmatex>\[ \Gamma(a,\ x) = \int_x^\infty t^{a-1} e^{-t} \mathrm{d}t \]</div> <p>for <span class=arithmatex>\( a \ge 0 \)</span> and <span class=arithmatex>\( x \ge 0 \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Non-negative scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Non-negative array-like.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>out</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional output array for the results.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Scalar of array with the values of the incomplete gamma function.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.gammaincc.html#scipy.special.gammaincc><code>scipy.special.gammaincc</code></a> for the regularized gamma function <span class=arithmatex>\( Q(a,\ x) \)</span>.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.special.harmonic class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>harmonic</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.harmonic class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Harmonic number <span class=arithmatex>\( H_n = \sum_{k=1}^{n} 1 / k \)</span>, extended for real and complex argument via analytic contunuation.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=go>0.0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=go>1.0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=go>1.5</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=go>4.32674</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
<span class=go>1.87274</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span> <span class=o>/</span> <span class=mi>12</span><span class=p>)</span>
<span class=go>-0.146106</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=mi>1</span><span class=n>j</span><span class=p>)</span>
<span class=go>(1.1718...-0.5766...j)</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>n</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Real- or complex- valued parameter, as array-like or scalar.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>out</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional real or complex output array for the results.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.complex128 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.complex128>complex128</a>] | None</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Array or scalar with the value(s) of the function.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#complex>complex</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.complex128 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.complex128>complex128</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://w.wiki/A63b>Harmonic number - Wikipedia</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.special.norm_sh_jacobi class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>norm_sh_jacobi</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span></code> <a href=#lmo.special.norm_sh_jacobi class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the (weighted) <span class=arithmatex>\( L^2 \)</span>-norm of a shifted Jacobi polynomial.</p> <p>Specifically,</p> <div class=arithmatex>\[ \| p_n \|^2 = \braket{p_n | p_n} = \int_0^1 |p_n|^2 \mathrm{d}x = \frac{1}{2 n + \alpha + \beta + 1} \frac {\Gamma(n + \alpha + 1) \Gamma(n + \beta + 1)} {n! \ \Gamma(n + \alpha + \beta + 1)} \]</div> <p>with</p> <div class=arithmatex>\[ p_n(x) \equiv x^{\beta / 2} \ (1 - x)^{\alpha / 2} \ \shjacobi{n}{\alpha}{\beta}{x} \]</div> <p>the normalized Jacobi polynomial on <span class=arithmatex>\( [0, 1] \)</span>.</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.special.fourier_jacobi class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>fourier_jacobi</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span></code> <a href=#lmo.special.fourier_jacobi class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the Fourier-Jacobi series, using the Clenshaw summation algorithm.</p> <p>If <span class=arithmatex>\( c \)</span> is of length <span class=arithmatex>\( n + 1 \)</span>, this function returns the value:</p> <div class=arithmatex>\[ c_0 \cdot \jacobi{0}{a}{b}{x} + c_1 \cdot \jacobi{1}{a}{b}{x} + \ldots + c_n \cdot \jacobi{n}{a}{b}{x} \]</div> <p>Here, <span class=arithmatex>\( \jacobi{n}{a}{b}{x} \)</span> is a Jacobi polynomial of degree <span class=arithmatex>\( n = |\vec{c}| \)</span>, which is orthogonal iff <span class=arithmatex>\( (a, b) \in (-1,\ \infty)^2 \)</span> and <span class=arithmatex>\( x \in [0,\ 1] \)</span>.</p> <details class=tip open> <summary>Tip</summary> <p>Trailing zeros in the coefficients will be used in the evaluation, so they should be avoided if efficiency is a concern.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Scalar or array-like with input data.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>c</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Array-like of coefficients, ordered from low to high. All coefficients to the right are considered zero.</p> <p>For instance, <code>[4, 3, 2]</code> gives <span class=arithmatex>\( 4 \jacobi{0}{a}{b}{x} + 3 \jacobi{1}{a}{b}{x} + 2 \jacobi{2}{a}{b}{x} \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>a</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Jacobi parameter <span class=arithmatex>\( a &gt; -1 \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>b</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Jacobi parameter <span class=arithmatex>\( a &gt; -1 \)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>out</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Scalar or array of same shape as <code>x</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Generalized_Fourier_series>Generalized Fourier series - Wikipedia</a></li> <li><a href=https://mathworld.wolfram.com/ClenshawRecurrenceFormula.html>Clenshaw Recurrence Formula - Wolfram MathWorld</a></li> <li><a href=https://mathworld.wolfram.com/JacobiPolynomial.html>Jacobi Polynomial - Worlfram Mathworld</a></li> </ul> </details> </div> </div> </div> </div> </div><h3 id=theoretical><code>theoretical</code><a class=headerlink href=#theoretical title="Permanent link">&para;</a></h3> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Theoretical (population) L-moments of known univariate probability distributions.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_moment_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the population L-moment of a continuous probability distribution, using its Cumulative Distribution Function (CDF) <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>.</p> <div class=arithmatex>\[ \lambda^{(s, t)}_r = \begin{cases} 1 &amp; r = 0 \\ \displaystyle \int_{\mathbb{R}} \left(H(x) - I_u(s + 1,\ t + 1)\right) \ \mathrm{d} x &amp; r = 1 \\ \displaystyle \frac{c^{(s,t)}_r}{r} \int_{\mathbb{R}} u^{s + 1} \left(1 - u\right)^{t + 1} \ \widetilde{P}^{(t + 1, s + 1)}_{r - 2}(u) \ \mathrm{d} x &amp; r &gt; 1 \; , \end{cases} \]</div> <p>where,</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r + s + t}{r} \frac{\B(r,\ r + s + t)}{\B(r + s,\ r + t)} \; , \]</div> <p><span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k(x)\)</span> the shifted (<span class=arithmatex>\(x \mapsto 2x-1\)</span>) Jacobi polynomial, <span class=arithmatex>\(H(x)\)</span> the Heaviside step function, and <span class=arithmatex>\(I_x(\alpha, \beta)\)</span> the regularized incomplete gamma function, and <span class=arithmatex>\(u = F_X(x)\)</span> the probability integral transform of <span class=arithmatex>\(x \sim X\)</span>.</p> <details class=notes open> <summary>Notes</summary> <p>Numerical integration is performed with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>, which cannot verify whether the integral exists and is finite. If it returns an error message, an <code>IntegrationWarning</code> is issues, and <code>nan</code> is returned (even if <code>quad</code> returned a finite result).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the first 4 L- and TL-moments of the standard normal distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>ndtr</span>  <span class=c1># standard normal CDF</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>ndtr</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
<span class=go>array([0.        , 0.56418958, 0.        , 0.06917061])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>ndtr</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.29701138, 0.        , 0.01855727])</span>
</code></pre></div> <p>Evaluate the first 4 TL-moments of the standard Cauchy distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>cdf_cauchy</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>/</span> <span class=mi>2</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>cdf_cauchy</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.69782723, 0.        , 0.23922105])</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariateCDF>UnivariateCDF</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Split the integral into integrals with limits <span class=arithmatex>\([a, F^{-1}(\alpha)]\)</span>, <span class=arithmatex>\([F(\alpha), F^{-1}(1 - \alpha)]\)</span> and <span class=arithmatex>\([F^{-1}(1 - \alpha), b]\)</span> to improve numerical stability. So <span class=arithmatex>\(\alpha\)</span> can be consideresd the size of the tail. Numerical experiments have found 0.05 to give good results for different distributions.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>ppf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The inverse of the cdf, used with <code>alpha</code> to calculate the integral split points (if provided).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariatePPF>UnivariatePPF</span> | None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p><code>r</code> is not integer-valued or negative</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p><code>r</code> is negative</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>lmbda</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The population L-moment(s), a scalar or float array like <code>r</code>. If <code>nan</code>, consult the related <code>IntegrationWarning</code> message.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_ppf><code>theoretical.l_moment_from_ppf</code></a>: population L-moment, using the inverse CDF</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>l_moment</code></a>: sample L-moment</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_moment_from_ppf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_ppf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the population L-moment of a univariate probability distribution, using its Percentile Function (PPF), <span class=arithmatex>\(x(F)\)</span>, also commonly known as the quantile function, which is the inverse of the Cumulative Distribution Function (CDF).</p> <div class=arithmatex>\[ \lambda^{(s, t)}_r = c^{(s, t)}_r \int_0^1 F^s (1 - F)^t \ \widetilde{P}^{(t, s)}_{r - 1}(F) \ x(F) \ \mathrm{d} F \; , \]</div> <p>where</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r+s+t}{r} \frac{B(r,\,r+s+t)}{B(r+s,\,r+t)} \;, \]</div> <p>and <span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k(x)\)</span> the shifted (<span class=arithmatex>\(x \mapsto 2x-1\)</span>) Jacobi polynomial.</p> <details class=notes open> <summary>Notes</summary> <p>Numerical integration is performed with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>, which cannot verify whether the integral exists and is finite. If it returns an error message, an <code>IntegrationWarning</code> is issues, and <code>nan</code> is returned (even if <code>quad</code> returned a finite result).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the L- and TL-location and -scale of the standard normal distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>ndtri</span>  <span class=c1># standard normal inverse CDF</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ndtri</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<span class=go>array([0.        , 0.56418958])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ndtri</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.29701138])</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ppf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The quantile function <span class=arithmatex>\(x(F)\)</span>, a monotonically continuous increasing function with signature <code>(float) -&gt; float</code>, that maps a probability in <span class=arithmatex>\([0, 1]\)</span>, to the domain of the distribution.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariatePPF>UnivariatePPF</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers. E.g. 0 gives 1, 1 the L-location, 2 the L-scale, etc.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span> | <span title=lmo.typing.IntVector>IntVector</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Integration limits. Defaults to (0, 1), as it should. There is no need to change this to anything else, and only exists to make the function signature consistent with the <code>*_from_cdf</code> analogue.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Split the integral into integrals with limits <span class=arithmatex>\([0, \alpha]\)</span>, <span class=arithmatex>\([\alpha, 1-\alpha]\)</span> and <span class=arithmatex>\([1-\alpha, 0]\)</span> to improve numerical stability. So <span class=arithmatex>\(\alpha\)</span> can be consideresd the size of the tail. Numerical experiments have found 0.1 to give good results for different distributions.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>Invalid <code>r</code> or <code>trim</code> types.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>Invalid <code>r</code> or <code>trim</code> values.</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>lmbda</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The population L-moment(s), a scalar or float array like <code>r</code>. If <code>nan</code>, consult the related <code>IntegrationWarning</code> message.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>theoretical.l_moment_from_cdf</code></a>: population L-moment, using the CDF (i.e. the inverse PPF)</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>l_moment</code></a>: sample L-moment</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_moment_from_qdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_qdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the population L-moments <span class=arithmatex>\( \tlmoment{s, t}{r} \)</span> for <span class=arithmatex>\( r &gt; 1 \)</span> from the quantile distribution function (QDF), which is the derivative of the PPF (quantile function).</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_ratio_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Population L-ratio&rsquo;s from a CDF.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_ppf><code>l_ratio_from_ppf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_ratio_from_ppf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_from_ppf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Population L-ratio&rsquo;s from a PPF.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_stats_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the theoretical- / population- L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>) of a distribution, from its CDF.</p> <p>By default, the first <code>num = 4</code> population L-stats are calculated:</p> <ul> <li><span class=arithmatex>\(\lambda^{(s,t)}_1\)</span> - <em>L-loc</em>ation</li> <li><span class=arithmatex>\(\lambda^{(s,t)}_2\)</span> - <em>L-scale</em></li> <li><span class=arithmatex>\(\tau^{(s,t)}_3\)</span> - <em>L-skew</em>ness coefficient</li> <li><span class=arithmatex>\(\tau^{(s,t)}_4\)</span> - <em>L-kurt</em>osis coefficient</li> </ul> <p>This function is equivalent to <code>l_ratio_from_cdf(cdf, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code>.</p> <details class=note open> <summary>Note</summary> <p>This should not be confused with the term <em>L-statistic</em>, which is sometimes used to describe any linear combination of order statistics.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_stats_from_ppf><code>l_stats_from_ppf</code></a> - Population L-stats from the quantile function.</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a> - Generalized population L-ratio&rsquo;s from the CDF.</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a> - Unbiased sample estimation of L-stats.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_stats_from_ppf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_from_ppf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Calculates the theoretical- / population- L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>) of a distribution, from its quantile function.</p> <p>By default, the first <code>num = 4</code> population L-stats are calculated:</p> <ul> <li><span class=arithmatex>\(\lambda^{(s,t)}_1\)</span> - <em>L-loc</em>ation</li> <li><span class=arithmatex>\(\lambda^{(s,t)}_2\)</span> - <em>L-scale</em></li> <li><span class=arithmatex>\(\tau^{(s,t)}_3\)</span> - <em>L-skew</em>ness coefficient</li> <li><span class=arithmatex>\(\tau^{(s,t)}_4\)</span> - <em>L-kurt</em>osis coefficient</li> </ul> <p>This function is equivalent to <code>l_ratio_from_cdf(cdf, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code>.</p> <details class=note open> <summary>Note</summary> <p>This should not be confused with the term <em>L-statistic</em>, which is sometimes used to describe any linear combination of order statistics.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_stats_from_cdf><code>l_stats_from_cdf</code></a> - Population L-stats from the CDF.</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_ppf><code>l_ratio_from_ppf</code></a> - Generalized population L-ratio&rsquo;s from the quantile function.</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a> - Unbiased sample estimation of L-stats.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_moment_cov_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_cov_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r_max</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_cov_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>L-moments that are estimated from <span class=arithmatex>\(n\)</span> samples of a distribution with CDF <span class=arithmatex>\(F\)</span>, converge to the multivariate normal distribution as the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>.</p> <div class=arithmatex>\[ \sqrt{n} \left( \vec{l}^{(s, t)} - \vec{\lambda}^{(s, t)} \right) \sim \mathcal{N}( \vec{0}, \mathbf{\Lambda}^{(s, t)} ) \]</div> <p>Here, <span class=arithmatex>\(\vec{l}^{(s, t)} = \left[l^{(s, t)}_r, \dots, l^{(s, t)}_{r_{max}} \right]^T\)</span> is a vector of estimated sample L-moments, and <span class=arithmatex>\(\vec{\lambda}^{(s, t)}\)</span> its theoretical (&ldquo;true&rdquo;) counterpart.</p> <p>This function calculates the covariance matrix</p> <div class=arithmatex>\[ \begin{align*} \bf{\Lambda}^{(s,t)}_{k, r} &amp;= \mathrm{Cov}[l^{(s, t)}_k, l^{(s, t)}_r] \\ &amp;= c_k c_r \iint\limits_{x &lt; y} \left( p^{(s, t)}_k(u) \ p^{(s, t)}_r(v) + p^{(s, t)}_r(u) \ p^{(s, t)}_k(v) \right) \ w^{(s + 1,\ t)}(u) \ w^{(s,\ t + 1)}(v) \ \mathrm{d} x \ \mathrm{d} y \; , \end{align*} \]</div> <p>where <span class=arithmatex>\(u = F_X(x)\)</span> and <span class=arithmatex>\(v = F_Y(y)\)</span> (marginal) probability integral transforms, and</p> <div class=arithmatex>\[ c_n = \frac{\Gamma(n) \Gamma(n+s+t+1)}{n \Gamma(n+s) \Gamma(n+t)}\;, \]</div> <p>the shifted Jacobi polynomial <span class=arithmatex>\(p^{(s, t)}_n(u) = P^{(t, s)}_{n-1}(2u - 1)\)</span>, <span class=arithmatex>\(P^{(t, s)}_m\)</span>, and <span class=arithmatex>\(w^{(s, t)}(u) = u^s (1 - u)^t\)</span> its weight function.</p> <details class=notes open> <summary>Notes</summary> <p>This function uses <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.nquad.html#scipy.integrate.nquad><code>scipy.integrate.nquad</code></a> for numerical integration. Unexpected results may be returned if the integral does not exist, or does not converge. The results are rounded to match the order of magnitude of the absolute error of <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.nquad.html#scipy.integrate.nquad><code>scipy.integrate.nquad</code></a>.</p> <p>This function is not vectorized or parallelized.</p> <p>For small sample sizes (<span class=arithmatex>\(n &lt; 100\)</span>), the covariances of the higher-order L-moments (<span class=arithmatex>\(r &gt; 2\)</span>) can be biased. But this bias quickly disappears at roughly <span class=arithmatex>\(n &gt; 200\)</span> (depending on the trim- and L-moment orders).</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariateCDF>UnivariateCDF</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r_max</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-moment orders to consider. If for example <code>r_max = 4</code>, the covariance matrix will be of shape <code>(4, 4)</code>, and the columns and rows correspond to the L-moments of order <span class=arithmatex>\(r = 1, \dots, r_{max}\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Must be a tuple of two non-negative ints or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cov</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Covariance matrix, with shape <code>(r_max, r_max)</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#RuntimeError>RuntimeError</a></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If the covariance matrix is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a> - Population L-moments from the cumulative distribution function</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_ppf><code>l_moment_from_ppf</code></a> - Population L-moments from the quantile function</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a> - Unbiased L-moment estimation from samples</li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment_cov><code>lmo.l_moment_cov</code></a> - Distribution-free exact L-moment exact covariance estimate.</li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_stats_cov_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_cov_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_cov_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Similar to <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a>, but for the <a class="autorefs autorefs-internal" href=#lmo.l_stats><code>lmo.l_stats</code></a>.</p> <p>As the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>, the L-moment ratio&rsquo;s are also distributed (multivariate) normally. The L-stats are defined to be L-moments for <span class=arithmatex>\(r\le 2\)</span>, and L-ratio coefficients otherwise.</p> <p>The corresponding covariance matrix has been found to be</p> <div class=arithmatex>\[ \bf{T}^{(s, t)}_{k, r} = \begin{cases} \bf{\Lambda}^{(s, t)}_{k, r} &amp; k \le 2 \wedge r \le 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} }{ \lambda^{(s,t)}_{2} } &amp; k \le 2 \wedge r &gt; 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_k \bf{\Lambda}^{(s, t)}_{2, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} + \tau_k \tau_r \bf{\Lambda}^{(s, t)}_{2, 2} }{ \Big( \lambda^{(s,t)}_{2} \Big)^2 } &amp; k &gt; 2 \wedge r &gt; 2 \end{cases} \]</div> <p>where <span class=arithmatex>\(\bf{\Lambda}^{(s, t)}\)</span> is the covariance matrix of the L-moments from <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_cov_from_cdf><code>l_moment_cov_from_cdf</code></a>, and <span class=arithmatex>\(\tau^{(s,t)}_r = \lambda^{(s,t)}_r / \lambda^{(s,t)}_2\)</span> the population L-ratio.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariateCDF>UnivariateCDF</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>num</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The amount of L-statistics to return. Defaults to 4.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>4</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim. Must be a tuple of two non-negative ints or floats.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>ppf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Quantile function, for calculating the split integral limits.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.UnivariatePPF>UnivariatePPF</span> | None</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_moment_influence_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_influence_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>l_moment</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_influence_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Influence Function (IF) of a theoretical L-moment.</p> <div class=arithmatex>\[ \psi_{\lambda^{(s, t)}_r | F}(x) = c^{(s,t)}_r \, F(x)^s \, \big( 1-{F}(x) \big)^t \, \tilde{P}^{(s,t)}_{r-1} \big( F(x) \big) \, x - \lambda^{(s,t)}_r \;, \]</div> <p>with <span class=arithmatex>\(F\)</span> the CDF, <span class=arithmatex>\(\tilde{P}^{(s,t)}_{r-1}\)</span> the shifted Jacobi polynomial, and</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r+s+t}{r} \frac{B(r, \, r+s+t)}{B(r+s, \, r+t)} \;, \]</div> <p>where <span class=arithmatex>\(B\)</span> is the (complete) Beta function.</p> <p>The proof is trivial, because population L-moments are <a href=https://wikipedia.org/wiki/Linear_form>linear functionals</a>.</p> <details class=notes open> <summary>Notes</summary> <p>The order parameter <code>r</code> is not vectorized.</p> </details> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Vectorized cumulative distribution function (CDF).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]], <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moment order. Must be a non-negative integer.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim lengths. Defaults to (0, 0).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>l_moment</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The relevant L-moment to use. If not provided, it is calculated from the CDF.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The influence function, with vectorized signature <code>() -&gt; ()</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical.V>V</span>], <span title=lmo.theoretical.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_moment><code>lmo.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_ratio_influence_from_cdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_influence_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>l_moments</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_influence_from_cdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Construct the influence function of a theoretical L-moment ratio.</p> <div class=arithmatex>\[ \psi_{\tau^{(s, t)}_{r,k}|F}(x) = \frac{ \psi_{\lambda^{(s, t)}_r|F}(x) - \tau^{(s, t)}_{r,k} \, \psi_{\lambda^{(s, t)}_k|F}(x) }{ \lambda^{(s,t)}_k } \;, \]</div> <p>where the generalized L-moment ratio is defined as</p> <div class=arithmatex>\[ \tau^{(s, t)}_{r,k} = \frac{ \lambda^{(s, t)}_r }{ \lambda^{(s, t)}_k } \;. \]</div> <p>Because IF&rsquo;s are a special case of the general Gâteuax derivative, the L-ratio IF is derived by applying the chain rule to the <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_influence_from_cdf>L-moment IF</a>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Vectorized cumulative distribution function (CDF).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]], <a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>L-moment ratio order, i.e. the order of the numerator L-moment.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>k</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Denominator L-moment order, defaults to 2.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>2</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim lengths. Defaults to (0, 0).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>l_moments</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The L-moments corresponding to <span class=arithmatex>\(r\)</span> and <span class=arithmatex>\(k\)</span>. If not provided, they are calculated from the CDF.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>influence_function</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The influence function, with vectorized signature <code>() -&gt; ()</code>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical.V>V</span>], <span title=lmo.theoretical.V>V</span>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_comoment_from_pdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>pdf</span><span class=p>,</span> <span class=n>cdfs</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>supports</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_comoment_from_pdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the theoretical L-<em>co</em>moment matrix of a multivariate probability distribution, using the joint PDF <span class=arithmatex>\(f(\vec x) \equiv f(x_1, x_2, \ldots, x_n)\)</span> of random vector <span class=arithmatex>\(\vec{X}\)</span>, and the marginal CDFs <span class=arithmatex>\(F_k\)</span> of its <span class=arithmatex>\(k\)</span>-th random variable.</p> <p>The L-<em>co</em>moment matrix is defined as</p> <div class=arithmatex>\[ \Lambda_{r}^{(s, t)} = \left[ \lambda_{r [ij]}^{(s, t)} \right]_{n \times n} \;, \]</div> <p>with elements</p> <div class=arithmatex>\[ \begin{align*} \lambda_{r [ij]}^{(s, t)} &amp;= c^{(s,t)}_r \int_{\mathbb{R^n}} x_i \ u_j^s \ (1 - u_j)^t \ \widetilde{P}^{(t, s)}_{r - 1} (u_j) \ f(\vec{x}) \ \mathrm{d} \vec{x} \\ &amp;= c^{(s,t)}_r \, \mathbb{E}_{\vec{X}} \left[ X_i \ U_j^s \ (1 - U_j)^t \ \widetilde{P}^{(t, s)}_{r - 1}(U_j) \right] \, , \end{align*} \]</div> <p>where <span class=arithmatex>\(U_j = F_j(X_j)\)</span> and <span class=arithmatex>\(u_j = F_j(x_j)\)</span> denote the (marginal) <a href=https://wikipedia.org/wiki/Probability_integral_transform>probability integral transform </a> of <span class=arithmatex>\(X_j\)</span> and <span class=arithmatex>\(x_j \sim X_j\)</span>. Furthermore, <span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k\)</span> is a shifted Jacobi polynomial, and</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r + s + t}{r} \frac{\B(r,\ r + s + t)}{\B(r + s,\ r + t)} \; , \]</div> <p>a positive constant.</p> <p>For <span class=arithmatex>\(r \ge 2\)</span>, it can also be expressed as</p> <div class=arithmatex>\[ \lambda_{r [ij]}^{(s, t)} = c^{(s,t)}_r \mathrm{Cov} \left[ X_i, \; U_j^s \ (1 - U_j)^t \ \widetilde{P}^{(t, s)}_{r - 1}(U_j) \right] \; , \]</div> <p>and without trim (<span class=arithmatex>\(s = t = 0\)</span>), this simplifies to</p> <div class=arithmatex>\[ \lambda_{r [ij]} = \mathrm{Cov} \left[ X_i ,\; \widetilde{P}_{r - 1} (U_j) \right] \; , \]</div> <p>with <span class=arithmatex>\(\tilde{P}_n = \tilde{P}^{(0, 0)}_n\)</span> the shifted Legendre polynomial. This last form is precisely the definition introduced by Serfling &amp; Xiao (2007).</p> <p>Note that the L-comoments along the diagonal, are equivalent to the (univariate) L-moments, i.e.</p> <div class=arithmatex>\[ \lambda_{r [ii]}^{(s, t)}\big( \vec{X} \big) = \lambda_{r}^{(s, t)}\big( X_i \big) \;. \]</div> <details class=notes open> <summary>Notes</summary> <p>At the time of writing, trimmed L-comoments have not been explicitly defined in the literature. Instead, the author (<a href=https://github.com/jorenham/ >@jorenham</a>) derived it by generizing the (untrimmed) L-comoment definition by Serfling &amp; Xiao (2007), analogous to the generalization of L-moments into TL-moments by Elamir &amp; Seheult (2003).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Find the L-coscale and TL-coscale matrices of the multivariate Student&rsquo;s t distribution with 4 degrees of freedom:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>multivariate_t</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span> <span class=o>=</span> <span class=mi>4</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>loc</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>],</span> <span class=p>[</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>multivariate_t</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=n>loc</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=n>cov</span><span class=p>,</span> <span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>stdtr</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>diag</span><span class=p>(</span><span class=n>cov</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cdf0</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>stdtr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>loc</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>/</span> <span class=n>std</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cdf1</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>stdtr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>loc</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=n>std</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span> <span class=o>=</span> <span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>pdf</span><span class=p>,</span> <span class=p>(</span><span class=n>cdf0</span><span class=p>,</span> <span class=n>cdf1</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
<span class=go>array([[1.0413, 0.3124],</span>
<span class=go>       [0.1562, 0.5207]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span> <span class=o>=</span> <span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>pdf</span><span class=p>,</span> <span class=p>(</span><span class=n>cdf0</span><span class=p>,</span> <span class=n>cdf1</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
<span class=go>array([[0.4893, 0.1468],</span>
<span class=go>       [0.0734, 0.2447]])</span>
</code></pre></div> <p>The (Pearson) correlation coefficient can be recovered in several ways:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>  <span class=c1># &quot;true&quot; correlation</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>l_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>l_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>tl_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>tl_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=go>0.3</span>
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>pdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Joint Probability Distribution Function (PDF), that accepts a float vector of size <span class=arithmatex>\(n\)</span>, and returns a scalar in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>cdfs</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Sequence with <span class=arithmatex>\(n\)</span> marginal CDF&rsquo;s.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Sequence href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence>Sequence</a>[<a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>r</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Non-negative integer <span class=arithmatex>\(r\)</span> with the L-moment order.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyInt>AnyInt</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>supports</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>A sequence with <span class=arithmatex>\(n\)</span> 2-tuples, corresponding to the marginal integration limits. Defaults to <span class=arithmatex>\([(-\infty, \infty), \dots]\)</span>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=collections.abc.Sequence href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence>Sequence</a>[<span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]] | None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.QuadOptions>QuadOptions</span> | None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>lmbda</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The population L-<em>co</em>moment matrix with shape <span class=arithmatex>\(n \times n\)</span>.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.NDArray href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray>NDArray</a>[<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </span> </p> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jmva.2007.01.008>R. Serfling &amp; P. Xiao (2007) - A Contribution to Multivariate L-Moments: L-Comoment Matrices</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.l_coratio_from_pdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_coratio_from_pdf</span><span class=p>(</span><span class=n>pdf</span><span class=p>,</span> <span class=n>cdfs</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>r0</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>supports</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_coratio_from_pdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the theoretical L-<em>co</em>moment ratio matrix of a multivariate probability distribution, using the joint PDF <span class=arithmatex>\(f_{\vec{X}}(\vec{x})\)</span> and <span class=arithmatex>\(n\)</span> marginal CDFs <span class=arithmatex>\(F_X(x)\)</span> of random vector <span class=arithmatex>\(\vec{X}\)</span>.</p> <div class=arithmatex>\[ \tilde \Lambda_{r,r_0}^{(s, t)} = \left[ \left. \lambda_{r [ij]}^{(s, t)} \right/ \lambda_{r_0 [ii]}^{(s, t)} \right]_{n \times n} \]</div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_comoment_from_pdf><code>l_comoment_from_pdf</code></a></li> <li><a class="autorefs autorefs-internal" href=#lmo.l_coratio><code>lmo.l_coratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.ppf_from_l_moments class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>ppf_from_l_moments</span><span class=p>(</span><span class=n>lmbda</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>),</span> <span class=n>validate</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>extrapolate</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.theoretical.ppf_from_l_moments class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Return a PPF (quantile function, or inverse CDF), with the specified. L-moments <span class=arithmatex>\( \tlmoment{s, t}{1}, \tlmoment{s, t}{2}, \ldots, \tlmoment{s, t}{R} \)</span>. Other L-moments are considered zero.</p> <p>For <span class=arithmatex>\( R \)</span> L-moments, this function returns</p> <div class=arithmatex>\[ \hat{Q}_R(u) = \sum_{r=1}^{R} r \frac{2r + s + t - 1}{r + s + t} \tlmoment{s, t}{r} \shjacobi{r - 1}{t}{s}{u}, \]</div> <p>where <span class=arithmatex>\( \shjacobi{n}{a}{b}{x} \)</span> is an <span class=arithmatex>\( n \)</span>-th degree shifted Jacobi polynomial, which is orthogonal for <span class=arithmatex>\( (a, b) \in (-1, \infty)^2 \)</span> on <span class=arithmatex>\( u \in [0, 1] \)</span>.</p> <p>This <em>nonparametric</em> quantile function estimation method was first described by <a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking in 2007</a>. However, his derivation contains a small, but obvious error, resulting in zero-division for <span class=arithmatex>\( r = 1 \)</span>. So Lmo derived this correct version himself, by using the fact that L-moments are the disguised coefficients of the PPF&rsquo;s generalized Fourier-Jacobi series expansion.</p> <p>With Parseval&rsquo;s theorem it can be shown that, if the probability-weighted moment <span class=arithmatex>\( M_{2,s,t} \)</span> (which is the variance if <span class=arithmatex>\( s = t = 0 \)</span>) is finite, then <span class=arithmatex>\( \hat{Q}_R(u) = Q(u) \)</span> as <span class=arithmatex>\( R \to \infty \)</span>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>lmbda</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>1-d array-like of L-moments <span class=arithmatex>\( \tlmoment{s,t}{r} \)</span> for <span class=arithmatex>\( r = 1, 2, \ldots, R \)</span>. At least 2 L-moments are required. All remaining L-moments with <span class=arithmatex>\( r &gt; R \)</span> are considered zero.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=numpy.typing href=https://numpy.org/doc/stable/reference/typing.html#module-numpy.typing>npt</a>.<a class="autorefs autorefs-external" title=numpy.typing.ArrayLike href=https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike>ArrayLike</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>trim</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The trim-length(s) of L-moments <code>lmbda</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(0, 0)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>support</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>A tuple like <code>(x_min, x_max)</code>. If provided, the PPF results will be clipped to within this interval.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical.Pair>Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>(-<a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.inf href=https://numpy.org/doc/stable/reference/constants.html#numpy.inf>inf</a>, <a class="autorefs autorefs-external" title=numpy href=https://numpy.org/doc/stable/reference/index.html#module-numpy>np</a>.<a class="autorefs autorefs-external" title=numpy.inf href=https://numpy.org/doc/stable/reference/constants.html#numpy.inf>inf</a>)</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>validate</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If <code>True</code> (default), a <code>ValueError</code> will be raised if the resulting PPF is invalid (non-monotonic), which can be solved by increasing the <code>trim</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>extrapolate</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>If set to <code>True</code>, a simple moving average of <span class=arithmatex>\( R \)</span> and <span class=arithmatex>\( R - 1 \)</span> will be returned. This generally results in a smoother and more accurate PPF, but its L-moments will not be equal to <code>lmda</code>. Defaults to <code>False</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ppf</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A vectorized PPF (quantile function). Its extra optional keyword argument <code>r_max: int</code> can be used to &ldquo;censor&rdquo; trailing L-moments, i.e. truncating the degree of the polynomial.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=lmo.theoretical._VectorizedPPF>_VectorizedPPF</span></code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.qdf_from_l_moments class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>qdf_from_l_moments</span><span class=p>(</span><span class=n>lmbda</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=o>*</span><span class=p>,</span> <span class=n>validate</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>extrapolate</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.theoretical.qdf_from_l_moments class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Return the QDF (quantile density function, the derivative of the PPF), with the specified L-moments <span class=arithmatex>\( \tlmoment{s, t}{1}, \tlmoment{s, t}{2}, \ldots, \tlmoment{s, t}{R} \)</span>. Other L-moments are considered zero.</p> <p>This function returns</p> <div class=arithmatex>\[ \begin{align*} \hat{q}_R(u) &amp;= \frac{\dd{\hat{Q}_R(u)}}{\dd{u}} \\ &amp;= \sum_{r=2}^{R} r (2r + s + t - 1) \tlmoment{s, t}{r} \shjacobi{r - 2}{t + 1}{s + 1}{u}, \end{align*} \]</div> <p>where <span class=arithmatex>\( \shjacobi{n}{a}{b}{x} \)</span> is an <span class=arithmatex>\( n \)</span>-th degree shifted Jacobi polynomial, which is orthogonal for <span class=arithmatex>\( (a, b) \in (-1, \infty)^2 \)</span> on <span class=arithmatex>\( u \in [0, 1] \)</span>.</p> <p>See <a class="autorefs autorefs-internal" href=#lmo.theoretical.ppf_from_l_moments><code>ppf_from_l_moments</code></a> for options.</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.cdf_from_ppf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>cdf_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>)</span></code> <a href=#lmo.theoretical.cdf_from_ppf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Numerical inversion of the PPF.</p> </div> </div> <div class="doc doc-object doc-function"> <h4 id=lmo.theoretical.entropy_from_qdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>entropy_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.theoretical.entropy_from_qdf class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Evaluate the (differential / continuous) entropy <span class=arithmatex>\( H(X) \)</span> of a univariate random variable <span class=arithmatex>\( X \)</span>, from its <em>quantile density function</em> (QDF), <span class=arithmatex>\( q(u) = \frac{\mathrm{d} F^{-1}(u)}{\mathrm{d} u} \)</span>, with <span class=arithmatex>\( F^{-1} \)</span> the inverse of the CDF, i.e. the PPF / quantile function.</p> <p>The derivation follows from the identity <span class=arithmatex>\( f(x) = 1 / q(F(x)) \)</span> of PDF <span class=arithmatex>\( f \)</span>, specifically:</p> <div class=arithmatex>\[ h(X) = \E[-\ln f(X)] = \int_\mathbb{R} \ln \frac{1}{f(x)} \mathrm{d} x = \int_0^1 \ln q(u) \mathrm{d} u \]</div> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>qdf</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>The quantile distribution function (QDF).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (float, *Ts, **Ts) -&gt; float</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional additional positional arguments to pass to <code>qdf</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>*Ts</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional keyword arguments to pass to <code>qdf</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>**Ts</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The differential entropy <span class=arithmatex>\( H(X) \)</span>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Differential_entropy>Differential entropy - Wikipedia </a></li> </ul> </details> </div> </div> </div> </div> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-28</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jorenham/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.tabs.link", "content.tooltips", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.ebd0bdb7.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/copy-tex.min.js></script> <script src=../scripts/katex.d735b7.min.js></script> </body> </html>