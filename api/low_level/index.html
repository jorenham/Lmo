<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Trimmed L-moments for robust statistics."><meta name=author content="Joren Hammudoglu"><link href=https://jorenham.github.io/Lmo/api/low_level/ rel=canonical><link href=../pandas/ rel=prev><link href=../../distributions/ rel=next><link rel=icon href=../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.43"><title>Low-level API - Lmo</title><link rel=stylesheet href=../../assets/stylesheets/main.0253249f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css><link rel=stylesheet href=../../styles/theme.eeeecd.min.css><link rel=stylesheet href=../../styles/katex.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KH79N7XQCE"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KH79N7XQCE",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KH79N7XQCE",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=nose data-md-color-accent=skin> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#low-level-api class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Lmo class="md-header__button md-logo" aria-label=Lmo data-md-component=logo> <img src=../../img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Lmo </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Low-level API </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jorenham/Lmo/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> jorenham/Lmo </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../../examples/visual_intro/ class=md-tabs__link> Examples </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../L-moments/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../distributions/ class=md-tabs__link> Distributions </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Lmo class="md-nav__button md-logo" aria-label=Lmo data-md-component=logo> <img src=../../img/logo.png alt=logo> </a> Lmo </label> <div class=md-nav__source> <a href=https://github.com/jorenham/Lmo/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> jorenham/Lmo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../examples/visual_intro/ class=md-nav__link> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../L-moments/ class=md-nav__link> <span class=md-ellipsis> Sample L-moments </span> </a> </li> <li class=md-nav__item> <a href=../L-comoments/ class=md-nav__link> <span class=md-ellipsis> Sample L-comoments </span> </a> </li> <li class=md-nav__item> <a href=../distributions/ class=md-nav__link> <span class=md-ellipsis> Probability Distributions </span> </a> </li> <li class=md-nav__item> <a href=../diagnostic/ class=md-nav__link> <span class=md-ellipsis> Statistical test and tools </span> </a> </li> <li class=md-nav__item> <a href=../pandas/ class=md-nav__link> <span class=md-ellipsis> Optional pandas integration </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Low-level API </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Low-level API </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#lmo.constants class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;constants </span> </a> <nav class=md-nav aria-label= constants> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.constants.theta_m class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;theta_m </span> </a> </li> <li class=md-nav__item> <a href=#lmo.constants.theta_m_bar class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;theta_m_bar </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.linalg class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;linalg </span> </a> <nav class=md-nav aria-label= linalg> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.linalg.sandwich class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sandwich </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.pascal class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.ir_pascal class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ir_pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_legendre class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sh_legendre </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.succession_matrix class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;succession_matrix </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.trim_matrix class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.special class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;special </span> </a> <nav class=md-nav aria-label= special> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.special.fpow class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fpow </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.gamma2 class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gamma2 </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.harmonic class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;harmonic </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.norm_sh_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;norm_sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.fourier_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fourier_jacobi </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.theoretical class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;theoretical </span> </a> <nav class=md-nav aria-label= theoretical> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.theoretical.cdf_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;cdf_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.entropy_from_qdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;entropy_from_qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_comoment_from_pdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_comoment_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_coratio_from_pdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_coratio_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_qdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.ppf_from_l_moments class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ppf_from_l_moments </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.qdf_from_l_moments class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;qdf_from_l_moments </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.inference class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;inference </span> </a> <nav class=md-nav aria-label= inference> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.fit class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fit </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GMMResult </span> </a> <nav class=md-nav aria-label= GMMResult> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_arg class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_arg </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_con class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_con </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_extra class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_extra </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.j_test class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;j_test </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AIC class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AIC </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AICc class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AICc </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../distributions/ class=md-nav__link> <span class=md-ellipsis> Distributions </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#lmo.constants class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;constants </span> </a> <nav class=md-nav aria-label= constants> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.constants.theta_m class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;theta_m </span> </a> </li> <li class=md-nav__item> <a href=#lmo.constants.theta_m_bar class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;theta_m_bar </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.linalg class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;linalg </span> </a> <nav class=md-nav aria-label= linalg> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.linalg.sandwich class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sandwich </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.pascal class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.ir_pascal class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ir_pascal </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_legendre class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sh_legendre </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.sh_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.succession_matrix class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;succession_matrix </span> </a> </li> <li class=md-nav__item> <a href=#lmo.linalg.trim_matrix class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.special class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;special </span> </a> <nav class=md-nav aria-label= special> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.special.fpow class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fpow </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.gamma2 class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gamma2 </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.harmonic class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;harmonic </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.norm_sh_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;norm_sh_jacobi </span> </a> </li> <li class=md-nav__item> <a href=#lmo.special.fourier_jacobi class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fourier_jacobi </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.theoretical class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;theoretical </span> </a> <nav class=md-nav aria-label= theoretical> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.theoretical.cdf_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;cdf_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.entropy_from_qdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;entropy_from_qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_comoment_from_pdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_comoment_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_coratio_from_pdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_coratio_from_pdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_from_qdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_from_qdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_from_ppf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_from_ppf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_stats_cov_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_stats_cov_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_moment_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_moment_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.l_ratio_influence_from_cdf class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;l_ratio_influence_from_cdf </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.ppf_from_l_moments class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ppf_from_l_moments </span> </a> </li> <li class=md-nav__item> <a href=#lmo.theoretical.qdf_from_l_moments class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;qdf_from_l_moments </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lmo.inference class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;inference </span> </a> <nav class=md-nav aria-label= inference> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.fit class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fit </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GMMResult </span> </a> <nav class=md-nav aria-label= GMMResult> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_arg class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_arg </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_con class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_con </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.n_extra class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_extra </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.j_test class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;j_test </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AIC class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AIC </span> </a> </li> <li class=md-nav__item> <a href=#lmo.inference.GMMResult.AICc class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AICc </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=low-level-api>Low-level API<a class=headerlink href=#low-level-api title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <h2 id=lmo.constants class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <code>lmo.constants</code> <a href=#lmo.constants class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <p>Mathematical constants.</p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=lmo.constants.theta_m class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>constants</span><span class=o>.</span><span class=n>theta_m</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.9553166181245093</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.constants.theta_m class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Magic angle <span class=arithmatex>\( \theta_m = \arctan \sqrt 2 \)</span>.</p> <details class=see-also open> <summary>See also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Magic_angle>Magic angle - Wikipedia</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=lmo.constants.theta_m_bar class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>constants</span><span class=o>.</span><span class=n>theta_m_bar</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.1520433619923482</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#lmo.constants.theta_m_bar class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Magic number of turns <span class=arithmatex>\( \bar{\theta}_m = \theta_m / (2 \pi) \)</span>.</p> <details class=see-also open> <summary>See also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.constants.theta_m><code>lmo.constants.theta_m</code></a></li> <li><a href=https://wikipedia.org/wiki/Magic_angle>Magic angle - Wikipedia</a></li> <li><a href=https://wikipedia.org/wiki/Turn_(angle)>Turn (angle) - Wikipedia</a></li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=lmo.linalg class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <code>lmo.linalg</code> <a href=#lmo.linalg class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <p>Linear algebra and linearized orthogonal polynomials.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.sandwich class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sandwich</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.sandwich class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Calculates the &ldquo;sandwich&rdquo; matrix product (<code>A @ X @ A.T</code>) along the specified <code>X</code> axis.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>A</code> </td> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>, <span title=lmo.linalg._R>_R</span>], <a class="autorefs autorefs-external" title=numpy.floating href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating>floating</a>[<a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a>]]</code> </td> <td> <div class=doc-md-description> <p>2-D array of shape <code>(k, r)</code>, the &ldquo;bread&rdquo;.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._R>_R</span>, *<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._R>_R</span>, ...]], <a class="autorefs autorefs-external" title=numpy.floating href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating>floating</a>[<a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a>]]</code> </td> <td> <div class=doc-md-description> <p>Array of shape <code>(r, r, ...)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><span title=lmo.linalg._DType>_DType</span>[<span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>The data type of the result.</p> </div> </td> <td> <code><a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>C</code></td> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>, *<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>, ...]], <span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>Array of shape <code>(k, k, ...)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Covariance_matrix>https://wikipedia.org/wiki/Covariance_matrix</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.pascal class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>pascal</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inv</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.linalg.pascal class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Construct the lower-diagonal Pascal matrix <span class=arithmatex>\(L_{k \times k\)</span>}$, or its matrix inverse <span class=arithmatex>\(L^{-1}\)</span>.</p> <div class=arithmatex>\[ \begin{align} L_{ij} &amp;= \binom{i}{j} \\ L^{-1}_{ij} &amp;= (-1)^{i - j} L_{ij} \end{align} \]</div> <p>Implemented using recursion, unlike the slow naive implementation from the equivalent <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pascal.html#scipy.linalg.pascal><code>scipy.linalg.pascal</code></a> and <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.invpascal.html#scipy.linalg.invpascal><code>scipy.linalg.invpascal</code></a> functions using <code>kind='lower'</code>. By using the binomial recurrence relation, assuming <span class=arithmatex>\(0 &lt; j &lt; i\)</span>, <span class=arithmatex>\(\binom{i}{j} = \frac{i}{j} \binom{i-1}{j-1}\)</span>, the following recursive definition is obtained:</p> <div class=arithmatex>\[ L_{ij} = \begin{cases} 0 &amp; \text{if } i &lt; j \text{,} \\ 1 &amp; \text{if } i = j \vee j = 0 \text{, and} \\ (i \, L_{i-1,\, j-1}) / j &amp; \text{otherwise.} \end{cases} \]</div> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>)</span>
<span class=go>array([[1, 0, 0, 0],</span>
<span class=go>       [1, 1, 0, 0],</span>
<span class=go>       [1, 2, 1, 0],</span>
<span class=go>       [1, 3, 3, 1]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>,</span> <span class=n>inv</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>rint</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>pascal</span><span class=p>(</span><span class=mi>4</span><span class=p>)))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
</code></pre></div> <p>Now, let&rsquo;s compare with scipy:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>scipy.linalg</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>scipy</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>invpascal</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int_</span><span class=p>)</span>
<span class=go>array([[ 1,  0,  0,  0],</span>
<span class=go>       [-1,  1,  0,  0],</span>
<span class=go>       [ 1, -2,  1,  0],</span>
<span class=go>       [-1,  3, -3,  1]])</span>
</code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.ir_pascal class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>ir_pascal</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=p>)</span></code> <a href=#lmo.linalg.ir_pascal class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Inverse regulatized lower-diagonal Pascal matrix, <span class=arithmatex>\(\bar{L}_{ij} = L^{-1}_ij / i\)</span>.</p> <p>Used to linearly combine order statistics order statistics into L-moments.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.sh_legendre class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sh_legendre</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span></code> <a href=#lmo.linalg.sh_legendre class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Shifted Legendre polynomial coefficient matrix <span class=arithmatex>\(\widetilde{P}\)</span> of shape <code>(k, k)</code>.</p> <p>The <span class=arithmatex>\(j\)</span>-th coefficient of the shifted Legendre polynomial of degree <span class=arithmatex>\(k\)</span> is at <span class=arithmatex>\((k, j)\)</span>:</p> <div class=arithmatex>\[ \widetilde{p}_{k, j} = (-1)^{k - j} \binom{k}{j} \binom{k + j}{j} \]</div> <p>Useful for transforming probability-weighted moments into L-moments.</p> <details class=danger open> <summary>Danger</summary> <p>For <span class=arithmatex>\(k \ge 29\)</span>, <strong>all</strong> 64-bits dtypes (default is int64) will overflow, which results in either an <code>OverflowError</code> (if you&rsquo;re lucky), or will give incorrect results. Similarly, all 32-bits dtypes (e.g. <code>np.int_</code> on Windows) already overflow when <span class=arithmatex>\(k \ge 16\)</span>.</p> <p><strong>This is not explicitly checked</strong> &ndash; so be sure to select the right <code>dtype</code> depending on <code>k</code>.</p> <p>One option is to use <code>dtype=np.object_</code>, which will use Python-native <code>int</code>. However, this is a lot slower, and is likely to fail. For instance, when multiplied together with some <code>float64</code> array, a <code>TypeError</code> is raised.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>k</code> </td> <td> <code><span title=lmo.linalg._K>_K</span></code> </td> <td> <div class=doc-md-description> <p>The size of the matrix, and the max degree of the shifted Legendre polynomial.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><span title=lmo.linalg._DType>_DType</span>[<span title=lmo.linalg._TI>_TI</span>]</code> </td> <td> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code>. Must be signed. The default is <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64><code>numpy.int64</code></a>.</p> </div> </td> <td> <code><a class="autorefs autorefs-external" title=numpy.int64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64>int64</a></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>P</code></td> <td> <code><span title=lmo.linalg._Square>_Square</span>[<span title=lmo.linalg._K>_K</span>, <span title=lmo.linalg._TI>_TI</span>]</code> </td> <td> <div class=doc-md-description> <p>2-D array of the lower-triangular square matrix of size <span class=arithmatex>\(k^2\)</span>`.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate <span class=arithmatex>\(\widetilde{P}_{4 \times 4}\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>sh_legendre</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_legendre</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[  1,   0,   0,   0],</span>
<span class=go>       [ -1,   2,   0,   0],</span>
<span class=go>       [  1,  -6,   6,   0],</span>
<span class=go>       [ -1,  12, -30,  20]])</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Legendre_polynomials>https://wikipedia.org/wiki/Legendre_polynomials</a></li> <li><a href=https://wikipedia.org/wiki/Pascal_matrix>https://wikipedia.org/wiki/Pascal_matrix</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.sh_jacobi class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>sh_jacobi</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.sh_jacobi class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Shifted Jacobi polynomial coefficient matrix <span class=arithmatex>\(\widetilde{P}^{(a,b)}\)</span> of shape <code>(k, k)</code>.</p> <p>The <span class=arithmatex>\(j\)</span>-th coefficient of the shifted Jacobi polynomial of degree <span class=arithmatex>\(k\)</span> is at <span class=arithmatex>\((k, j)\)</span>:</p> <p>The &ldquo;shift&rdquo; refers to the change of variables <span class=arithmatex>\(x \mapsto 2x - 1\)</span> in the (unshifted) Jacobi (or hypergeometric) polynomials.</p> <p>The (shifted) Jacobi polynomials <span class=arithmatex>\(\widetilde{P}^{(a,b)}\)</span> generalize the (shifted) Legendre polynomials <span class=arithmatex>\(\widetilde{P}\)</span>: <span class=arithmatex>\(\widetilde{P}^{(0, 0)} = \widetilde{P}\)</span></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>k</code> </td> <td> <code><span title=lmo.linalg._K>_K</span></code> </td> <td> <div class=doc-md-description> <p>The size of the matrix, and the max degree of the polynomial.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>a</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The <span class=arithmatex>\(\alpha\)</span> parameter, must be <span class=arithmatex>\(\ge 0\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>b</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The <span class=arithmatex>\(\beta\)</span> parameter, must be <span class=arithmatex>\(\ge 0\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><span title=lmo.linalg._DType>_DType</span>[<span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code>. Default is <code>numpy.int64</code> if <code>a</code> and <code>b</code> are integers, otherwise <code>np.float64</code>.</p> </div> </td> <td> <code><a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>P</code></td> <td> <code><span title=lmo.linalg._Square>_Square</span>[<span title=lmo.linalg._K>_K</span>, <span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>2-D array of the lower-triangular square matrix of size <span class=arithmatex>\(k^2\)</span>`.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate <span class=arithmatex>\(\widetilde{P}^{(1, 1)}_{4 \times 4}\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>sh_jacobi</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_jacobi</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
<span class=go>array([[  1,   0,   0,   0],</span>
<span class=go>       [ -2,   4,   0,   0],</span>
<span class=go>       [  3, -15,  15,   0],</span>
<span class=go>       [ -4,  36, -84,  56]])</span>
</code></pre></div> <p>Let&rsquo;s compare <span class=arithmatex>\(\widetilde{P}^(1, \pi)_3\)</span> with the scipy Jacobi poly1d. This requires manual shifting <span class=arithmatex>\(x \mapsto f(x)\)</span>, with <span class=arithmatex>\(f(x) = 2x - 1\)</span>:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span> <span class=nn>scipy.special</span> <span class=k>as</span> <span class=nn>sc</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>f_x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>poly1d</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># f(x) = 2*x + 1</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sc</span><span class=o>.</span><span class=n>jacobi</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)(</span><span class=n>f_x</span><span class=p>)</span>
<span class=go>poly1d([ 125.80159497, -228.55053774,  128.54584648,  -21.79690371])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sh_jacobi</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)[</span><span class=mi>3</span><span class=p>]</span>
<span class=go>array([ -21.79690371,  128.54584648, -228.55053774,  125.80159497])</span>
</code></pre></div> <p>Apart from the reversed coefficients of <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/generated/numpy.poly1d.html#numpy.poly1d><code>numpy.poly1d</code></a> (an awkward design choice, but it&rsquo;s fixed in the new <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/routines.polynomials-package.html#module-numpy.polynomial><code>numpy.polynomial</code></a> module.)</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://mathworld.wolfram.com/JacobiPolynomial.html>https://mathworld.wolfram.com/JacobiPolynomial.html</a></li> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.jacobi.html#scipy.special.jacobi><code>scipy.special.jacobi</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.succession_matrix class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>succession_matrix</span><span class=p>(</span><span class=n>c</span><span class=p>)</span></code> <a href=#lmo.linalg.succession_matrix class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>A toeplitz-like transformation matrix construction, that prepends <span class=arithmatex>\(i\)</span> zeroes to <span class=arithmatex>\(i\)</span>-th row, so that the input shape is mapped from <code>(n, k)</code> to <code>(n, k + n)</code>.</p> <p>So all values <span class=arithmatex>\(i &gt; j \vee i + j \ge k\)</span> are zero in the succession matrix.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>c</code> </td> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>], <span title=lmo.linalg._T>_T</span>] | <span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>], <span title=lmo.linalg._T>_T</span>]</code> </td> <td> <div class=doc-md-description> <p>Dense matrix of shape <code>(n, k)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>S</code></td> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._K>_K</span>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>], <span title=lmo.linalg._T>_T</span>]</code> </td> <td> <div class=doc-md-description> <p>Matrix of shape <code>(n, k + n)</code></p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>succession_matrix</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c</span>
<span class=go>array([[1, 2],</span>
<span class=go>       [3, 4],</span>
<span class=go>       [5, 6],</span>
<span class=go>       [7, 8]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>succession_matrix</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
<span class=go>array([[1, 2, 0, 0, 0],</span>
<span class=go>       [0, 3, 4, 0, 0],</span>
<span class=go>       [0, 0, 5, 6, 0],</span>
<span class=go>       [0, 0, 0, 7, 8]])</span>
</code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.linalg.trim_matrix class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>trim_matrix</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span></code> <a href=#lmo.linalg.trim_matrix class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Linearization of the trimmed L-moment recurrence relations, following the (corrected) derivation by Hosking (2007) from the (shifted) Jacobi Polynomials.</p> <p>This constructs a <span class=arithmatex>\(r \times r + t_1 + t_2\)</span> matrix <span class=arithmatex>\(T^{(t_1, t_2)}\)</span> that &ldquo;trims&rdquo; conventional L-moments. E.g. the first 3 <span class=arithmatex>\((1, 1)\)</span> trimmed L-moments can be obtained from the first <span class=arithmatex>\(3+1+1=5\)</span> (untrimmed) L-moments (assuming they exist) with <code>trim_matrix(3, (1, 1)) @ l_moment(x, np.ogrid[:5] + 1)</code>.</p> <p>The big &ldquo;L&rdquo; in &ldquo;L-moment&rdquo;, referring to it being a <em>Linear</em> combination of order statistics, has been prominently put in the name by Hosking (1990) for a good reason. It means that transforming order statistics to a bunch of L-moments, can be done using a single matrix multiplication (see <a class="autorefs autorefs-internal" href=#lmo.linalg.sh_legendre><code>lmo.linalg.sh_legendre</code></a>). By exploiting liniarity, it can easily be chained with this trim matrix, to obtain a reusable order-statistics -&gt; trimmed L-moments transformation (matrix).</p> <p>Note that these linear transformations can be used in exactly the same way to e.g. calculate several population TL-moments of some random varianble, using nothing but its theoretical probablity-weighted moments (PWMs).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.linalg._R>_R</span></code> </td> <td> <div class=doc-md-description> <p>The max (trimmed) L-moment order.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>]</code> </td> <td> <div class=doc-md-description> <p>Left- and right-trim orders <span class=arithmatex>\((t_1, t_2)\)</span>, integers <span class=arithmatex>\(\ge 0\)</span>. If set to (0, 0), the identity matrix is returned.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><span title=lmo.linalg._DType>_DType</span>[<span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>Desired output data type, e.g, <code>numpy.float64</code> (default).</p> </div> </td> <td> <code><a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=optype.numpy.Array>Array</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<span title=lmo.linalg._R>_R</span>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>], <span title=lmo.linalg._TF>_TF</span>]</code> </td> <td> <div class=doc-md-description> <p>Toeplitz-like matrix of shape <span class=arithmatex>\((r, r + t_1 + t_2)\)</span>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>lmo.linalg</span> <span class=kn>import</span> <span class=n>trim_matrix</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>trim_matrix</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=go>array([[ 1.        , -1.        ,  0.        ,  0.        ],</span>
<span class=go>       [ 0.        ,  0.75      , -0.75      ,  0.        ],</span>
<span class=go>       [ 0.        ,  0.        ,  0.66666667, -0.66666667]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>trim_matrix</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=go>array([[1.        , 1.        , 0.        , 0.        ],</span>
<span class=go>       [0.        , 0.75      , 0.75      , 0.        ],</span>
<span class=go>       [0.        , 0.        , 0.66666667, 0.66666667]])</span>
</code></pre></div> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=lmo.special class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <code>lmo.special</code> <a href=#lmo.special class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <p>Mathematical &ldquo;special&rdquo; functions, extending <code>scipy.special</code>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=lmo.special.fpow class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.fpow class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=n>_Real_in</span> <span class=o>|</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=n>_Real_in</span> <span class=o>|</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=n>_ArrayT</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrayT</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>fpow</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=n>_ArrayT</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrayT</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Factorial power, or falling factorial.</p> <p>It is defined as</p> <div class=arithmatex>\[ \ffact{x}{n} = \frac{\Gamma(x + 1)}{\Gamma(x - n + 1)} \]</div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span> | <span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Real-valued array-like or scalar.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>n</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span> | <span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Real valued array-like or scalar.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>out</code> </td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional output array for the function results</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | <span title=lmo.special._F8>_F8</span> | <span title=lmo.special._F8ND>_F8ND</span></code> </td> <td> <div class=doc-md-description> <p>Array or scalar with the value(s) of the function.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.poch.html#scipy.special.poch><code>scipy.special.poch</code></a> &ndash; the rising factorial</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.special.gamma2 class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>gamma2</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.gamma2 class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>gamma2</span><span class=p>(</span><span class=n>a</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>gamma2</span><span class=p>(</span><span class=n>a</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>gamma2</span><span class=p>(</span><span class=n>a</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=n>_ArrayT</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrayT</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Incomplete (upper) gamma function.</p> <p>It is defined as</p> <div class=arithmatex>\[ \Gamma(a,\ x) = \int_x^\infty t^{a-1} e^{-t} \mathrm{d}t \]</div> <p>for <span class=arithmatex>\( a \ge 0 \)</span> and <span class=arithmatex>\( x \ge 0 \)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>a</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span></code> </td> <td> <div class=doc-md-description> <p>Real-valued non-negative scalar.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span> | <span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Real-valued non-negative array-like.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>out</code> </td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional output array for the results.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | <span title=lmo.special._F8>_F8</span> | <span title=lmo.special._F8ND>_F8ND</span></code> </td> <td> <div class=doc-md-description> <p>Scalar of array with the values of the incomplete gamma function.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.gammaincc.html#scipy.special.gammaincc><code>scipy.special.gammaincc</code></a> for the regularized gamma function <span class=arithmatex>\( Q(a,\ x) \)</span>.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.special.harmonic class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>harmonic</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.special.harmonic class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>harmonic</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>harmonic</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>harmonic</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=n>_ArrayT</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrayT</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Harmonic number <span class=arithmatex>\( H_n = \sum_{k=1}^{n} 1 / k \)</span>, extended for real and complex argument via analytic contunuation.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=go>0.0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=go>1.0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=go>1.5</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=go>4.32674</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
<span class=go>1.87274</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>harmonic</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span> <span class=o>/</span> <span class=mi>12</span><span class=p>)</span>
<span class=go>-0.146106</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>n</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span> | <span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Real- or complex- valued parameter, as array-like or scalar.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>out</code> </td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional real or complex output array for the results.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><span title=lmo.special._ArrayT>_ArrayT</span> | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <span title=lmo.special._F8ND>_F8ND</span></code> </td> <td> <div class=doc-md-description> <p>Array or scalar with the value(s) of the function.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://w.wiki/A63b>Harmonic number - Wikipedia</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.special.norm_sh_jacobi class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>norm_sh_jacobi</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span></code> <a href=#lmo.special.norm_sh_jacobi class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>norm_sh_jacobi</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=n>AnyOrder</span><span class=p>,</span> <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>beta</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>norm_sh_jacobi</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=n>AnyOrderND</span><span class=p>,</span> <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>beta</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the (weighted) <span class=arithmatex>\( L^2 \)</span>-norm of a shifted Jacobi polynomial.</p> <p>Specifically,</p> <div class=arithmatex>\[ \| p_n \|^2 = \braket{p_n | p_n} = \int_0^1 |p_n|^2 \mathrm{d}x = \frac{1}{2 n + \alpha + \beta + 1} \frac {\Gamma(n + \alpha + 1) \Gamma(n + \beta + 1)} {n! \ \Gamma(n + \alpha + \beta + 1)} \]</div> <p>with</p> <div class=arithmatex>\[ p_n(x) \equiv x^{\beta / 2} \ (1 - x)^{\alpha / 2} \ \shjacobi{n}{\alpha}{\beta}{x} \]</div> <p>the normalized Jacobi polynomial on <span class=arithmatex>\( [0, 1] \)</span>.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.special.fourier_jacobi class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>special</span><span class=o>.</span><span class=n>fourier_jacobi</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span></code> <a href=#lmo.special.fourier_jacobi class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>fourier_jacobi</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_Real_in</span><span class=p>,</span> <span class=n>c</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=n>a</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>fourier_jacobi</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=n>c</span><span class=p>:</span> <span class=n>_RealND_in</span><span class=p>,</span> <span class=n>a</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_F8ND</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the Fourier-Jacobi series, using the Clenshaw summation algorithm.</p> <p>If <span class=arithmatex>\( c \)</span> is of length <span class=arithmatex>\( n + 1 \)</span>, this function returns the value:</p> <div class=arithmatex>\[ c_0 \cdot \jacobi{0}{a}{b}{x} + c_1 \cdot \jacobi{1}{a}{b}{x} + \ldots + c_n \cdot \jacobi{n}{a}{b}{x} \]</div> <p>Here, <span class=arithmatex>\( \jacobi{n}{a}{b}{x} \)</span> is a Jacobi polynomial of degree <span class=arithmatex>\( n = |\vec{c}| \)</span>, which is orthogonal iff <span class=arithmatex>\( (a, b) \in (-1,\ \infty)^2 \)</span> and <span class=arithmatex>\( x \in [0,\ 1] \)</span>.</p> <details class=tip open> <summary>Tip</summary> <p>Trailing zeros in the coefficients will be used in the evaluation, so they should be avoided if efficiency is a concern.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=lmo.special._Real_in>_Real_in</span> | <span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Scalar or array-like with input data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>c</code> </td> <td> <code><span title=lmo.special._RealND_in>_RealND_in</span></code> </td> <td> <div class=doc-md-description> <p>Array-like of coefficients, ordered from low to high. All coefficients to the right are considered zero.</p> <p>For instance, <code>[4, 3, 2]</code> gives <span class=arithmatex>\( 4 \jacobi{0}{a}{b}{x} + 3 \jacobi{1}{a}{b}{x} + 2 \jacobi{2}{a}{b}{x} \)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>a</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Jacobi parameter <span class=arithmatex>\( a &gt; -1 \)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>b</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Jacobi parameter <span class=arithmatex>\( a &gt; -1 \)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><span title=lmo.special._F8>_F8</span> | <span title=lmo.special._F8ND>_F8ND</span></code> </td> <td> <div class=doc-md-description> <p>Scalar or array of same shape as <code>x</code>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Generalized_Fourier_series>Generalized Fourier series - Wikipedia</a></li> <li><a href=https://mathworld.wolfram.com/ClenshawRecurrenceFormula.html>Clenshaw Recurrence Formula - Wolfram MathWorld</a></li> <li><a href=https://mathworld.wolfram.com/JacobiPolynomial.html>Jacobi Polynomial - Worlfram Mathworld</a></li> </ul> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=lmo.theoretical class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <code>lmo.theoretical</code> <a href=#lmo.theoretical class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <p>Theoretical (population) L-moments of known univariate probability distributions.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.cdf_from_ppf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>cdf_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>)</span></code> <a href=#lmo.theoretical.cdf_from_ppf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Numerical inversion of the PPF.</p> <details class=note open> <summary>Note</summary> <p>This function isn&rsquo;t vectorized.</p> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.entropy_from_qdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>entropy_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.theoretical.entropy_from_qdf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>entropy_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>:</span> <span class=n>_QDF</span><span class=p>[[]])</span> <span class=o>-&gt;</span> <span class=nb>float</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>entropy_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>:</span> <span class=n>_QDF</span><span class=p>[</span><span class=n>_Tss</span><span class=p>],</span> <span class=o>/</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>:</span> <span class=n>_Tss</span><span class=o>.</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>:</span> <span class=n>_Tss</span><span class=o>.</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the (differential / continuous) entropy <span class=arithmatex>\( H(X) \)</span> of a univariate random variable <span class=arithmatex>\( X \)</span>, from its <em>quantile density function</em> (QDF), <span class=arithmatex>\( q(u) = \frac{\mathrm{d} F^{-1}(u)}{\mathrm{d} u} \)</span>, with <span class=arithmatex>\( F^{-1} \)</span> the inverse of the CDF, i.e. the PPF / quantile function.</p> <p>The derivation follows from the identity <span class=arithmatex>\( f(x) = 1 / q(F(x)) \)</span> of PDF <span class=arithmatex>\( f \)</span>, specifically:</p> <div class=arithmatex>\[ h(X) = \E[-\ln f(X)] = \int_\mathbb{R} \ln \frac{1}{f(x)} \mathrm{d} x = \int_0^1 \ln q(u) \mathrm{d} u \]</div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>qdf</code> </td> <td> <code> (float, *Tss.args, **Tss.kwargs) -&gt; float</code> </td> <td> <div class=doc-md-description> <p>The quantile distribution function (QDF).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>*args</code> </td> <td> <code><span title=Tss.args>args</span></code> </td> <td> <div class=doc-md-description> <p>Optional additional positional arguments to pass to <code>qdf</code>.</p> </div> </td> <td> <code>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>**kwds</code> </td> <td> <code><span title=Tss.kwargs>kwargs</span></code> </td> <td> <div class=doc-md-description> <p>Optional keyword arguments to pass to <code>qdf</code>.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The differential entropy <span class=arithmatex>\( H(X) \)</span>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a href=https://wikipedia.org/wiki/Differential_entropy>Differential entropy - Wikipedia </a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_comoment_from_pdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>pdf</span><span class=p>,</span> <span class=n>cdfs</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>supports</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_comoment_from_pdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Evaluate the theoretical L-<em>co</em>moment matrix of a multivariate probability distribution, using the joint PDF <span class=arithmatex>\(f(\vec x) \equiv f(x_1, x_2, \ldots, x_n)\)</span> of random vector <span class=arithmatex>\(\vec{X}\)</span>, and the marginal CDFs <span class=arithmatex>\(F_k\)</span> of its <span class=arithmatex>\(k\)</span>-th random variable.</p> <p>The L-<em>co</em>moment matrix is defined as</p> <div class=arithmatex>\[ \Lambda_{r}^{(s, t)} = \left[ \lambda_{r [ij]}^{(s, t)} \right]_{n \times n} \;, \]</div> <p>with elements</p> <div class=arithmatex>\[ \begin{align*} \lambda_{r [ij]}^{(s, t)} &amp;= c^{(s,t)}_r \int_{\mathbb{R^n}} x_i \ u_j^s \ (1 - u_j)^t \ \widetilde{P}^{(t, s)}_{r - 1} (u_j) \ f(\vec{x}) \ \mathrm{d} \vec{x} \\ &amp;= c^{(s,t)}_r \, \mathbb{E}_{\vec{X}} \left[ X_i \ U_j^s \ (1 - U_j)^t \ \widetilde{P}^{(t, s)}_{r - 1}(U_j) \right] \, , \end{align*} \]</div> <p>where <span class=arithmatex>\(U_j = F_j(X_j)\)</span> and <span class=arithmatex>\(u_j = F_j(x_j)\)</span> denote the (marginal) <a href=https://wikipedia.org/wiki/Probability_integral_transform>probability integral transform </a> of <span class=arithmatex>\(X_j\)</span> and <span class=arithmatex>\(x_j \sim X_j\)</span>. Furthermore, <span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k\)</span> is a shifted Jacobi polynomial, and</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r + s + t}{r} \frac{\B(r,\ r + s + t)}{\B(r + s,\ r + t)} \; , \]</div> <p>a positive constant.</p> <p>For <span class=arithmatex>\(r \ge 2\)</span>, it can also be expressed as</p> <div class=arithmatex>\[ \lambda_{r [ij]}^{(s, t)} = c^{(s,t)}_r \mathrm{Cov} \left[ X_i, \; U_j^s \ (1 - U_j)^t \ \widetilde{P}^{(t, s)}_{r - 1}(U_j) \right] \; , \]</div> <p>and without trim (<span class=arithmatex>\(s = t = 0\)</span>), this simplifies to</p> <div class=arithmatex>\[ \lambda_{r [ij]} = \mathrm{Cov} \left[ X_i ,\; \widetilde{P}_{r - 1} (U_j) \right] \; , \]</div> <p>with <span class=arithmatex>\(\tilde{P}_n = \tilde{P}^{(0, 0)}_n\)</span> the shifted Legendre polynomial. This last form is precisely the definition introduced by Serfling &amp; Xiao (2007).</p> <p>Note that the L-comoments along the diagonal, are equivalent to the (univariate) L-moments, i.e.</p> <div class=arithmatex>\[ \lambda_{r [ii]}^{(s, t)}\big( \vec{X} \big) = \lambda_{r}^{(s, t)}\big( X_i \big) \;. \]</div> <details class=notes open> <summary>Notes</summary> <p>At the time of writing, trimmed L-comoments have not been explicitly defined in the literature. Instead, the author (<a href=https://github.com/jorenham/ >@jorenham</a>) derived it by generizing the (untrimmed) L-comoment definition by Serfling &amp; Xiao (2007), analogous to the generalization of L-moments into TL-moments by Elamir &amp; Seheult (2003).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Find the L-coscale and TL-coscale matrices of the multivariate Student&rsquo;s t distribution with 4 degrees of freedom:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>multivariate_t</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>df</span> <span class=o>=</span> <span class=mi>4</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>loc</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>],</span> <span class=p>[</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>X</span> <span class=o>=</span> <span class=n>multivariate_t</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=n>loc</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=n>cov</span><span class=p>,</span> <span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>stdtr</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>diag</span><span class=p>(</span><span class=n>cov</span><span class=p>))</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cdf0</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>stdtr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>loc</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>/</span> <span class=n>std</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cdf1</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>stdtr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>loc</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=n>std</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span> <span class=o>=</span> <span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>pdf</span><span class=p>,</span> <span class=p>(</span><span class=n>cdf0</span><span class=p>,</span> <span class=n>cdf1</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
<span class=go>array([[1.0413, 0.3124],</span>
<span class=go>       [0.1562, 0.5207]])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span> <span class=o>=</span> <span class=n>l_comoment_from_pdf</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>pdf</span><span class=p>,</span> <span class=p>(</span><span class=n>cdf0</span><span class=p>,</span> <span class=n>cdf1</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
<span class=go>array([[0.4893, 0.1468],</span>
<span class=go>       [0.0734, 0.2447]])</span>
</code></pre></div> <p>The (Pearson) correlation coefficient can be recovered in several ways:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>  <span class=c1># &quot;true&quot; correlation</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>l_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>l_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>tl_cov</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
<span class=go>0.3</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>tl_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>tl_cov</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=go>0.3</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>pdf</code> </td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical._f_to_lcm._ArrF8>_ArrF8</span>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | <a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical._f_to_lcm._ArrF8>_ArrF8</span>], <a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a>]</code> </td> <td> <div class=doc-md-description> <p>Joint Probability Distribution Function (PDF), that accepts a float vector of size <span class=arithmatex>\(n\)</span>, and returns a scalar in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>cdfs</code> </td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Sequence href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence>Sequence</a>[<span title=lmo.theoretical._f_to_lcm._Fn1>_Fn1</span>]</code> </td> <td> <div class=doc-md-description> <p>Sequence with <span class=arithmatex>\(n\)</span> marginal CDF&rsquo;s.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>Non-negative integer <span class=arithmatex>\(r\)</span> with the L-moment order.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>supports</code></td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Sequence href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence>Sequence</a>[<span title=lmo.theoretical._f_to_lcm._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]] | None</code> </td> <td> <div class=doc-md-description> <p>A sequence with <span class=arithmatex>\(n\)</span> 2-tuples, corresponding to the marginal integration limits. Defaults to <span class=arithmatex>\([(-\infty, \infty), \dots]\)</span>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>lmbda</code></td> <td> <code><span title=lmo.theoretical._f_to_lcm._ArrF8>_ArrF8</span></code> </td> <td> <div class=doc-md-description> <p>The population L-<em>co</em>moment matrix with shape <span class=arithmatex>\(n \times n\)</span>.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jmva.2007.01.008>R. Serfling &amp; P. Xiao (2007) - A Contribution to Multivariate L-Moments: L-Comoment Matrices</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_coratio_from_pdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_coratio_from_pdf</span><span class=p>(</span><span class=n>pdf</span><span class=p>,</span> <span class=n>cdfs</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>r0</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>supports</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_coratio_from_pdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Evaluate the theoretical L-<em>co</em>moment ratio matrix of a multivariate probability distribution, using the joint PDF <span class=arithmatex>\(f_{\vec{X}}(\vec{x})\)</span> and <span class=arithmatex>\(n\)</span> marginal CDFs <span class=arithmatex>\(F_X(x)\)</span> of random vector <span class=arithmatex>\(\vec{X}\)</span>.</p> <div class=arithmatex>\[ \tilde \Lambda_{r,r_0}^{(s, t)} = \left[ \left. \lambda_{r [ij]}^{(s, t)} \right/ \lambda_{r_0 [ii]}^{(s, t)} \right]_{n \times n} \]</div> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_comoment_from_pdf><code>l_comoment_from_pdf</code></a></li> <li><a class="autorefs autorefs-internal" href=../L-comoments/#lmo.l_coratio><code>lmo.l_coratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_moment_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_cdf</span><span class=p>(</span>
    <span class=n>cdf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_cdf</span><span class=p>(</span>
    <span class=n>cdf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>float64</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the population L-moment of a continuous probability distribution, using its Cumulative Distribution Function (CDF) <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>.</p> <div class=arithmatex>\[ \lambda^{(s, t)}_r = \begin{cases} 1 &amp; r = 0 \\ \displaystyle \int_{\mathbb{R}} \left(H(x) - I_u(s + 1,\ t + 1)\right) \ \mathrm{d} x &amp; r = 1 \\ \displaystyle \frac{c^{(s,t)}_r}{r} \int_{\mathbb{R}} u^{s + 1} \left(1 - u\right)^{t + 1} \ \widetilde{P}^{(t + 1, s + 1)}_{r - 2}(u) \ \mathrm{d} x &amp; r &gt; 1 \; , \end{cases} \]</div> <p>where,</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r + s + t}{r} \frac{\B(r,\ r + s + t)}{\B(r + s,\ r + t)} \; , \]</div> <p><span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k(x)\)</span> the shifted (<span class=arithmatex>\(x \mapsto 2x-1\)</span>) Jacobi polynomial, <span class=arithmatex>\(H(x)\)</span> the Heaviside step function, and <span class=arithmatex>\(I_x(\alpha, \beta)\)</span> the regularized incomplete gamma function, and <span class=arithmatex>\(u = F_X(x)\)</span> the probability integral transform of <span class=arithmatex>\(x \sim X\)</span>.</p> <details class=notes open> <summary>Notes</summary> <p>Numerical integration is performed with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>, which cannot verify whether the integral exists and is finite. If it returns an error message, an <code>IntegrationWarning</code> is issues, and <code>nan</code> is returned (even if <code>quad</code> returned a finite result).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the first 4 L- and TL-moments of the standard normal distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>ndtr</span>  <span class=c1># standard normal CDF</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>ndtr</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
<span class=go>array([0.        , 0.56418958, 0.        , 0.06917061])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>ndtr</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.29701138, 0.        , 0.01855727])</span>
</code></pre></div> <p>Evaluate the first 4 TL-moments of the standard Cauchy distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>cdf_cauchy</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>/</span> <span class=mi>2</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_cdf</span><span class=p>(</span><span class=n>cdf_cauchy</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.69782723, 0.        , 0.23922105])</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cdf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm._Fn1>_Fn1</span> | <a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </td> <td> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span> | <span title=lmo.typing.AnyOrderND>AnyOrderND</span></code> </td> <td> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Split the integral into integrals with limits <span class=arithmatex>\([a, F^{-1}(\alpha)]\)</span>, <span class=arithmatex>\([F(\alpha), F^{-1}(1 - \alpha)]\)</span> and <span class=arithmatex>\([F^{-1}(1 - \alpha), b]\)</span> to improve numerical stability. So <span class=arithmatex>\(\alpha\)</span> can be consideresd the size of the tail. Numerical experiments have found 0.05 to give good results for different distributions.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>ppf</code></td> <td> <code><span title=lmo.theoretical._f_to_lm._Fn1>_Fn1</span> | None</code> </td> <td> <div class=doc-md-description> <p>The inverse of the cdf, used with <code>alpha</code> to calculate the integral split points (if provided).</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </td> <td> <div class=doc-md-description> <p><code>r</code> is not integer-valued or negative</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p><code>r</code> is negative</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>lmbda</code></td> <td> <code><a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <span title=lmo.theoretical._f_to_lm._ArrF8>_ArrF8</span></code> </td> <td> <div class=doc-md-description> <p>The population L-moment(s), a scalar or float array like <code>r</code>. If <code>nan</code>, consult the related <code>IntegrationWarning</code> message.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_ppf><code>theoretical.l_moment_from_ppf</code></a>: population L-moment, using the inverse CDF</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment><code>l_moment</code></a>: sample L-moment</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_moment_from_ppf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_ppf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_ppf</span><span class=p>(</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_ppf</span><span class=p>(</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>float64</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the population L-moment of a univariate probability distribution, using its Percentile Function (PPF), <span class=arithmatex>\(x(F)\)</span>, also commonly known as the quantile function, which is the inverse of the Cumulative Distribution Function (CDF).</p> <div class=arithmatex>\[ \lambda^{(s, t)}_r = c^{(s, t)}_r \int_0^1 F^s (1 - F)^t \ \widetilde{P}^{(t, s)}_{r - 1}(F) \ x(F) \ \mathrm{d} F \; , \]</div> <p>where</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r+s+t}{r} \frac{B(r,\,r+s+t)}{B(r+s,\,r+t)} \;, \]</div> <p>and <span class=arithmatex>\(\widetilde{P}^{(\alpha, \beta)}_k(x)\)</span> the shifted (<span class=arithmatex>\(x \mapsto 2x-1\)</span>) Jacobi polynomial.</p> <details class=notes open> <summary>Notes</summary> <p>Numerical integration is performed with <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>, which cannot verify whether the integral exists and is finite. If it returns an error message, an <code>IntegrationWarning</code> is issues, and <code>nan</code> is returned (even if <code>quad</code> returned a finite result).</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Evaluate the L- and TL-location and -scale of the standard normal distribution:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>scipy.special</span> <span class=kn>import</span> <span class=n>ndtri</span>  <span class=c1># standard normal inverse CDF</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ndtri</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<span class=go>array([0.        , 0.56418958])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>l_moment_from_ppf</span><span class=p>(</span><span class=n>ndtri</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>trim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=go>array([0.        , 0.29701138])</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ppf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm._Fn1>_Fn1</span> | <a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>], <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </td> <td> <div class=doc-md-description> <p>The quantile function <span class=arithmatex>\(x(F)\)</span>, a monotonically continuous increasing function with signature <code>(float) -&gt; float</code>, that maps a probability in <span class=arithmatex>\([0, 1]\)</span>, to the domain of the distribution.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span> | <span title=lmo.typing.AnyOrderND>AnyOrderND</span></code> </td> <td> <div class=doc-md-description> <p>L-moment order(s), non-negative integer or array-like of integers. E.g. 0 gives 1, 1 the L-location, 2 the L-scale, etc.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim, either as a <span class=arithmatex>\((s, t)\)</span> tuple with <span class=arithmatex>\(s, t &gt; -1/2\)</span>, or <span class=arithmatex>\(t\)</span> as alias for <span class=arithmatex>\((t, t)\)</span>.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </td> <td> <div class=doc-md-description> <p>Integration limits. Defaults to (0, 1), as it should. There is no need to change this to anything else, and only exists to make the function signature consistent with the <code>*_from_cdf</code> analogue.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Split the integral into integrals with limits <span class=arithmatex>\([0, \alpha]\)</span>, <span class=arithmatex>\([\alpha, 1-\alpha]\)</span> and <span class=arithmatex>\([1-\alpha, 0]\)</span> to improve numerical stability. So <span class=arithmatex>\(\alpha\)</span> can be consideresd the size of the tail. Numerical experiments have found 0.1 to give good results for different distributions.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#TypeError>TypeError</a></code> </td> <td> <div class=doc-md-description> <p>Invalid <code>r</code> or <code>trim</code> types.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p>Invalid <code>r</code> or <code>trim</code> values.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>lmbda</code></td> <td> <code><a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | <span title=lmo.theoretical._f_to_lm._ArrF8>_ArrF8</span></code> </td> <td> <div class=doc-md-description> <p>The population L-moment(s), a scalar or float array like <code>r</code>. If <code>nan</code>, consult the related <code>IntegrationWarning</code> message.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1016/S0167-9473(02)00250-5>E. Elamir &amp; A. Seheult (2003) - Trimmed L-moments</a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>theoretical.l_moment_from_cdf</code></a>: population L-moment, using the CDF (i.e. the inverse PPF)</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment><code>l_moment</code></a>: sample L-moment</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_moment_from_qdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_from_qdf</span><span class=p>(</span><span class=n>qdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_from_qdf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_qdf</span><span class=p>(</span>
    <span class=n>qdf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_moment_from_qdf</span><span class=p>(</span>
    <span class=n>qdf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=n>Callable</span><span class=p>[[</span><span class=nb>float</span><span class=p>],</span> <span class=nb>float</span><span class=p>],</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>float64</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Evaluate the population L-moments <span class=arithmatex>\( \tlmoment{s, t}{r} \)</span> for <span class=arithmatex>\( r &gt; 1 \)</span> from the quantile distribution function (QDF), which is the derivative of the PPF (quantile function).</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_ratio_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_cdf</span><span class=p>(</span>
    <span class=n>cdf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span> <span class=o>|</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_cdf</span><span class=p>(</span>
    <span class=n>cdf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span> <span class=o>|</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_cdf</span><span class=p>(</span>
    <span class=n>cdf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>float64</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Population L-ratio&rsquo;s from a CDF.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_ppf><code>l_ratio_from_ppf</code></a></li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_ratio_from_ppf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_from_ppf class=headerlink title="Permanent link">&para;</a></h3> <div class=doc-overloads> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_ppf</span><span class=p>(</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span> <span class=o>|</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_ppf</span><span class=p>(</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span> <span class=o>|</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrderND</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>_ArrF8</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class=nf>l_ratio_from_ppf</span><span class=p>(</span>
    <span class=n>ppf</span><span class=p>:</span> <span class=n>_Fn1</span><span class=p>,</span>
    <span class=n>r</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=n>s</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyOrder</span><span class=p>,</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>trim</span><span class=p>:</span> <span class=n>lmt</span><span class=o>.</span><span class=n>AnyTrim</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=o>*</span><span class=p>,</span>
    <span class=n>support</span><span class=p>:</span> <span class=n>_Pair</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>quad_opts</span><span class=p>:</span> <span class=n>lspt</span><span class=o>.</span><span class=n>QuadOptions</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
    <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>float64</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Population L-ratio&rsquo;s from a PPF.</p> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_stats_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Calculates the theoretical- / population- L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>) of a distribution, from its CDF.</p> <p>By default, the first <code>num = 4</code> population L-stats are calculated:</p> <ul> <li><span class=arithmatex>\(\lambda^{(s,t)}_1\)</span> - <em>L-loc</em>ation</li> <li><span class=arithmatex>\(\lambda^{(s,t)}_2\)</span> - <em>L-scale</em></li> <li><span class=arithmatex>\(\tau^{(s,t)}_3\)</span> - <em>L-skew</em>ness coefficient</li> <li><span class=arithmatex>\(\tau^{(s,t)}_4\)</span> - <em>L-kurt</em>osis coefficient</li> </ul> <p>This function is equivalent to <code>l_ratio_from_cdf(cdf, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code>.</p> <details class=note open> <summary>Note</summary> <p>This should not be confused with the term <em>L-statistic</em>, which is sometimes used to describe any linear combination of order statistics.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_stats_from_ppf><code>l_stats_from_ppf</code></a> - Population L-stats from the quantile function.</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a> - Generalized population L-ratio&rsquo;s from the CDF.</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_stats><code>lmo.l_stats</code></a> - Unbiased sample estimation of L-stats.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_stats_from_ppf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_from_ppf</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_from_ppf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Calculates the theoretical- / population- L-moments (for <span class=arithmatex>\(r \le 2\)</span>) and L-ratio&rsquo;s (for <span class=arithmatex>\(r &gt; 2\)</span>) of a distribution, from its quantile function.</p> <p>By default, the first <code>num = 4</code> population L-stats are calculated:</p> <ul> <li><span class=arithmatex>\(\lambda^{(s,t)}_1\)</span> - <em>L-loc</em>ation</li> <li><span class=arithmatex>\(\lambda^{(s,t)}_2\)</span> - <em>L-scale</em></li> <li><span class=arithmatex>\(\tau^{(s,t)}_3\)</span> - <em>L-skew</em>ness coefficient</li> <li><span class=arithmatex>\(\tau^{(s,t)}_4\)</span> - <em>L-kurt</em>osis coefficient</li> </ul> <p>This function is equivalent to <code>l_ratio_from_cdf(cdf, [1, 2, 3, 4], [0, 0, 2, 2], *, **)</code>.</p> <details class=note open> <summary>Note</summary> <p>This should not be confused with the term <em>L-statistic</em>, which is sometimes used to describe any linear combination of order statistics.</p> </details> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_stats_from_cdf><code>l_stats_from_cdf</code></a> - Population L-stats from the CDF.</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_ppf><code>l_ratio_from_ppf</code></a> - Generalized population L-ratio&rsquo;s from the quantile function.</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_stats><code>lmo.l_stats</code></a> - Unbiased sample estimation of L-stats.</li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_moment_cov_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_cov_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r_max</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_cov_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>L-moments that are estimated from <span class=arithmatex>\(n\)</span> samples of a distribution with CDF <span class=arithmatex>\(F\)</span>, converge to the multivariate normal distribution as the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>.</p> <div class=arithmatex>\[ \sqrt{n} \left( \vec{l}^{(s, t)} - \vec{\lambda}^{(s, t)} \right) \sim \mathcal{N}( \vec{0}, \mathbf{\Lambda}^{(s, t)} ) \]</div> <p>Here, <span class=arithmatex>\(\vec{l}^{(s, t)} = \left[l^{(s, t)}_r, \dots, l^{(s, t)}_{r_{max}} \right]^T\)</span> is a vector of estimated sample L-moments, and <span class=arithmatex>\(\vec{\lambda}^{(s, t)}\)</span> its theoretical (&ldquo;true&rdquo;) counterpart.</p> <p>This function calculates the covariance matrix</p> <div class=arithmatex>\[ \begin{align*} \bf{\Lambda}^{(s,t)}_{k, r} &amp;= \mathrm{Cov}[l^{(s, t)}_k, l^{(s, t)}_r] \\ &amp;= c_k c_r \iint\limits_{x &lt; y} \left( p^{(s, t)}_k(u) \ p^{(s, t)}_r(v) + p^{(s, t)}_r(u) \ p^{(s, t)}_k(v) \right) \ w^{(s + 1,\ t)}(u) \ w^{(s,\ t + 1)}(v) \ \mathrm{d} x \ \mathrm{d} y \; , \end{align*} \]</div> <p>where <span class=arithmatex>\(u = F_X(x)\)</span> and <span class=arithmatex>\(v = F_Y(y)\)</span> (marginal) probability integral transforms, and</p> <div class=arithmatex>\[ c_n = \frac{\Gamma(n) \Gamma(n+s+t+1)}{n \Gamma(n+s) \Gamma(n+t)}\;, \]</div> <p>the shifted Jacobi polynomial <span class=arithmatex>\(p^{(s, t)}_n(u) = P^{(t, s)}_{n-1}(2u - 1)\)</span>, <span class=arithmatex>\(P^{(t, s)}_m\)</span>, and <span class=arithmatex>\(w^{(s, t)}(u) = u^s (1 - u)^t\)</span> its weight function.</p> <details class=notes open> <summary>Notes</summary> <p>This function uses <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.nquad.html#scipy.integrate.nquad><code>scipy.integrate.nquad</code></a> for numerical integration. Unexpected results may be returned if the integral does not exist, or does not converge. The results are rounded to match the order of magnitude of the absolute error of <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.nquad.html#scipy.integrate.nquad><code>scipy.integrate.nquad</code></a>.</p> <p>This function is not vectorized or parallelized.</p> <p>For small sample sizes (<span class=arithmatex>\(n &lt; 100\)</span>), the covariances of the higher-order L-moments (<span class=arithmatex>\(r &gt; 2\)</span>) can be biased. But this bias quickly disappears at roughly <span class=arithmatex>\(n &gt; 200\)</span> (depending on the trim- and L-moment orders).</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cdf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r_max</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>The amount of L-moment orders to consider. If for example <code>r_max = 4</code>, the covariance matrix will be of shape <code>(4, 4)</code>, and the columns and rows correspond to the L-moments of order <span class=arithmatex>\(r = 1, \dots, r_{max}\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim. Must be a tuple of two non-negative ints or floats.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.NQuadOptions>NQuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cov</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._ArrF8>_ArrF8</span></code> </td> <td> <div class=doc-md-description> <p>Covariance matrix, with shape <code>(r_max, r_max)</code>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#RuntimeError>RuntimeError</a></code> </td> <td> <div class=doc-md-description> <p>If the covariance matrix is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a> - Population L-moments from the cumulative distribution function</li> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_ppf><code>l_moment_from_ppf</code></a> - Population L-moments from the quantile function</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment><code>lmo.l_moment</code></a> - Unbiased L-moment estimation from samples</li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment_cov><code>lmo.l_moment_cov</code></a> - Distribution-free exact L-moment exact covariance estimate.</li> </ul> </details> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_stats_cov_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_stats_cov_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>ppf</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_stats_cov_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Similar to <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a>, but for the <a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_stats><code>lmo.l_stats</code></a>.</p> <p>As the sample size <span class=arithmatex>\(n \rightarrow \infty\)</span>, the L-moment ratio&rsquo;s are also distributed (multivariate) normally. The L-stats are defined to be L-moments for <span class=arithmatex>\(r\le 2\)</span>, and L-ratio coefficients otherwise.</p> <p>The corresponding covariance matrix has been found to be</p> <div class=arithmatex>\[ \bf{T}^{(s, t)}_{k, r} = \begin{cases} \bf{\Lambda}^{(s, t)}_{k, r} &amp; k \le 2 \wedge r \le 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} }{ \lambda^{(s,t)}_{2} } &amp; k \le 2 \wedge r &gt; 2 \\ \frac{ \bf{\Lambda}^{(s, t)}_{k, r} - \tau_k \bf{\Lambda}^{(s, t)}_{2, r} - \tau_r \bf{\Lambda}^{(s, t)}_{k, 2} + \tau_k \tau_r \bf{\Lambda}^{(s, t)}_{2, 2} }{ \Big( \lambda^{(s,t)}_{2} \Big)^2 } &amp; k &gt; 2 \wedge r &gt; 2 \end{cases} \]</div> <p>where <span class=arithmatex>\(\bf{\Lambda}^{(s, t)}\)</span> is the covariance matrix of the L-moments from <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_cov_from_cdf><code>l_moment_cov_from_cdf</code></a>, and <span class=arithmatex>\(\tau^{(s,t)}_r = \lambda^{(s,t)}_r / \lambda^{(s,t)}_2\)</span> the population L-ratio.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cdf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>Cumulative Distribution Function (CDF), <span class=arithmatex>\(F_X(x) = P(X \le x)\)</span>. Must be a continuous monotone increasing function with signature <code>(float) -&gt; float</code>, whose return value lies in <span class=arithmatex>\([0, 1]\)</span>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>The amount of L-statistics to return. Defaults to 4.</p> </div> </td> <td> <code>4</code> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim. Must be a tuple of two non-negative ints or floats.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>. Generally it&rsquo;s not needed to provide this, as it will be guessed automatically.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>ppf</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_cov._Fn1>_Fn1</span> | None</code> </td> <td> <div class=doc-md-description> <p>Quantile function, for calculating the split integral limits.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://jstor.org/stable/2345653>J.R.M. Hosking (1990) - L-moments: Analysis and Estimation of Distributions Using Linear Combinations of Order Statistics </a></li> <li><a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking (2007) - Some theory and practical uses of trimmed L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_moment_influence_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_moment_influence_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>l_moment</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_moment_influence_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Influence Function (IF) of a theoretical L-moment.</p> <div class=arithmatex>\[ \psi_{\lambda^{(s, t)}_r | F}(x) = c^{(s,t)}_r \, F(x)^s \, \big( 1-{F}(x) \big)^t \, \tilde{P}^{(s,t)}_{r-1} \big( F(x) \big) \, x - \lambda^{(s,t)}_r \;, \]</div> <p>with <span class=arithmatex>\(F\)</span> the CDF, <span class=arithmatex>\(\tilde{P}^{(s,t)}_{r-1}\)</span> the shifted Jacobi polynomial, and</p> <div class=arithmatex>\[ c^{(s,t)}_r = \frac{r+s+t}{r} \frac{B(r, \, r+s+t)}{B(r+s, \, r+t)} \;, \]</div> <p>where <span class=arithmatex>\(B\)</span> is the (complete) Beta function.</p> <p>The proof is trivial, because population L-moments are <a href=https://wikipedia.org/wiki/Linear_form>linear functionals</a>.</p> <details class=notes open> <summary>Notes</summary> <p>The order parameter <code>r</code> is not vectorized.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cdf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm_eif._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>Vectorized cumulative distribution function (CDF).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>The L-moment order. Must be a non-negative integer.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim lengths. Defaults to (0, 0).</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_eif._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>l_moment</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | <a class="autorefs autorefs-external" title=numpy.float64 href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64>float64</a> | None</code> </td> <td> <div class=doc-md-description> <p>The relevant L-moment to use. If not provided, it is calculated from the CDF.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>influence_function</code></td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical._f_to_lm_eif._T_x>_T_x</span>], <span title=lmo.theoretical._f_to_lm_eif._T_x>_T_x</span>]</code> </td> <td> <div class=doc-md-description> <p>The influence function, with vectorized signature <code>() -&gt; ()</code>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_from_cdf><code>l_moment_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment><code>lmo.l_moment</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.l_ratio_influence_from_cdf class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>l_ratio_influence_from_cdf</span><span class=p>(</span><span class=n>cdf</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>l_moments</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>quad_opts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>ALPHA</span><span class=p>,</span> <span class=n>tol</span><span class=o>=</span><span class=mf>1e-08</span><span class=p>)</span></code> <a href=#lmo.theoretical.l_ratio_influence_from_cdf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Construct the influence function of a theoretical L-moment ratio.</p> <div class=arithmatex>\[ \psi_{\tau^{(s, t)}_{r,k}|F}(x) = \frac{ \psi_{\lambda^{(s, t)}_r|F}(x) - \tau^{(s, t)}_{r,k} \, \psi_{\lambda^{(s, t)}_k|F}(x) }{ \lambda^{(s,t)}_k } \;, \]</div> <p>where the generalized L-moment ratio is defined as</p> <div class=arithmatex>\[ \tau^{(s, t)}_{r,k} = \frac{ \lambda^{(s, t)}_r }{ \lambda^{(s, t)}_k } \;. \]</div> <p>Because IF&rsquo;s are a special case of the general Gâteuax derivative, the L-ratio IF is derived by applying the chain rule to the <a class="autorefs autorefs-internal" href=#lmo.theoretical.l_moment_influence_from_cdf>L-moment IF</a>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cdf</code> </td> <td> <code><span title=lmo.theoretical._f_to_lm_eif._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>Vectorized cumulative distribution function (CDF).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>L-moment ratio order, i.e. the order of the numerator L-moment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>k</code> </td> <td> <code><span title=lmo.typing.AnyOrder>AnyOrder</span></code> </td> <td> <div class=doc-md-description> <p>Denominator L-moment order, defaults to 2.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>Left- and right- trim lengths. Defaults to (0, 0).</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>support</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_eif._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The subinterval of the nonzero domain of <code>cdf</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>l_moments</code></td> <td> <code><span title=lmo.theoretical._f_to_lm_eif._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>] | None</code> </td> <td> <div class=doc-md-description> <p>The L-moments corresponding to <span class=arithmatex>\(r\)</span> and <span class=arithmatex>\(k\)</span>. If not provided, they are calculated from the CDF.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>quad_opts</code></td> <td> <code><span title=lmo.typing.scipy.QuadOptions>QuadOptions</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional dict of options to pass to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad><code>scipy.integrate.quad</code></a>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>alpha</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Two-sided quantile to split the integral at.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>tol</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Zero-roundoff absolute threshold.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>influence_function</code></td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[[<span title=lmo.theoretical._f_to_lm_eif._T_x>_T_x</span>], <span title=lmo.theoretical._f_to_lm_eif._T_x>_T_x</span>]</code> </td> <td> <div class=doc-md-description> <p>The influence function, with vectorized signature <code>() -&gt; ()</code>.</p> </div> </td> </tr> </tbody> </table> <details class=see-also open> <summary>See Also</summary> <ul> <li><a class="autorefs autorefs-internal" href=#lmo.theoretical.l_ratio_from_cdf><code>l_ratio_from_cdf</code></a></li> <li><a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_ratio><code>lmo.l_ratio</code></a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.ppf_from_l_moments class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>ppf_from_l_moments</span><span class=p>(</span><span class=n>lmbda</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>),</span> <span class=n>validate</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>extrapolate</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.theoretical.ppf_from_l_moments class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a PPF (quantile function, or inverse CDF), with the specified. L-moments <span class=arithmatex>\( \tlmoment{s, t}{1}, \tlmoment{s, t}{2}, \ldots, \tlmoment{s, t}{R} \)</span>. Other L-moments are considered zero.</p> <p>For <span class=arithmatex>\( R \)</span> L-moments, this function returns</p> <div class=arithmatex>\[ \hat{Q}_R(u) = \sum_{r=1}^{R} r \frac{2r + s + t - 1}{r + s + t} \tlmoment{s, t}{r} \shjacobi{r - 1}{t}{s}{u}, \]</div> <p>where <span class=arithmatex>\( \shjacobi{n}{a}{b}{x} \)</span> is an <span class=arithmatex>\( n \)</span>-th degree shifted Jacobi polynomial, which is orthogonal for <span class=arithmatex>\( (a, b) \in (-1, \infty)^2 \)</span> on <span class=arithmatex>\( u \in [0, 1] \)</span>.</p> <p>This <em>nonparametric</em> quantile function estimation method was first described by <a href=https://doi.org/10.1016/j.jspi.2006.12.002>J.R.M. Hosking in 2007</a>. However, his derivation contains a small, but obvious error, resulting in zero-division for <span class=arithmatex>\( r = 1 \)</span>. So Lmo derived this correct version himself, by using the fact that L-moments are the disguised coefficients of the PPF&rsquo;s generalized Fourier-Jacobi series expansion.</p> <p>With Parseval&rsquo;s theorem it can be shown that, if the probability-weighted moment <span class=arithmatex>\( M_{2,s,t} \)</span> (which is the variance if <span class=arithmatex>\( s = t = 0 \)</span>) is finite, then <span class=arithmatex>\( \hat{Q}_R(u) = Q(u) \)</span> as <span class=arithmatex>\( R \to \infty \)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>lmbda</code> </td> <td> <code><span title=lmo.typing.np.AnyVectorFloat>AnyVectorFloat</span></code> </td> <td> <div class=doc-md-description> <p>1-d array-like of L-moments <span class=arithmatex>\( \tlmoment{s,t}{r} \)</span> for <span class=arithmatex>\( r = 1, 2, \ldots, R \)</span>. At least 2 L-moments are required. All remaining L-moments with <span class=arithmatex>\( r &gt; R \)</span> are considered zero.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><span title=lmo.typing.AnyTrim>AnyTrim</span></code> </td> <td> <div class=doc-md-description> <p>The trim-length(s) of L-moments <code>lmbda</code>.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>support</code> </td> <td> <code><span title=lmo.theoretical._lm_to_f._Pair>_Pair</span>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a>]</code> </td> <td> <div class=doc-md-description> <p>A tuple like <code>(x_min, x_max)</code>. If provided, the PPF results will be clipped to within this interval.</p> </div> </td> <td> <code>(-<a class="autorefs autorefs-external" title=numpy.inf href=https://numpy.org/doc/stable/reference/constants.html#numpy.inf>inf</a>, <a class="autorefs autorefs-external" title=numpy.inf href=https://numpy.org/doc/stable/reference/constants.html#numpy.inf>inf</a>)</code> </td> </tr> <tr class=doc-section-item> <td> <code>validate</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>If <code>True</code> (default), a <code>ValueError</code> will be raised if the resulting PPF is invalid (non-monotonic), which can be solved by increasing the <code>trim</code>.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>extrapolate</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>If set to <code>True</code>, a simple moving average of <span class=arithmatex>\( R \)</span> and <span class=arithmatex>\( R - 1 \)</span> will be returned. This generally results in a smoother and more accurate PPF, but its L-moments will not be equal to <code>lmda</code>. Defaults to <code>False</code>.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ppf</code></td> <td> <code><span title=lmo.theoretical._lm_to_f._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>A vectorized PPF (quantile function). Its extra optional keyword argument <code>r_max: int</code> can be used to &ldquo;censor&rdquo; trailing L-moments, i.e. truncating the degree of the polynomial.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=lmo.theoretical.qdf_from_l_moments class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>theoretical</span><span class=o>.</span><span class=n>qdf_from_l_moments</span><span class=p>(</span><span class=n>lmbda</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>validate</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>extrapolate</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#lmo.theoretical.qdf_from_l_moments class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the QDF (quantile density function, the derivative of the PPF), with the specified L-moments <span class=arithmatex>\( \tlmoment{s, t}{1}, \tlmoment{s, t}{2}, \ldots, \tlmoment{s, t}{R} \)</span>. Other L-moments are considered zero.</p> <p>This function returns</p> <div class=arithmatex>\[ \begin{align*} \hat{q}_R(u) &amp;= \frac{\dd{\hat{Q}_R(u)}}{\dd{u}} \\ &amp;= \sum_{r=2}^{R} r (2r + s + t - 1) \tlmoment{s, t}{r} \shjacobi{r - 2}{t + 1}{s + 1}{u}, \end{align*} \]</div> <p>where <span class=arithmatex>\( \shjacobi{n}{a}{b}{x} \)</span> is an <span class=arithmatex>\( n \)</span>-th degree shifted Jacobi polynomial, which is orthogonal for <span class=arithmatex>\( (a, b) \in (-1, \infty)^2 \)</span> on <span class=arithmatex>\( u \in [0, 1] \)</span>.</p> <p>See <a class="autorefs autorefs-internal" href=#lmo.theoretical.ppf_from_l_moments><code>ppf_from_l_moments</code></a> for options.</p> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=lmo.inference class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <code>lmo.inference</code> <a href=#lmo.inference class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <p>Statistical inference for parametric probability distributions.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=lmo.inference.fit class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <code class="highlight language-python"><span class=n>lmo</span><span class=o>.</span><span class=n>inference</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>ppf</span><span class=p>,</span> <span class=n>args0</span><span class=p>,</span> <span class=n>n_obs</span><span class=p>,</span> <span class=n>l_moments</span><span class=p>,</span> <span class=n>r</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>k_max</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>l_tol</span><span class=o>=</span><span class=mf>0.0001</span><span class=p>,</span> <span class=n>l_moment_fn</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_mc_samples</span><span class=o>=</span><span class=mi>9999</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span></code> <a href=#lmo.inference.fit class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Fit the distribution parameters using the (Generalized) Method of L-Moments (L-(G)MM).</p> <p>The goal is to find the &ldquo;true&rdquo; parameters <span class=arithmatex>\(\bm{\theta^*}\)</span> of the distribution. In practise, this is done using a reasonably close estimate, <span class=arithmatex>\(\bm{\hat\theta}\)</span>.</p> <p>In the (non-Generalized) Method of L-moments (L-MM), this is done by solving the system of equations <span class=arithmatex>\(\ell^{(s, t)}_r = \lambda^{(s, t)}_r\)</span>, for <span class=arithmatex>\(r = 1, \dots, n\)</span>, with <span class=arithmatex>\(n\)</span> the number of free parameters. Because the amount of parameters matches the amount of <em>L-moment conditions</em>, the solution is <em>point-defined</em>, and can be found using simple least squares.</p> <p>L-GMM extends L-MM by allowing more L-moment conditions than there are free parameters, <span class=arithmatex>\(m &gt; n\)</span>. This requires solving an <em>over-identified</em> system of <span class=arithmatex>\(m\)</span> equations:</p> <div class=arithmatex>\[ \bm{\hat\theta} = \mathop{\arg \min} \limits_{\theta \in \Theta} \Bigl\{ \left[ \bm{\lambda}^{(s, t)}(X_\theta) - \bm{\ell}^{(s, t)} \right]^T W_m \left[ \bm{\lambda}^{(s, t)}(X_\theta) - \bm{\ell}^{(s, t)} \right] \Bigr\} \, , \]</div> <p>where <span class=arithmatex>\(W_m\)</span> is a <span class=arithmatex>\(m \times m\)</span> weight matrix.</p> <p>The weight matrix is initially chosen as the matrix inverse of the non-parametric L-moment covariance matrix, see <a class="autorefs autorefs-internal" href=../L-moments/#lmo.l_moment_cov><code>lmo.l_moment_cov</code></a>. These weights are then plugged into the the equation above, and fed into <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize><code>scipy.optimize.minimize</code></a>, to obtain the initial parameter estimates.</p> <p>In the next step(s), Monte-Carlo sampling is used to draw samples from the distribution (using the current parameter estimates), with sample sizes matching that of the data. The L-moments of these samples are consequently used to to calculate the new weight matrix.</p> <details class=todo open> <summary>Todo</summary> <ul> <li>Raise on minimization error, warn on failed k-step convergence</li> <li>Optional <code>integrality</code> kwarg with boolean mask for integral params.</li> <li>Implement CUE: Continuously Updating GMM (i.e. implement and use <code>_loss_cue()</code>, then run with <code>k=1</code>), see <a href=https://github.com/jorenham/Lmo/issues/299>#299</a>.</li> </ul> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ppf</code> </td> <td> <code><span title=lmo.inference._l_gmm._Fn1>_Fn1</span></code> </td> <td> <div class=doc-md-description> <p>The (vectorized) quantile function of the probability distribution, with signature <code>(q: T, *theta: float) -&gt; T</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args0</code> </td> <td> <code><span title=lmo.typing.np.AnyVectorFloat>AnyVectorFloat</span></code> </td> <td> <div class=doc-md-description> <p>Initial estimate of the distribution&rsquo;s parameter values.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>n_obs</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Amount of observations.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>l_moments</code> </td> <td> <code><span title=lmo.typing.np.AnyVectorFloat>AnyVectorFloat</span></code> </td> <td> <div class=doc-md-description> <p>Estimated sample L-moments. Must be a 1-d array-like s.t. <code>len(l_moments) &gt;= len(args0)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>r</code> </td> <td> <code><span title=lmo.typing.AnyOrderND>AnyOrderND</span> | None</code> </td> <td> <div class=doc-md-description> <p>The orders of <code>l_moments</code>. Defaults to <code>[1, ..., len(l_moments)]</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>trim</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, <a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>]</code> </td> <td> <div class=doc-md-description> <p>The L-moment trim-length(s) to use. Currently, only integral trimming is supported.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Other Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>k</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a> | None</code> </td> <td> <div class=doc-md-description> <p>If set to a positive integer, exactly <span class=arithmatex>\(k\)</span> steps will be run. Will be ignored if <code>n_extra=0</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>k_max</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Maximum amount of steps to run while not reaching convergence. Will be ignored if <span class=arithmatex>\(k\)</span> is specified or if <code>n_extra=0</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>l_tol</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Error tolerance in the parametric L-moments (unit-standardized). Will be ignored if <span class=arithmatex>\(k\)</span> is specified or if <code>n_extra=0</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>l_moment_fn</code></td> <td> <code><a class="autorefs autorefs-external" title=collections.abc.Callable href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable>Callable</a>[..., <span title=lmo.inference._l_gmm._ArrF8>_ArrF8</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Function for parametric L-moment calculation, with signature: <code>(r: intp[:], *theta: float, trim: tuple[int, int]) -&gt; float64[:]</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>n_mc_samples</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>The number of Monte-Carlo (MC) samples drawn from the distribution to to form the weight matrix in step <span class=arithmatex>\(k &gt; 1\)</span>. Will be ignored if <code>n_extra=0</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>random_state</code></td> <td> <code><span title=lmo.typing.np.Seed>Seed</span> | None</code> </td> <td> <div class=doc-md-description> <p>A seed value or <a class="autorefs autorefs-external" href=https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator><code>numpy.random.Generator</code></a> instance, used for weight matrix estimation in step <span class=arithmatex>\(k &gt; 1\)</span>. Will be ignored if <code>n_extra=0</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>**kwds</code></td> <td> <code><a class="autorefs autorefs-external" title=typing.Any href=https://docs.python.org/3/library/typing.html#typing.Any>Any</a></code> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments to be passed to <a class="autorefs autorefs-external" href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize><code>scipy.optimize.minimize</code></a>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p>Invalid arguments.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>result</code></td> <td> <code><a class="autorefs autorefs-internal" title=lmo.inference._l_gmm.GMMResult href=#lmo.inference.GMMResult>GMMResult</a></code> </td> <td> <div class=doc-md-description> <p>An instance of [<code>GMMResult</code>][<code>lmo.inference.GMMResult</code>].</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.48550/arXiv.2210.04146>Alvarez et al. (2023) - Inference in parametric models with many L-moments</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-class"> <h3 id=lmo.inference.GMMResult class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <code>lmo.inference.GMMResult</code> <a href=#lmo.inference.GMMResult class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" title=typing.NamedTuple href=https://docs.python.org/3/library/typing.html#typing.NamedTuple>NamedTuple</a></code></p> <p>Represents the Generalized Method of L-Moments (L-GMM) results. See <a class="autorefs autorefs-internal" href=#lmo.inference.fit><code>lmo.inference.fit</code></a> for details.</p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.n_arg class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>n_arg</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_arg class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>The number of model parameters.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.n_con class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>n_con</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_con class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>The amount of L-moment conditions of the model.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.n_extra class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>n_extra</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.n_extra class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>The number of over-identifying L-moment conditions. For L-MM this is zero, otherwise, for L-GMM, it is strictly positive.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.j_test class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>j_test</span><span class=p>:</span> <span class=n>HypothesisTestResult</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.j_test class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Sargan-Hansen J-test for over-identifying restrictions; a hypothesis test for the invalidity of the model.</p> <p>The test is defined through two hypotheses:</p> <ul> <li><span class=arithmatex>\(H_0\)</span>: The data satisfies the L-moment conditions, i.e. the model is &ldquo;valid&rdquo;.</li> <li><span class=arithmatex>\(H_1\)</span>: The data does not satisfy the L-moment conditions, i.e. the model is &ldquo;invalid&rdquo;.</li> </ul> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.2307%2F1907619>J. D. Sargan (1958) - The Estimation of Economic Relationships Using Instrumental Variables</a></li> <li><a href=https://doi.org/10.2307%2F1912775>J. P. Hansen (1982) - Large Sample Properties of Generalized Method of Moments Estimators</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.AIC class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>AIC</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.AIC class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Akaike Information Criterion, based on the p-value of the J-test. Requires over-identified L-moment conditions, i.e. <code>n_extra &gt; 0</code>.</p> <p>The AIC is useful for model selection, e.g. for finding the most appropriate probability distribution from the data (smaller is better).</p> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1109%2FTAC.1974.1100705>H. Akaike (1974) - A new look at the statistical model identification</a></li> </ul> </details> </div> </div> <div class="doc doc-object doc-attribute"> <h4 id=lmo.inference.GMMResult.AICc class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <code class="highlight language-python"><span class=n>AICc</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#lmo.inference.GMMResult.AICc class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A modification of the AIC that includes a bias-correction small sample sizes.</p> <details class=references open> <summary>References</summary> <ul> <li><a href=https://doi.org/10.1080%2F03610927808827599>N. Sugiura (1978) - Further analysis of the data by Akaike&rsquo;s information criterion and the finite corrections</a></li> </ul> </details> </div> </div> </div> </div> </div> </div> </div> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-24</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jorenham/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.tabs.link", "content.tooltips", "navigation.path", "navigation.indexes", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.83f73b43.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js></script> <script src=../../scripts/katex.49c4bf.min.js></script> </body> </html>